(this["webpackJsonpreact-score-tool"]=this["webpackJsonpreact-score-tool"]||[]).push([[0],{164:function(e,t,n){},197:function(e,t,n){e.exports=n(252)},202:function(e,t,n){},205:function(e,t,n){},252:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(69),s=n.n(o),c=(n(202),n(5)),i=n(7),l=n(34),u=n(9),m=n(10),d=n(3),f=n(117),h=(n(205),n(50)),p=n(312),g=n(14),b=n(300);function v(e){var t=a.useState({measureRange:[1,2],maxMeasure:2}),n=Object(g.a)(t,2),r=n[0],o=n[1];a.useEffect((function(){o((function(t){return Object(d.a)(Object(d.a)({},t),{},{measureRange:e.range,maxMeasure:e.max})}))}),[e]);return a.createElement(b.a,{value:r.measureRange,min:1,max:r.maxMeasure,step:1,marks:!0,onChange:function(e,t,n){if(Array.isArray(t)){var a=t;o((function(e){return Object(d.a)(Object(d.a)({},e),{},{measureRange:a})}))}},onChangeCommitted:e.measureHandleChange,valueLabelDisplay:"auto",disableSwap:!0})}var y=n(296),E=n(302),_=n(299),O=n(313),k=n(315),C=n(33),x=n.n(C),w=n(135),j={alto_flute:["normal"],alto_sax:["normal"],baritone_generic:["normal"],bassoon:["normal"],bass_cl:["normal"],bass_flute:["normal"],bass_trombone:["normal"],cello:["harmonics","normal","pizz","pizz_harmonics","sord","sord_trem","trem"],clarinet:["normal"],clarinet_eb:["normal"],crotale:["normal"],cymbal:["13crash_bell","13crash_bow","13crash_chokecrash","13crash_mallet","13crash_normal","13crash_roll","13crash_shoulder","16chinese_bell","16chinese_bow","16chinese_chokecrash","16chinese_mallet","16chinese_normal","16chinese_roll","16chinese_shoulder","17crash_bell","17crash_bow","17crash_chokecrash","17crash_mallet","17crash_normal","17crash_roll","17crash_shoulder","17orchcrash","18crash_bell","18crash_bow","18crash_chokecrash","18crash_mallet","18crash_normal","18crash_roll","18crash_shoulder","18orchcrash_french","18orchcrash_germanic","18orchcrash_viennese","19chinese_bell","19chinese_bow","19chinese_chokecrash","19chinese_mallet","19chinese_normal","19chinese_roll","19chinese_shoulder","20chinese_bell","20chinese_bow","20chinese_chokecrash","20chinese_mallet","20chinese_normal","20chinese_roll","20chinese_shoulder","20crash_bell","20crash_bow","20crash_chokecrash","20crash_mallet","20crash_normal","20crash_roll","20crash_shoulder","21ride_bell","21ride_mallet","21ride_normal","21ride_roll","21ride_shoulder","hihat_bell","hihat_footclose","hihat_footsplash","hihat_normal","hihat_shoulder","normal","smallmetals","splash_bell","splash_mallet","splash_roll","splash_splash","windgong","windgong_bow"],double_bass:["harmonics","normal","pizz","pizz_harmonics","trem"],english_horn:["normal"],flute:["normal","vib"],guitar:["normal","normal_sulA","normal_sulB","normal_sulD","normal_sulE","normal_sulG","normal_sul_E"],harp:["normal"],horn:["normal"],oboe:["normal"],percussion_misc:["castanet","guiro_away","guiro_toward","shakers"],piano:["normal"],piccolo:["normal"],solo_cello:["arco_sulA","arco_sulC","arco_sulD","arco_sulG","normal"],solo_double_bass:["arco_sulA","arco_sulD","arco_sulE","arco_sulG","normal","pizz","pizz_sulA","pizz_sulD","pizz_sulE","pizz_sulG"],solo_viola:["arco_sulA","arco_sulC","arco_sulD","arco_sulG","normal"],solo_violin:["arco_sulA","arco_sulD","arco_sulE","arco_sulG","normal"],soprano_generic:["normal"],soprano_sax:["normal","normal_Vib"],tambourine:["normal","normal_fingerroll","normal_sforzando","normal_shakeroll","normal_thumbroll"],tamtam:["bow","normal"],tamtam_22:["bow","normal"],tamtam_40:["bow","normal"],tenor_generic:["normal"],thaigong:["normal"],triangle_6:["normal","normal_roll"],triangle_8:["normal","normal_roll"],trumpet:["normal","vib"],tuba:["normal"],vibraphone:["normal","normal_bow"],viola:["harmonics","normal","pizz","sord","sord_trem","trem"],violin:["harmonics","normal","pizz","sord","sord_trem","tremolo"],woodblock:["clave","graniteblock","normal"],xylophone:["gliss_down","gliss_up","normal","normal_hardrubber"],tenor_trombone:["normal"],timp:["normal"]},S={alto_flute:{normal:{f:[55,92],mf:[54,92],p:[54,80]}},alto_sax:{normal:{f:[48,81],mf:[48,81],p:[48,81]}},baritone_generic:{normal:{f:[30,66],mf:[30,66],p:[30,66]}},bassoon:{normal:{f:[33,75],mf:[33,75],p:[33,75]}},bass_cl:{normal:{f:[36,83],mf:[36,83],p:[36,83]}},bass_flute:{normal:{f:[47,86],mf:[47,83],p:[47,77]}},bass_trombone:{normal:{f:[24,66],mf:[24,68],p:[23,71]}},cello:{harmonics:{f:[36,72],mf:[36,72],p:[36,72]},normal:{f:[36,74],mf:[36,74],p:[36,74]},pizz:{f:[35,67],mf:[35,67],p:[35,67]},pizz_harmonics:{f:[47,70],mf:[47,70],p:[47,70]},sord:{f:[36,74],mf:[36,74],p:[36,74]},sord_trem:{f:[35,73],mf:[35,73],p:[35,73]},trem:{f:[36,74],mf:[36,74],p:[36,74]}},clarinet:{normal:{f:[49,95],mf:[49,96],p:[49,95]}},clarinet_eb:{normal:{f:[54,94],mf:[54,96],p:[54,93]}},crotale:{normal:{f:[83,108],p:[83,108]}},cymbal:{"13crash_bell":{f:[60,60],mf:[60,60],p:[60,60]},"13crash_bow":{mf:[60,60]},"13crash_chokecrash":{mf:[60,60]},"13crash_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"13crash_normal":{f:[60,60],mf:[60,60],p:[60,60]},"13crash_roll":{mf:[60,60]},"13crash_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"16chinese_bell":{f:[60,60],mf:[60,60],p:[60,60]},"16chinese_bow":{mf:[60,60]},"16chinese_chokecrash":{mf:[60,60]},"16chinese_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"16chinese_normal":{f:[60,60],mf:[60,60],p:[60,60]},"16chinese_roll":{mf:[60,60]},"16chinese_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"17crash_bell":{f:[60,60],mf:[60,60],p:[60,60]},"17crash_bow":{mf:[60,60]},"17crash_chokecrash":{mf:[60,60]},"17crash_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"17crash_normal":{f:[60,60],mf:[60,60],p:[60,60]},"17crash_roll":{mf:[60,60]},"17crash_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"17orchcrash":{f:[60,60],mf:[60,60],p:[60,60]},"18crash_bell":{f:[60,60]},"18crash_bow":{mf:[60,60]},"18crash_chokecrash":{mf:[60,60]},"18crash_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"18crash_normal":{f:[60,60],mf:[60,60],p:[60,60]},"18crash_roll":{mf:[60,60]},"18crash_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"18orchcrash_french":{f:[60,60],mf:[60,60],p:[60,60]},"18orchcrash_germanic":{f:[60,60],mf:[60,60],p:[60,60]},"18orchcrash_viennese":{f:[60,60],mf:[60,60],p:[60,60]},"19chinese_bell":{f:[60,60],mf:[60,60],p:[60,60]},"19chinese_bow":{mf:[60,60]},"19chinese_chokecrash":{mf:[60,60]},"19chinese_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"19chinese_normal":{f:[60,60],mf:[60,60],p:[60,60]},"19chinese_roll":{mf:[60,60]},"19chinese_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"20chinese_bell":{f:[60,60],mf:[60,60],p:[60,60]},"20chinese_bow":{mf:[60,60]},"20chinese_chokecrash":{mf:[60,60]},"20chinese_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"20chinese_normal":{f:[60,60],mf:[60,60],p:[60,60]},"20chinese_roll":{mf:[60,60]},"20chinese_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"20crash_bell":{f:[60,60],mf:[60,60],p:[60,60]},"20crash_bow":{mf:[60,60]},"20crash_chokecrash":{mf:[60,60]},"20crash_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"20crash_normal":{f:[60,60],mf:[60,60],p:[60,60]},"20crash_roll":{mf:[60,60]},"20crash_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"21ride_bell":{f:[60,60],mf:[60,60],p:[60,60]},"21ride_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"21ride_normal":{f:[60,60],mf:[60,60],p:[60,60]},"21ride_roll":{mf:[60,60]},"21ride_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},hihat_bell:{f:[60,60],mf:[60,60],p:[60,60]},hihat_footclose:{f:[60,60],mf:[60,60],p:[60,60]},hihat_footsplash:{f:[60,60],mf:[60,60],p:[60,60]},hihat_normal:{f:[60,60],mf:[60,60],p:[60,60]},hihat_shoulder:{f:[60,60],mf:[60,60],p:[60,60]},normal:{f:[60,60],mf:[60,60],p:[60,60]},smallmetals:{mf:[60,60]},splash_bell:{f:[60,60],mf:[60,60],p:[60,60]},splash_mallet:{f:[60,60],mf:[60,60],p:[60,60]},splash_roll:{mf:[60,60]},splash_splash:{f:[60,60],mf:[60,60],p:[60,60]},windgong:{f:[60,60],mf:[60,60],p:[60,60]},windgong_bow:{mf:[60,60]}},double_bass:{harmonics:{f:[39,72],mf:[39,72],p:[39,72]},normal:{f:[22,61],mf:[22,61],p:[22,61]},pizz:{f:[28,51],mf:[28,51],p:[28,51]},pizz_harmonics:{f:[39,63],mf:[39,63],p:[39,63]},trem:{f:[23,61],mf:[23,61],p:[23,61]}},english_horn:{normal:{f:[51,84],mf:[51,84],p:[51,84]}},flute:{normal:{f:[58,97],mf:[58,96],p:[58,95]},vib:{f:[58,97],mf:[58,97],p:[58,95]}},guitar:{normal:{f:[39,84],mf:[39,85],p:[38,85]},normal_sulA:{f:[43,66],mf:[43,66],p:[43,66]},normal_sulB:{f:[57,80],mf:[57,80],p:[57,80]},normal_sulD:{f:[48,70],mf:[48,70],p:[48,70]},normal_sulE:{f:[38,61],mf:[38,61],p:[38,61]},normal_sulG:{f:[53,75],mf:[53,75],p:[53,75]},normal_sul_E:{f:[62,84],mf:[62,85],p:[62,85]}},harp:{normal:{f:[17,90],mf:[19,90],p:[17,90]}},horn:{normal:{f:[32,79],mf:[32,79],p:[32,78]}},oboe:{normal:{f:[57,93],mf:[57,93],p:[57,92]}},percussion_misc:{castanet:{f:[60,60],mf:[60,60],p:[60,60]},guiro_away:{f:[60,60],mf:[60,60],p:[60,60]},guiro_toward:{f:[60,60],mf:[60,60]},shakers:{mf:[60,60]}},piano:{normal:{f:[20,108],mf:[22,108],p:[21,108]}},piccolo:{normal:{f:[74,109],mf:[74,109],p:[74,109]}},solo_cello:{arco_sulA:{f:[56,83],mf:[56,82],p:[56,84]},arco_sulC:{f:[35,61],mf:[35,62],p:[35,62]},arco_sulD:{f:[49,75],mf:[49,75],p:[49,75]},arco_sulG:{f:[42,69],mf:[42,68],p:[42,68]},normal:{f:[35,83],mf:[35,82],p:[35,83]}},solo_double_bass:{arco_sulA:{f:[32,58],mf:[32,58],p:[32,58]},arco_sulD:{f:[37,63],mf:[37,63],p:[37,63]},arco_sulE:{f:[27,51],mf:[27,51],p:[27,51]},arco_sulG:{f:[42,68],mf:[42,60],p:[42,68]},normal:{f:[27,68],mf:[27,68],p:[27,68]},pizz:{f:[27,68],mf:[27,68],p:[27,68]},pizz_sulA:{f:[32,58],mf:[32,58],p:[32,58]},pizz_sulD:{f:[37,63],mf:[37,63],p:[37,63]},pizz_sulE:{f:[27,53],mf:[27,53],p:[27,53]},pizz_sulG:{f:[42,68],mf:[42,68],p:[42,68]}},solo_viola:{arco_sulA:{f:[68,93],mf:[68,93],p:[68,92]},arco_sulC:{f:[47,72],mf:[47,72],p:[47,73]},arco_sulD:{f:[61,87],mf:[61,86],p:[61,84]},arco_sulG:{f:[54,81],mf:[54,79],p:[54,79]},normal:{f:[47,93],mf:[47,93],p:[47,91]}},solo_violin:{arco_sulA:{f:[68,92],mf:[68,93],p:[68,93]},arco_sulD:{f:[61,87],mf:[61,87],p:[61,85]},arco_sulE:{f:[75,108],mf:[75,105],p:[75,107]},arco_sulG:{f:[54,79],mf:[54,80],p:[54,78]},normal:{f:[54,108],mf:[54,105],p:[54,107]}},soprano_generic:{normal:{f:[59,82],mf:[59,82],p:[65,87]}},soprano_sax:{normal:{f:[55,88],mf:[55,88],p:[55,88]},normal_Vib:{f:[55,88],mf:[55,88],p:[55,88]}},tambourine:{normal:{f:[60,60],mf:[60,60],p:[60,60]},normal_fingerroll:{f:[60,60],mf:[60,60],p:[60,60]},normal_sforzando:{mf:[60,60]},normal_shakeroll:{f:[60,60],mf:[60,60],p:[60,60]},normal_thumbroll:{f:[60,60],mf:[60,60],p:[60,60]}},tamtam:{bow:{mf:[60,60]},normal:{f:[60,60],mf:[60,60],p:[60,60]}},tamtam_22:{bow:{mf:[60,60]},normal:{f:[60,60],mf:[60,60],p:[60,60]}},tamtam_40:{bow:{mf:[60,60]},normal:{f:[60,60],mf:[60,60],p:[60,60]}},TenorTrombone:{normal:{f:[39,73],mf:[39,73],p:[39,73]}},tenor_generic:{normal:{f:[49,72],mf:[49,72],p:[49,71]}},thaigong:{normal:{f:[59,73],mf:[59,73],p:[59,73]}},triangle_6:{normal:{f:[60,60],mf:[60,60],p:[60,60]},normal_roll:{f:[60,60],mf:[60,60],p:[60,60]}},triangle_8:{normal:{f:[60,60],mf:[60,60],p:[60,60]},normal_roll:{f:[60,60],mf:[60,60],p:[60,60]}},trumpet:{normal:{f:[51,88],mf:[51,87],p:[51,88]},vib:{f:[51,87],mf:[51,87],p:[51,87]}},tuba:{normal:{f:[23,61],mf:[23,61],p:[23,61]}},vibraphone:{normal:{f:[47,91],mf:[47,90],p:[47,90]},normal_bow:{mf:[47,90]}},viola:{harmonics:{f:[66,88],mf:[66,88],p:[66,88]},normal:{f:[48,86],mf:[48,86],p:[48,86]},pizz:{f:[47,85],mf:[47,85],p:[47,85]},sord:{f:[48,86],mf:[48,86],p:[48,86]},sord_trem:{f:[47,85],mf:[47,85],p:[47,85]},trem:{f:[47,85],mf:[47,85],p:[47,85]}},violin:{harmonics:{f:[66,104],mf:[66,104],p:[66,104]},normal:{f:[54,97],mf:[55,96],p:[55,96]},pizz:{f:[54,96],mf:[54,96],p:[54,96]},sord:{f:[55,93],mf:[55,93],p:[55,93]},sord_trem:{f:[55,96],mf:[55,96],p:[55,96]},tremolo:{f:[54,96],mf:[54,96],p:[55,96]}},woodblock:{clave:{f:[60,60],mf:[60,60],p:[60,60]},graniteblock:{f:[60,60],mf:[60,60],p:[60,60]},normal:{f:[60,60],mf:[60,60],p:[60,60]}},xylophone:{gliss_down:{mf:[59,60]},gliss_up:{mf:[60,60]},normal:{f:[64,108],mf:[64,108],p:[64,108]},normal_hardrubber:{f:[64,108],mf:[64,108],p:[64,108]}},tenor_trombone:{normal:{f:[39,73],mf:[39,73],p:[39,73]}},timp:{normal:{f:[37,61],mf:[37,61],p:[37,57]}}},N=n(21),T=n(309),I=n(303),A=n(318),M=n(319),P=n(314),D=n(292),L=n(70),z=n.n(L),R=n(84),F=R.a.Flow,W=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).notes=0,a.target=0,a.instruments=0,a.renderer=0,a.context=0,a.scale=1,a.state={x:0,y:0},a}return Object(i.a)(n,[{key:"setupScore",value:function(){var e=document.createElement("div"),t=this.props,n=(t.id,t.notes),a=t.target,r=t.instruments,o=(t.setProps,t.width),s=t.height,c=t.t_score_y,i=t.b_score_y,l=t.target_color,u=t.text_space,m=t.highlights,d=t.indexing,f=t.scale;this.notes=n,this.target=a,this.instruments=r,this.scale=f,this.renderer=new F.Renderer(e,F.Renderer.Backends.SVG),this.renderer.resize(o+u,s);var h=this.renderer.getContext();this.context=h,this.context.scale(this.scale,this.scale);var p=new F.Stave(20,c,o);p.addClef("treble"),p.setContext(this.context).draw();var g=new F.Stave(20,i,o);g.addClef("bass"),g.setContext(this.context).draw();var b=function(e,t,n){var a,r,o,s,c,i,l,u=[],f=[],h=[],p=[],g=[],b=[],v=[],y=[],E=[],_=[],O=[],k=[],C=[],x=[],w=[];for(a=0;a<e.length;a++){c=e[a],l=d?a+": "+t[a]:t[a];var j="";if("undefined"!==typeof m[a]&&(j=m[a]),r=c[0],o=c[c.length-1],s=c.length>2?c[1]:"n",i=r.concat("/",o),S=n[a],parseInt(o)>=4&&parseInt(o)<6){u.push(i),f.push(s),p.push(l),g.push(j);for(var S=0,N=0;N<n.length;N++)n[N]===a&&(S=1);h.push(S)}else if(parseInt(o)>=6){o-=2,i=r.concat("/",o),O.push(i),k.push(s),x.push(l),w.push(j);for(S=0,N=0;N<n.length;N++)n[N]===a&&(S=1);C.push(S)}else{b.push(i),v.push(s),E.push(l),_.push(j);for(S=0,N=0;N<n.length;N++)n[N]===a&&(S=1);y.push(S)}}return[u,f,h,b,v,y,p,E,g,_,O,k,C,x,w]}(this.notes,this.instruments,this.target);if(Array.isArray(b[10])&&b[10].length){var v=new F.Stave(20,40,o);v.addClef("treble"),v.setContext(this.context).draw(),this.context.fillText("15ma",v.x+6,v.y+26);for(var y=[],E=0;E<b[10].length;E++)y.push("c/4");var _=new F.StaveNote({clef:"treble",keys:y,duration:"q"});_.setStemStyle({strokeStyle:"none"}),_.setLedgerLineStyle({strokeStyle:"none"});for(E=0;E<b[10].length;E++)_.setKeyLine(E,E-1.5);var O=new F.StaveNote({clef:"treble",keys:b[10],duration:"q"}),k=b[13],C=b[14];for(E=0;E<b[11].length;E++){O.addAccidental(E,new F.Accidental(b[11][E]));var x=R(k[E],F.Modifier.Position.RIGHT);x.setOffsetX(-10),_.note_heads[E].glyph_code="v23",_.addModifier(E,x),C[E]&&O.setKeyStyle(E,{shadowColor:C[E],shadowBlur:100}),1===b[12][E]&&(O.setKeyStyle(E,{fillStyle:l}),_.setKeyStyle(E,{fillStyle:l}))}var w=new F.StaveConnector(v,g),j=new F.StaveConnector(v,g)}else w=new F.StaveConnector(p,g),j=new F.StaveConnector(p,g);w.setType(F.StaveConnector.type.SINGLE_LEFT),w.setContext(this.context),w.draw(),j.setType(F.StaveConnector.type.BRACKET),j.setContext(this.context),j.draw();var S=[];for(E=0;E<b[0].length;E++)S.push("c/4");var N=new F.StaveNote({clef:"treble",keys:S,duration:"q"});N.setStemStyle({strokeStyle:"none"}),N.setLedgerLineStyle({strokeStyle:"none"});for(E=0;E<b[0].length;E++)N.setKeyLine(E,E-1.5);var T=[];for(E=0;E<b[3].length;E++)T.push("c/3");var I=new F.StaveNote({clef:"bass",keys:T,duration:"q"});I.setStemStyle({strokeStyle:"none"}),I.setLedgerLineStyle({strokeStyle:"none"});for(E=0;E<b[3].length;E++)I.setKeyLine(E,E-1.5);var A=new F.StaveNote({clef:"treble",keys:b[0],duration:"q"}),M=new F.StaveNote({clef:"bass",keys:b[3],duration:"q"}),P=b[6],D=b[7],L=b[8],z=b[9];function R(e,t){return new F.FretHandFinger(e).setPosition(t)}for(E=0;E<b[1].length;E++){A.addAccidental(E,new F.Accidental(b[1][E]));var W=R(P[E],F.Modifier.Position.RIGHT);W.setOffsetX(-10),N.note_heads[E].glyph_code="v23",N.addModifier(E,W),L[E]&&A.setKeyStyle(E,{shadowColor:L[E],shadowBlur:100}),1===b[2][E]&&(A.setKeyStyle(E,{fillStyle:l}),N.setKeyStyle(E,{fillStyle:l}))}for(E=0;E<b[3].length;E++){M.addAccidental(E,new F.Accidental(b[4][E]));var V=R(D[E],F.Modifier.Position.RIGHT);V.setOffsetX(-10),I.note_heads[E].glyph_code="v23",I.addModifier(E,V),z[E]&&M.setKeyStyle(E,{shadowColor:z[E],shadowBlur:100}),1===b[5][E]&&(M.setKeyStyle(E,{fillStyle:l}),I.setKeyStyle(E,{fillStyle:l}))}if(Array.isArray(b[0])&&b[0].length){var G=new F.Voice({num_beats:1,beat_value:4}).setMode(2),K=new F.Voice({num_beats:1,beat_value:4}).setMode(2);G.addTickables([A]),K.addTickables([N]);(new F.Formatter).joinVoices([G]).format([G],o);(new F.Formatter).joinVoices([K]).format([K],o).tickContexts.array[0].x=o-40,G.draw(this.context,p),K.draw(this.context,p)}var B=new F.Voice({num_beats:1,beat_value:4}),U=new F.Voice({num_beats:1,beat_value:4});if(U.addTickables([I]),Array.isArray(b[3])&&b[3].length){B.addTickables([M]);(new F.Formatter).joinVoices([B]).format([B],o);(new F.Formatter).joinVoices([U]).format([U],o).tickContexts.array[0].x=o-40,B.draw(this.context,g),U.draw(this.context,g)}if(Array.isArray(b[10])&&b[10].length){var H=new F.Voice({num_beats:1,beat_value:4}).setMode(2),J=new F.Voice({num_beats:1,beat_value:4}).setMode(2);H.addTickables([O]),J.addTickables([_]);(new F.Formatter).joinVoices([H]).format([H],o);(new F.Formatter).joinVoices([J]).format([J],o).tickContexts.array[0].x=o-40,H.draw(this.context,v),J.draw(this.context,v);var q=[];for(E=0;E<y.length;E++){var X=new F.StaveLine({first_note:O,last_note:_,first_indices:[E],last_indices:[E]});X.render_options.line_width=3,X.render_options.padding_right=-4,C[E]&&(X.render_options.color=C[E]),1===b[12][E]&&(X.render_options.color=l),q.push(X)}for(var Y=0;Y<q.length;Y++)q[Y].setContext(h),q[Y].draw()}var Q=[];for(E=0;E<S.length;E++){var $=new F.StaveLine({first_note:A,last_note:N,first_indices:[E],last_indices:[E]});$.render_options.line_width=3,$.render_options.padding_right=-4,L[E]&&($.render_options.color=L[E]),1===b[2][E]&&($.render_options.color=l),Q.push($)}var Z=[];for(E=0;E<T.length;E++){var ee=new F.StaveLine({first_note:M,last_note:I,first_indices:[E],last_indices:[E]});ee.render_options.line_width=3,ee.render_options.padding_right=-4,z[E]&&(ee.render_options.color=z[E]),1===b[5][E]&&(ee.render_options.color=l),Z.push(ee)}for(Y=0;Y<Q.length;Y++)Q[Y].setContext(h),Q[Y].draw();for(Y=0;Y<Z.length;Y++)Z[Y].setContext(h),Z[Y].draw();this.refs.outer.appendChild(e),this.refs.outer.addEventListener("click",this.orchClick.bind(this),!1)}},{key:"orchClick",value:function(e){var t=this.props,n=t.setProps,a=t.indexing;if(e.target.closest("text")&&a){var r=e.target.innerHTML.split(":"),o=parseInt(r[0]);n&&n({onClick:o}),console.log(o)}}},{key:"componentDidMount",value:function(){this.setupScore()}},{key:"componentDidUpdate",value:function(e){for(var t=this.refs.outer;t.hasChildNodes();)t.removeChild(t.lastChild);this.setupScore()}},{key:"render",value:function(){var e=this.props,t=e.id;e.notes,e.instruments,e.target;return r.a.createElement("div",{id:t,ref:"outer",style:{border:"none",padding:0,borderRadius:0,display:"inline-block"}})}}]),n}(a.Component);W.defaultProps={width:200,height:400,t_score_y:110,b_score_y:200,text_space:120,target_color:"red",highlights:[],indexing:!0};var V=R.a.Flow,G=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={x:0,y:0},a}return Object(i.a)(n,[{key:"setupScore",value:function(){var e=document.createElement("div"),t=this.props,n=(t.id,t.masking_notevalues),a=t.masking_notesizes,r=t.masking_colors,o=t.target_notevalues,s=t.target_notesizes,c=t.target_colors,i=(t.setProps,new V.Renderer(e,V.Renderer.Backends.SVG));i.resize(100,250);var l=i.getContext(),u=new V.Stave(10,60,100);u.addClef("treble"),u.setContext(l).draw();var m=new V.Stave(10,120,100);m.addClef("bass"),m.setContext(l).draw();var d=new V.StaveConnector(u,m);d.setType(V.StaveConnector.type.SINGLE_LEFT),d.setContext(l),d.draw();var f=new V.StaveConnector(u,m);f.setType(V.StaveConnector.type.BRACKET),f.setContext(l),f.draw();for(var h=[],p=[],g=[],b=[],v=[],y=[],E=0;E<n.length;E++)n[E]>59?(h.push(n[E]),p.push(a[E]),g.push(r[E])):(b.push(n[E]),v.push(a[E]),y.push(r[E]));var _=[],O=[],k=[],C=[],x=[],w=[];for(E=0;E<o.length;E++)o[E]>59?(_.push(o[E]),O.push(s[E]),k.push(c[E])):(C.push(o[E]),x.push(s[E]),w.push(c[E]));var j=new Array,S=new Array,N=new Array,T=new Array;function I(e,t){var n=0;return 40===t&&(n=-1),(e=(e-t)/4)>1+n&&(e+=.25),e>3+n&&(e+=.25),e>4.5+n&&(e+=.25),e>6.5+n&&(e+=.25),e>8+n&&(e+=.25),e>10+n&&(e+=.25),e>13.5+n&&(e+=.25),e>15.5+n&&(e+=.25),e}var A=[];if(Array.isArray(b)&&b.length){for(E=0;E<b.length;E++){var M=I(b[E],40);(z=new V.NoteHead({duration:"128",line:M,custom_glyph_code:"vd2",glyph_font_scale:v[E],style:{fillStyle:"none"}})).setCenterAlignment(!0),S.push(z)}var P=new V.Voice({num_beats:1,beat_value:1}).setMode(2);P.addTickables(S);(new V.Formatter).joinVoices([P]).format([P],1);P.draw(l,m)}if(Array.isArray(h)&&h.length){for(E=0;E<h.length;E++){M=I(h[E],60);(z=new V.NoteHead({duration:"128",line:M,custom_glyph_code:"vd2",glyph_font_scale:p[E],style:{fillStyle:"none"}})).setCenterAlignment(!0),j.push(z)}var D=new V.Voice({num_beats:1,beat_value:1}).setMode(2);D.addTickables(j);(new V.Formatter).joinVoices([D]).format([D],1);D.draw(l,u)}if(Array.isArray(_)&&_.length){N.push(new V.GhostNote("q"));for(E=0;E<_.length;E++){M=I(_[E],60);(z=new V.NoteHead({duration:"128",displaced:!1,line:M,custom_glyph_code:"vb",glyph_font_scale:O[E],style:{fillStyle:k[E]}})).setCenterAlignment(!0),N.push(z)}var L=new V.Voice({num_beats:1,beat_value:1}).setMode(2);L.addTickables(N);(new V.Formatter).joinVoices([L]).format([L],10);L.draw(l,u)}if(Array.isArray(C)&&C.length){T.push(new V.GhostNote("q"));for(E=0;E<C.length;E++){var z;M=I(C[E],60);(z=new V.NoteHead({duration:"128",displaced:!1,line:M,custom_glyph_code:"vb",glyph_font_scale:x[E],style:{fillStyle:w[E]}})).setCenterAlignment(!0),T.push(z)}var R=new V.Voice({num_beats:1,beat_value:1}).setMode(2);R.addTickables(T);(new V.Formatter).joinVoices([R]).format([R],10);R.draw(l,u)}if(Array.isArray(b)&&b.length)for(E=0;E<b.length;E++)A.push(P.tickables[E].y);if(Array.isArray(h)&&h.length)for(E=0;E<h.length;E++)A.push(D.tickables[E].y);for(var F=0;F<A.length-1;F++)l.beginPath().moveTo(40,A[F]).lineTo(90,A[F]).lineTo(90,A[F+1]).lineTo(40,A[F+1]).closePath().fill({fill:r[F]});l.beginPath().closePath(),this.refs.outer2.appendChild(e)}},{key:"componentDidMount",value:function(){this.setupScore()}},{key:"componentDidUpdate",value:function(e){for(var t=this.refs.outer2;t.hasChildNodes();)t.removeChild(t.lastChild);this.setupScore()}},{key:"render",value:function(){var e=this.props.id;return r.a.createElement("div",{id:e,ref:"outer2",style:{border:"none",padding:0,borderRadius:0,display:"inline-block"}})}}]),n}(a.Component);G.defaultProps={};var K=n(305),B=n(12),U=n(311),H=Object(B.a)(U.a)((function(e){var t=e.theme;return Object(d.a)(Object(d.a)({},t.typography.body2),{},{backgroundColor:"#fffef0",padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})}));function J(e){var t=["C","C#","D","D#","E","F","F#","G","G#","A","B#","B"];if(e.data.length<2)return null;var n=[{domain:{x:[0,1],y:[0,1]},value:e.data[2].var_coeff_graph,title:{text:"Orch. timbre homogeneity"},type:"indicator",mode:"gauge+number",gauge:{axis:{range:[null,100]}}}],r=e.data[2].fig_config,o=e.data[2].msking_graph.data,s=e.data[2].msking_graph.layout;return s.width=window.innerWidth-380,a.createElement("div",null,a.createElement(K.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:.5},a.createElement(K.a,{item:!0,xs:12,md:6},a.createElement(H,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(k.a,null,"Orchestration at clicked point"),a.createElement("div",{style:{backgroundColor:"rgba(0,255,0,0.3)",display:"inline"}},"Target"),a.createElement("div",{style:{backgroundColor:"rgba(255,0,0,0.5)",display:"inline"}}," Heaviest masker"),a.createElement("div",{style:{backgroundColor:"rgba(255,0,255,0.5)",display:"inline"}}," 2nd masker"),a.createElement("div",{style:{backgroundColor:"rgba(255,255,0,0.5)",display:"inline"}}," 3rd masker "),a.createElement(W,{notes:e.data[4].notenumbers.map((function(e){return function(e){var n=e-Math.floor(e),a=Math.round(e),r=t[a%12];return n>=.2&&n<.5?/[#]/.test(r)?r=t[(a+1)%12]+"d":r+="+":n>=.5&&n<=.8&&(/[#]/.test(r)?r=t[(a-1)%12]+"+":r+="d"),r+(Math.floor(a/12)-1)}(e)})),instruments:e.data[4].instruments,target:e.data[4].target,target_color:"green",highlights:e.data[4].highlights,width:200,text_space:200}))),a.createElement(K.a,{item:!0,xs:12,md:6},a.createElement(H,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(k.a,null,"Spectral centroid at clicked point"),a.createElement(W,{notes:e.data[2].centroid_graph.notes,instruments:e.data[2].centroid_graph.markings,target:[],width:150,text_space:200})))),a.createElement(K.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:.5},a.createElement(K.a,{item:!0,xs:12,md:6},a.createElement(H,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(k.a,null,"Timbre distance data"),a.createElement(k.a,null,"Target timbre distance from orchestration: ",e.data[2].distance_graph,"/100"),a.createElement(z.a,{data:n,layout:{width:350,margin:{t:0,b:0},plot_bgcolor:"#fffef0",paper_bgcolor:"#fffef0"},config:r}))),a.createElement(K.a,{item:!0,xs:12,md:6},a.createElement(H,{style:{height:452,backgroundColor:"#fffef0",verticalAlign:"center"}},a.createElement(k.a,null,"Masking staff graph"),a.createElement("br",null),a.createElement("br",null),a.createElement(G,{masking_notevalues:e.data[2].masking_score.masking_notevalues,masking_colors:e.data[2].masking_score.masking_colors,masking_notesizes:e.data[2].masking_score.masking_notesizes,target_notevalues:e.data[2].masking_score.target_notevalues,target_colors:e.data[2].masking_score.target_colors,target_notesizes:e.data[2].masking_score.target_notesizes})))),a.createElement(K.a,{style:{marginTop:.5,marginInline:0},container:!0,direction:"row",justifyContent:"left",alignItems:"left",spacing:.5},a.createElement(K.a,{item:!0,xs:12,md:12},a.createElement(H,null,a.createElement(z.a,{data:o,layout:Object(d.a)(Object(d.a)({},s),{},{width:window.innerWidth-50,margin:{l:0,r:0}}),config:r})))),a.createElement(K.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:.5},a.createElement(K.a,{item:!0,xs:12,md:8},a.createElement(H,null,a.createElement(z.a,{data:e.data[2].mfcc_graph.data,layout:Object(d.a)(Object(d.a)({},e.data[2].mfcc_graph.layout),{},{width:window.innerWidth/1.5-50,margin:{l:0,r:0},legend:{orientation:"h"}}),config:r,width:200}))),a.createElement(K.a,{item:!0,xs:12,md:4},a.createElement(H,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(k.a,null,"Summary of the current orchestration"),a.createElement("br",null),a.createElement("br",null),a.createElement(k.a,null,e.data[2].summary)))))}var q=n(141);function X(e){var t=function(e){var t=21,n={violin:2,viola:8,cello:11,double_bass:14,flute:15,oboe:16,clarinet:17,bassoon:18,horn:19,trumpet:22,tenor_trombone:23,bass_trombone:21,timpani:22,cymbal:24};return Object.keys(n).includes(e)&&(t=n[e]),t},n=[];e.instrumentList.map((function(e){return n.push(e[0])}));var r=[[10,50,3],[20,50,2],[30,50,1],[60,50,10],[70,50,11],[80,50,12],[15,35,6],[25,35,5],[40,40,4],[55,40,7],[65,35,8],[75,35,9],[86,35,13],[18,20,20],[32,20,19],[45,30,15],[50,30,16],[70,20,24],[80,20,14],[40,10,22],[50,10,21],[60,10,23],[45,20,17],[50,20,18],[45,55,25]],o=[];r.map((function(e){return o.push(!1)}));var s=a.useState({clicked:!1,over:!1,drop:"not yet",instrument_assignment:n.map((function(e){return t(e)})),hoverState:o,position:"audience",audio:"",play:!1}),c=Object(g.a)(s,2),i=c[0],l=c[1];if(a.useEffect((function(){l((function(e){return Object(d.a)(Object(d.a)({},e),{},{instrument_assignment:n.map((function(e){return t(e)}))})}))}),[e]),a.useEffect((function(){i.play&&document.getElementById("AUDIOPLAY").play()}),[]),0===e.instrumentList.length)return null;var u=function(e,t){if(console.log(e),t){var n=Object(N.a)(i.instrument_assignment);n[t.dragData.data]=e;var a=Object(N.a)(i.hoverState);a[e-1]=!1,l(Object(d.a)(Object(d.a)({},i),{},{instrument_assignment:n,hoverState:a}))}},m=function(e,t,n){var r=e+"%",o=t+"%";return a.createElement("div",{style:{left:r,position:"absolute",top:o}},a.createElement(q.DropTarget,{onHit:function(e){return u(n,e)},targetKey:"foo",onDragEnter:function(e){return function(e,t){var n=Object(N.a)(i.hoverState);n[e]=!0,l(Object(d.a)(Object(d.a)({},i),{},{hoverState:n}))}(n-1)},onDragLeave:function(e){return function(e,t){var n=Object(N.a)(i.hoverState);n[e]=!1,l(Object(d.a)(Object(d.a)({},i),{},{hoverState:n}))}(n-1)}},a.createElement("h2",{style:{backgroundColor:"rgba(0,255,0,0.3)",borderRadius:"30px",padding:6}},n," ",i.hoverState[n-1]?"DROP HERE":"")))};return a.createElement("div",{style:{maxWidth:800,textAlign:"center",margin:"auto",alignItems:"center"}},a.createElement("div",{style:{padding:20}},"Here you can listen how your orchestration sounds like played with real instruments in Helsinki Music Center hall. The algorithm utilize pre-calculated impulse responses. Helsinki Musiikkitalo spatial impulse response measurements are done by Aalto University. They are used here with permission from Prof. Tapio Lokki, who has computed the binaural responses"),a.createElement("div",{style:{marginTop:-20,padding:20}},"Drag the instruments of your orchestration to the place on stage you want them to play. Select the listening position, selecting 'conductor' places you on the conductor podium and 'audience' to the center of row 6. When you are ready, tap 'listen' and wait for a few seconds for calculations."),a.createElement(p.a,{onClick:function(){l(Object(d.a)(Object(d.a)({},i),{},{audio:""}));var t={orchestration:e.instrumentList.map((function(e){return e[0]+","+e[1]+","+e[2]+","+e[3]})),positions:i.instrument_assignment,listeningPosition:i.position};x.a.post("https://rest.score-tool.com/listen",t,{headers:{auth:"uljasPulkkis"}}).then((function(e){var t=a.createElement("div",null,a.createElement("audio",{controls:!0,autoPlay:"true",id:"AUDIOPLAY"}," ",a.createElement("source",{src:e.data,type:"audio/x-wav"})," "));l(Object(d.a)(Object(d.a)({},i),{},{audio:t,play:!0}))})).catch((function(e){return console.log(e)}))},variant:"contained"},"click here to calculate acoustics and listen"),i.audio,a.createElement("div",{style:{display:"block"}},a.createElement(O.a,{sx:{m:1,minWidth:50}},a.createElement(E.a,{id:"listen-select"},"Position"),a.createElement(y.a,{labelId:"listen-select",id:"listen-select",value:i.position,onChange:function(e){return l(Object(d.a)(Object(d.a)({},i),{},{position:e.target.value}))},autoWidth:!0,label:"listen-select"},a.createElement(_.a,{value:"audience"},"audience"),a.createElement(_.a,{value:"conductor"},"conductor")))),a.createElement("div",{style:{float:"left"}},n.map((function(e,t){return a.createElement(q.DragDropContainer,{dragClone:!1,targetKey:"foo",onDrop:u,dragData:{data:t}},a.createElement("div",{style:{backgroundColor:"rgba(0,255,255,0.3)",borderRadius:"30px",fontSize:24,padding:10}},e+": "+i.instrument_assignment[t]))}))),a.createElement("div",{style:{clear:"both"}},"\xa0"),a.createElement("div",{style:{backgroundImage:"url(./musatalo.jpg)",position:"relative",backgroundSize:"100% 120%",backgroundRepeat:"no-repeat"}},a.createElement("div",{style:{minHeight:"50vh"}},r.map((function(e){return m(e[0],e[1],e[2])})))))}function Y(e){var t=e.text,n=e.orchestration,r=a.useState({textFieldValue:t,saved:!1}),o=Object(g.a)(r,2),s=o[0],c=o[1];a.useEffect((function(){c((function(e){return Object(d.a)(Object(d.a)({},e),{},{saved:!1,textFieldValue:t})}))}),[n]);var i=function(){if(n.length>0){var e=JSON.parse(localStorage.getItem("orchestrations")),t=0;null!=e&&(e.length>0&&(t=e[e.length-1].id+1),console.log(n),console.log(typeof n[0][3]),"number"===typeof n[0][3]?e.push({id:t,name:s.textFieldValue,data:n.map((function(e){return[e[0],e[1],e[2],[e[3]],e[4],e[5],e[6]]}))}):e.push({id:t,name:s.textFieldValue,data:n}),localStorage.setItem("orchestrations",JSON.stringify(e)),c((function(e){return Object(d.a)(Object(d.a)({},e),{},{saved:!0})})))}},l=function(e){var t=e.target.value;c((function(e){return Object(d.a)(Object(d.a)({},e),{},{textFieldValue:t})}))};return a.createElement("div",null,s.saved?a.createElement("div",{style:{textAlign:"center"}},"Saved!"):a.createElement("div",null,a.createElement(I.a,{fullWidth:!0,value:s.textFieldValue,label:"save name",onChange:l}),a.createElement(p.a,{fullWidth:!0,variant:"contained",color:"secondary",onClick:i}," Save to your list of orchestrations ")))}var Q=n(291),$=n(290);function Z(e){var t=Object(a.useState)({idx:e.idx,scoreNames:e.row[0],scoreTechs:e.row[1],scoreDyns:e.row[2],scorePitch:e.row[3],scoreTgt:e.row[4],scoreOnoff:e.row[5],scoreIdx:e.row[6],scoreMicro:0,color:e.color,scoreModify:0}),n=Object(g.a)(t,2),o=n[0],s=n[1],c=function(t,n){var a=0;0===o.scoreModify?a=-12:-12===o.scoreModify&&(a=12),s((function(t){return Object(d.a)(Object(d.a)({},t),{},{scoreModify:a,scorePitch:e.row[3]+a})})),e.onChange({idx:o.idx,row:[o.scoreNames,o.scoreTechs,o.scoreDyns,e.row[3]+a,o.scoreTgt,o.scoreOnoff,o.scoreIdx,o.scoreMicro]})},i=[];-12===o.scoreModify?i=r.a.createElement("div",{onClick:c,style:{backgroundColor:"rgba(123,30,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}},"-12"):12===o.scoreModify?i=r.a.createElement("div",{onClick:c,style:{backgroundColor:"rgba(30,123,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}},"12"):0===o.scoreModify&&(i=r.a.createElement("div",{onClick:c,style:{backgroundColor:"rgba(30,30,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}},"0"));var l=function(e,t){s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreMicro:t})}))},u=function(t,n){e.onChange({idx:o.idx,row:[o.scoreNames,o.scoreTechs,o.scoreDyns,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx,o.scoreMicro]})};return r.a.createElement("tr",null,r.a.createElement("td",{key:"scor"+o.idx,style:{backgroundColor:o.color}},o.scoreNames),r.a.createElement("td",{key:"tec"+o.idx},o.scoreTechs),r.a.createElement("td",{key:"dy"+o.idx},r.a.createElement("div",{onClick:function(t,n){var a="mf";"mf"===o.scoreDyns?a="f":"f"===o.scoreDyns&&(a="p"),s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreDyns:a})})),e.onChange({idx:o.idx,row:[o.scoreNames,o.scoreTechs,a,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx,o.scoreMicro]})},style:{backgroundColor:"rgba(123,200,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}}," ",o.scoreDyns," ")),r.a.createElement("td",{key:"micro"+o.idx},r.a.createElement($.a,{sx:{width:60,height:15,verticalAlign:"top",marginTop:-2}},r.a.createElement(Q.a,{spacing:1,direction:"row",sx:{mb:1},alignItems:"center"},r.a.createElement("img",{src:"/flat.png",height:"15"}),r.a.createElement(b.a,{valueLabelDisplay:"auto","aria-label":"tune",size:"small",min:-.49,step:.01,max:.49,value:o.scoreMicro,onChangeCommitted:u,onChange:l}),r.a.createElement("img",{src:"/sharp.png",height:"15"})))),r.a.createElement("td",{key:"tg"+o.idx},r.a.createElement("div",{onClick:function(t,n){s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTgt:!e.scoreTgt})})),e.onChange({idx:o.idx,row:[o.scoreNames,o.scoreTechs,o.scoreDyns,o.scorePitch,!o.scoreTgt,o.scoreOnoff,o.scoreIdx,o.scoreMicro]})},style:{backgroundColor:"rgba(123,200,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}},o.scoreTgt?"target":"orchestration")),r.a.createElement("td",{key:"onof"+o.idx}," ",r.a.createElement("div",{onClick:function(t,n){s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreOnoff:!e.scoreOnoff})})),e.onChange({idx:o.idx,row:[o.scoreNames,o.scoreTechs,o.scoreDyns,o.scorePitch,o.scoreTgt,!o.scoreOnoff,o.scoreIdx,o.scoreMicro]})},style:{backgroundColor:o.scoreOnoff?"rgba(123,200,30,0.3)":"rgba(200,123,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}},o.scoreOnoff?"ON":"OFF"," ")),r.a.createElement("td",{key:"mo"+o.idx},i))}var ee=n(320);function te(e){var t=[];e.instrumentList.map((function(e){return t.push(e[0])}));var n=function(e){var t=21,n={violin:2,viola:8,cello:11,double_bass:14,flute:15,oboe:16,clarinet:17,bassoon:18,horn:19,trumpet:22,tenor_trombone:23,bass_trombone:21,timpani:22,cymbal:24};return Object.keys(n).includes(e)&&(t=n[e]),t},r=a.useState({instrument_assignment:t.map((function(e){return n(e)}))}),o=Object(g.a)(r,2),s=o[0],c=o[1];a.useEffect((function(){c((function(e){return Object(d.a)(Object(d.a)({},e),{},{instrument_assignment:t.map((function(e){return n(e)}))})}))}),[e]);return a.createElement("div",{style:{transform:"scale(0.8,0.8)"}},a.createElement(p.a,{size:"small",onClick:function(){c(Object(d.a)(Object(d.a)({},s),{},{audio:""}));var t={orchestration:e.instrumentList.map((function(e){return e[0]+","+e[1]+","+e[2]+","+e[3]})),positions:s.instrument_assignment,listeningPosition:"audience"};x.a.post("https://rest.score-tool.com/listen",t,{headers:{auth:"uljasPulkkis"}}).then((function(e){var t=a.createElement("div",{style:{transform:"scale(0.5,0.5)"}},a.createElement("audio",{controls:!0,autoPlay:"true",id:"AUDIOPLAY"}," ",a.createElement("source",{src:e.data,type:"audio/x-wav"})," "));c(Object(d.a)(Object(d.a)({},s),{},{audio:t}))})).catch((function(e){return console.log(e)}))},variant:"contained"},"Quick listen"),s.audio)}var ne=a.forwardRef((function(e,t){return a.createElement(D.a,Object.assign({direction:"up",ref:t},e))}));function ae(e){var t=a.useState(!1),n=Object(g.a)(t,2),r=n[0],o=n[1],s=a.useState([]),c=Object(g.a)(s,2),i=c[0],l=c[1],u=a.useState([]),m=Object(g.a)(u,2),f=m[0],h=m[1],p=a.useState([]),b=Object(g.a)(p,2),v=b[0],y=b[1],E=a.useState([]),_=Object(g.a)(E,2),O=_[0],C=_[1],w=a.useState([]),j=Object(g.a)(w,2),S=j[0],I=j[1],D=a.useState(!1),L=Object(g.a)(D,2),z=(L[0],L[1],a.useState({textFieldValue:"orchestration"})),R=Object(g.a)(z,2),F=R[0],W=R[1],V=a.useState(0),G=Object(g.a)(V,2),K=G[0],B=G[1],U=[],H=[];a.useEffect((function(){o((function(t){return e.open})),e.data.length>1&&(l((function(t){return e.data[1]})),h([])),e.data.length>1&&(B((function(t){return 100-e.data[0].data[2].masking_percent})),y((function(t){return e.data[0].data})),W((function(t){return Object(d.a)(Object(d.a)({},t),{},{textFieldValue:JSON.parse(localStorage.getItem("orchestrations")).length+": "+e.data[2]})})),e.data[1].map((function(e){U.push(""),H.push("")})),e.data[0].data[3].map((function(e,t){0===t?(U[e]="red",H[e]="strongest masker"):1===t?(U[e]="magenta",H[e]="2nd masker"):2===t?(U[e]="yellow",H[e]="3rd masker"):(U[e]="",H[e]="")})),C(U),I(H))}),[e]);var q=function(t){var n=[];(n=0===f.length?Object(N.a)(i):Object(N.a)(f))[t.idx]=t.row,h((function(e){return n}));var a=[];n.map((function(e){e[5]&&a.push(e)})),x.a.post("https://rest.score-tool.com/modalSlice",a).then((function(t){var n=t.data;y((function(e){return e.data=n.data})),B((function(e){return 100-n.data[2].masking_percent}));var r=[],o=[];e.data[1].map((function(e){r.push(""),o.push("")})),n.data[3].map((function(t,n){if(0===n){var s=a[t][6];e.data[1].map((function(e,t){e[6]===s&&(r[t]="red",o[t]="strongest masker")}))}else if(1===n){var c=a[t][6];e.data[1].map((function(e,t){e[6]===c&&(r[t]="magenta",o[t]="2nd masker")}))}else if(2===n){var i=a[t][6];e.data[1].map((function(e,t){e[6]===i&&(r[t]="yellow",o[t]="3rd masker")}))}})),C((function(e){return r})),I(o)}))},Q=[];0===f.length?Q=i:f.map((function(e){e[5]&&Q.push([e[0],e[1],e[2],e[3]+e[7]])}));var ae=["C","C#","D","D#","E","F","F#","G","G#","A","Bb","B"];return a.createElement("div",null,a.createElement(T.a,{fullScreen:!0,open:r,onClose:e.handleClose,TransitionComponent:ne,PaperProps:{style:{backgroundColor:"#fffef0"}}},a.createElement(A.a,{sx:{position:"relative",backgroundColor:"#dcc4ac",color:"#4c4c48"}},a.createElement(M.a,null,a.createElement(P.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},a.createElement("div",null,"Click here, or press ESC to close")))),a.createElement("div",{style:{textAlign:"center"}},a.createElement(k.a,null,"You can alter the orchestration by clicking the colored values. The changes do not affect the original score."),a.createElement("table",{style:{margin:"auto",display:"inline"}},a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,"Instr."),a.createElement("td",null,"Tech."),a.createElement("td",null,"Dyn."),a.createElement("td",null,"Tune"),a.createElement("td",null,"Role"),a.createElement("td",null,"On/Off"),a.createElement("td",null,"Transpose +- oct.")),i.map((function(e,t){return a.createElement(Z,{onChange:q,idx:t,row:e,color:""})})))),a.createElement("table",{style:{margin:"auto",display:"inline"}},a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,"maskers")),O.map((function(e,t){return a.createElement("tr",null,a.createElement("td",{style:{backgroundColor:e,borderRadius:10,padding:4,textAlign:"center",margin:4}},i[t][0]," ",(n=i[t][3],ae[n%12]+(Math.floor(n/12)-1))," "+S[t]));var n})))),a.createElement("br",null),a.createElement(k.a,{variant:"caption",component:"div",color:"text.secondary"},"Target audibility:"),a.createElement($.a,{sx:{position:"relative",display:"inline-flex"}},a.createElement(ee.a,{variant:"determinate",value:K,color:K<=30?"error":K<=50?"warning":"success"}),a.createElement($.a,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"}},a.createElement(k.a,{variant:"caption",component:"div",color:"text.secondary"},"".concat(Math.round(K),"%")))),a.createElement("br",null),a.createElement(Y,{text:F.textFieldValue,orchestration:i}),a.createElement(te,{instrumentList:Q}),a.createElement(J,{data:v}),a.createElement(X,{instrumentList:Q}))))}var re=n(321);function oe(e){var t=Object(a.useState)({idx:e.idx,instName:e.instName,scoreNames:e.scoreNames,scoreTechs:e.scoreTechs,scoreDyns:e.scoreDyns,scoreTgt:e.scoreTgt,scoreOnoff:e.scoreOnoff,scoreModify:e.scoreModify}),n=Object(g.a)(t,2),o=n[0],s=n[1];e.onChange({instName:o.instName,scoreNames:o.scoreNames,scoreTechs:o.scoreTechs,scoreDyns:o.scoreDyns,scoreTgt:o.scoreTgt,scoreOnoff:o.scoreOnoff,scoreModify:o.scoreModify});var c,i;return r.a.createElement("tr",null,r.a.createElement("td",{key:"nam"+o.idx},o.instName),r.a.createElement("td",{key:"scor"+o.idx},function(e,t){var n=Object.keys(j);return r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"instrument-select"},"Instr."),r.a.createElement(y.a,{labelId:"instrument-select",id:"instrument-sel"+t,value:e,onChange:function(e){return t=e,void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreNames:t.target.value})}));var t},autoWidth:!0,label:"instr."},n.map((function(e){return r.a.createElement(_.a,{value:e},e)})))))}(o.scoreNames,o.idx)),r.a.createElement("td",{key:"tec"+o.idx},function(e,t){var n=j[o.scoreNames];return r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"tech-select"},"Tech."),r.a.createElement(y.a,{labelId:"tech-select",id:"tech-sel"+t,value:e,onChange:function(e){return t=e,void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTechs:t.target.value})}));var t},autoWidth:!0,label:"tech."},n.map((function(e){return r.a.createElement(_.a,{value:e},e)})))))}(o.scoreTechs,o.idx)),r.a.createElement("td",{key:"dy"+o.idx},(c=o.scoreDyns,i=o.idx,r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"dyn-select"},"Dyn."),r.a.createElement(y.a,{labelId:"dyn-select",id:"dyn-sel"+i,value:c,onChange:function(e){return t=e,void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreDyns:t.target.value})}));var t},autoWidth:!0,label:"dyn."},["from_score","p","mf","f"].map((function(e){return r.a.createElement(_.a,{value:e},e)}))))))),r.a.createElement("td",{key:"tg"+o.idx},r.a.createElement("div",{style:{border:"1px solid lightGray",borderRadius:5,padding:8}},r.a.createElement(Q.a,{direction:"row",spacing:1,alignItems:"center"},r.a.createElement(k.a,null,"orch."),r.a.createElement(re.a,{key:"tgtswitch"+o.idx,checked:o.scoreTgt,color:"secondary",onChange:function(e){return o.idx,(t=e).persist(),void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTgt:t.target.checked})}));var t}}),r.a.createElement(k.a,null,"tgt")))),r.a.createElement("td",{key:"onoff"+o.idx},r.a.createElement("div",{style:{border:"1px solid lightGray",borderRadius:5,padding:8}},r.a.createElement(Q.a,{direction:"row",spacing:1,alignItems:"center"},r.a.createElement(k.a,null,"off"),r.a.createElement(re.a,{key:"onoffswitch"+o.idx,checked:o.scoreOnoff,onChange:function(e){return o.idx,(t=e).persist(),void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreOnoff:t.target.checked})}));var t}}),r.a.createElement(k.a,null,"on")))),r.a.createElement("td",{key:"mod"+o.idx},function(e,t){return r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"mod-select"},"Transpose"),r.a.createElement(y.a,{labelId:"mod-select",id:"mod-sel"+t,value:e,onChange:function(e){return t=e,void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreModify:t.target.value})}));var t},autoWidth:!0,label:"trans."},[0,12,-12,24,-24].map((function(e){return r.a.createElement(_.a,{value:e},e)})))))}(o.scoreModify,o.idx)))}var se=n(171),ce=Object(B.a)(U.a)((function(e){var t=e.theme;return Object(d.a)(Object(d.a)({},t.typography.body2),{},{backgroundColor:"#fffef0",padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})})),ie=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={dataReady:!1,loaded:!1,cur:!1,calculIndications:!1,measureTimestamps:[],measureRange:[1,2],maxMeasure:2,instNames:[],scoreNames:[],scoreTechs:[],scoreDyns:[],scoreTgt:[],scoreOnoff:[],scoreModify:[],instData:{},open:!1,time:[],modalData:[]},a.osmd=void 0,a.orchestrationChords=void 0,a.cursor=void 0,a.next=void 0,a.show=!0,a.divRef=r.a.createRef(),a.measureHandleChange=a.measureHandleChange.bind(Object(l.a)(a)),a.calculateMasking=a.calculateMasking.bind(Object(l.a)(a)),a.update=a.update.bind(Object(l.a)(a)),a.handleClose=a.handleClose.bind(Object(l.a)(a)),a}return Object(i.a)(n,[{key:"setupOsmd",value:function(){var e=this,t={autoResize:void 0!==this.props.autoResize&&this.props.autoResize,drawTitle:void 0===this.props.drawTitle||this.props.drawTitle,loadUrlTimeout:1e4};this.osmd=new h.OpenSheetMusicDisplay(this.divRef.current,t),this.osmd.setLogLevel("trace"),this.osmd.load(this.props.file).then((function(){var t=.5,n=e.osmd.sheet.staves.length;n>10?t=.4:n>20?t=.2:n>30?t=.1:n>40&&(t=.05),e.osmd.zoom=t;var a=[],r=[],o=[],s=[],c=[],i=[],l=[];e.osmd.sheet.staves.map((function(e){a.push(e.parentInstrument.nameLabel.text),r.push(function(e){var t=e;return e.toLowerCase().startsWith("clarinet in b")&&(t="clarinet"),e.toLowerCase().startsWith("bass clarinet")&&(t="bass_cl"),e.toLowerCase().startsWith("solo")&&(t=e.substr(5)),e.toLowerCase().startsWith("trombone")&&(t="tenor_trombone"),e.toLowerCase().startsWith("contrabass")&&(t="double_bass"),"baritone"===e.toLowerCase()&&(t="tuba"),t.toLowerCase().startsWith("natural")&&(t="horn"),Object(w.a)(t,Object.keys(j))[0][0]}(e.parentInstrument.nameLabel.text)),o.push("normal"),s.push("from_score"),c.push(0),i.push(1),l.push(0)}));var u=[];e.osmd.sheet.sourceMeasures.map((function(e){return u.push(e.absoluteTimestamp.realValue)})),u.push(999999),e.setState((function(t){t.measureRange=[1,e.osmd.sheet.SourceMeasures.length],t.maxMeasure=e.osmd.sheet.SourceMeasures.length,t.instNames=a,t.scoreNames=r,t.scoreTechs=o,t.scoreDyns=s,t.scoreTgt=c,t.scoreOnoff=i,t.scoreModify=l,t.measureTimestamps=u})),e.forceUpdate()}))}},{key:"update",value:function(){this.osmd.updateGraphic()}},{key:"renderScore",value:function(){var e=this;this.osmd.setOptions({drawFromMeasureNumber:this.state.measureRange[0],drawUpToMeasureNumber:this.state.measureRange[1],backend:"svg"}),this.osmd.render(),this.setState((function(e){return e.loaded=!0}));for(var t=[],n=0;n<this.osmd.graphic.VerticalGraphicalStaffEntryContainers[0].StaffEntries.length;n++)t.push({0:"mf"});var a={},r={},o=[];o.length=this.state.instNames.length;for(var s=[],c=0;c<this.state.instNames.length;c++)s.push("mf");this.osmd.sheet.sourceMeasures.map((function(t){t.absoluteTimestamp.realValue<e.state.measureTimestamps[e.state.measureRange[0]-1]&&t.staffLinkedExpressions.map((function(e,t){e.length>0&&e.map((function(e){e.expressions.map((function(e){e.expression.dynamicEnum<=5?s[t]="p":e.expression.dynamicEnum<=7?s[t]="mf":e.expression.dynamicEnum<=13&&(s[t]="f")}))}))}))})),this.osmd.graphic.VerticalGraphicalStaffEntryContainers.map((function(n){var c=[];if(c.length=n.StaffEntries.length,n.absoluteTimestamp.realValue>=e.state.measureTimestamps[e.state.measureRange[0]-1]&&n.absoluteTimestamp.realValue<=e.state.measureTimestamps[e.state.measureRange[1]])for(var i=function(e){c[e]=[],n.StaffEntries[e]?("undefined"!==typeof n.StaffEntries[e].parentMeasure.parentStaffLine&&n.StaffEntries[e].parentMeasure.parentStaffLine.hasOwnProperty("abstractExpressions")&&n.StaffEntries[e].parentMeasure.parentStaffLine.abstractExpressions.map((function(n){n.SourceExpression.hasOwnProperty("multiExpression")&&(t[e][String(n.SourceExpression.multiExpression.AbsoluteTimestamp.realValue)]=n.Expression)})),n.StaffEntries[e].sourceStaffEntry.voiceEntries&&n.StaffEntries[e].sourceStaffEntry.voiceEntries[0].notes.map((function(a){a.halfTone>0&&(t[e].hasOwnProperty(String(n.AbsoluteTimestamp.realValue))&&(s[e]=t[e][String(n.AbsoluteTimestamp.realValue)]),r[String(n.AbsoluteTimestamp.realValue)]=n.StaffEntries[e].boundingBox.absolutePosition.x,c[e].push({note:Math.round(a.halfTone),dynamic:s[e]}),o[e]={note:Math.round(a.halfTone),start:n.AbsoluteTimestamp.realValue,duration:a.length.realValue})}))):o[e]&&(o[e].start+o[e].duration>=n.AbsoluteTimestamp.realValue?(t[e].hasOwnProperty(String(n.AbsoluteTimestamp.realValue))&&(s[e]=t[e][String(n.AbsoluteTimestamp.realValue)]),c[e].push({note:o[e].note,dynamic:s[e]})):o[e]=[])},l=0;l<n.StaffEntries.length;l++)i(l);a[n.AbsoluteTimestamp.realValue]=c})),this.orchestrationChords={instruments:this.state.instNames,databaseEntries:{inst:this.state.scoreNames,tech:this.state.scoreTechs,dyn:this.state.scoreDyns,tgt:this.state.scoreTgt,onoff:this.state.scoreOnoff,modify:this.state.scoreModify},dynamics:t,notes:a,xpos:r}}},{key:"resize",value:function(){}},{key:"handleClose",value:function(){this.setState((function(e){return e.open=!1}))}},{key:"measureHandleChange",value:function(e,t,n){var a=this;Array.isArray(t)&&this.setState((function(e){return Object(d.a)(Object(d.a)({},a.state),{},{measureRange:t})}))}},{key:"calculateMasking",value:function(){var e=0;function t(n){var a=this,r=this.osmd.graphic.VerticalGraphicalStaffEntryContainers[n];if(r.absoluteTimestamp.realValue>=this.state.measureTimestamps[this.state.measureRange[0]-1]&&r.absoluteTimestamp.realValue<=this.state.measureTimestamps[this.state.measureRange[1]]){var o=this.orchestrationChords.notes[r.absoluteTimestamp.realValue],s=[],c=[],i=!1;o.map((function(e,t){if(a.orchestrationChords.databaseEntries.tgt[t]&&c.push(t),e.length>0){var n=[];"from_score"!==a.orchestrationChords.databaseEntries.dyn[t]&&(n=a.orchestrationChords.databaseEntries.dyn[t]),a.orchestrationChords.databaseEntries.tgt[t]&&(i=!0),e.map((function(e){0===n.length&&["ppppp","pppp","ppp","pp","p"].includes(e.dynamic)?n="p":0===n.length&&["fffff","ffff","fff","ff","f","sfz","sf"].includes(e.dynamic)?n="f":0===n.length&&["mf","mp","mfz"].includes(e.dynamic)&&(n="mf"),s.push([a.orchestrationChords.databaseEntries.inst[t],a.orchestrationChords.databaseEntries.tech[t],n,e.note+12+a.orchestrationChords.databaseEntries.modify[t],a.orchestrationChords.databaseEntries.tgt[t],a.orchestrationChords.databaseEntries.onoff[t],t])}))}})),s=s.filter((function(e,t,n){if(!e[5])return!1;try{return e[3]>=S[e[0]][e[1]][e[2]][0]&&e[3]<=S[e[0]][e[1]][e[2]][1]}catch(a){return!1}}));x.a.post("https://rest.score-tool.com/maskingSlice",s).then((function(e){var t=e.data,n=[];r.StaffEntries.map((function(e){return n=e.sourceStaffEntry.voiceEntries[0].notes[0]}));var o=n.parentStaffEntry.verticalContainerParent.parentMeasure.measureNumber,s=a.orchestrationChords.xpos[r.absoluteTimestamp.realValue]-1,l=a.osmd.graphic.MusicPages[0];t&&(i&&c.map((function(e){var n=a.osmd.graphic.musicSheet.sourceMeasures[o-1].verticalMeasureList[e].boundingBox.absolutePosition.y+2,r=new h.PointF2D(s,n),c=new h.PointF2D(s+2,n),i=function(e){var t="rgba(0,255,0,0.3)";if(e>=75){var n=1-(e-74.9)/50;t="rgba(".concat(Math.round(255*n),",0,0,0.7)")}else if(e>=50){var a=1-(e-54.9)/25;t="rgba(255,".concat(Math.round(255*a),",0,0.5)")}else if(e>=25){var r=(e-24.9)/25;t="rgba(".concat(Math.round(255*r),",255,0,0.5)")}return t}(t[0]);a.osmd.Drawer.DrawOverlayLine(r,c,l,i,4)})),t[1]&&t[1].map((function(e,t){var n=a.osmd.graphic.musicSheet.sourceMeasures[o-1].verticalMeasureList[e].boundingBox.absolutePosition.y+2,r=new h.PointF2D(s,n),c=new h.PointF2D(s+2,n),i=[];0===t?(i="rgba(255,51,255,0.5)",a.osmd.Drawer.DrawOverlayLine(r,c,l,i,4)):1===t?(i="rgba(255,153,51,0.5)",a.osmd.Drawer.DrawOverlayLine(r,c,l,i,4)):2===t&&(i="rgba(51,153,355,0.5)",a.osmd.Drawer.DrawOverlayLine(r,c,l,i,4))})))})).finally((function(){e++,a.osmd.graphic.VerticalGraphicalStaffEntryContainers.length>e&&t(e)}))}else e++,this.osmd.graphic.VerticalGraphicalStaffEntryContainers.length>e&&t(e)}(t=t.bind(this))(e),this.setState((function(e){return e.calculIndications=!0}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"componentDidUpdate",value:function(e){(this.props.drawTitle!==e.drawTitle||this.props.file!==e.file)&&this.setupOsmd();var t=!1;this.props.file&&"undefined"!==typeof this.osmd&&"undefined"!==typeof this.osmd.cursor&&(("undefined"===typeof this.osmd.cursor.hidden||this.osmd.cursor.hidden)&&(t=!0),this.props.show&&t&&this.osmd.cursor.show(),this.props.next!==e.next&&(this.osmd.cursor.next(),console.log(this.osmd.cursor),console.log(this.osmd.cursor.NotesUnderCursor()),console.log(this.osmd.cursor.VoicesUnderCursor()),console.log(this.osmd.cursor.iterator.currentTimeStamp.RealValue)),window.addEventListener("resize",this.resize))}},{key:"componentDidMount",value:function(){this.props.file&&this.setupOsmd()}},{key:"render",value:function(){var e=this,t=[],n="inline-block";this.state.loaded&&(n="none",t=r.a.createElement("div",null,r.a.createElement(p.a,{variant:"contained",color:"secondary",onClick:function(){e.calculateMasking()}},"calculate masking"),r.a.createElement(p.a,{style:{marginInline:10},variant:"contained",color:"warning",onClick:function(){e.renderScore()}},"redraw score (remove masking indications)"),r.a.createElement(p.a,{variant:"contained",color:"primary",onClick:function(){return se.saveSvgAsPng(document.getElementById("osmdSvgPage1"),"score.png")}},"Download the score as PNG"),r.a.createElement(k.a,{variant:"h5",style:{display:"block"}}," Click any note in score for full analysis.")));return r.a.createElement(r.a.Fragment,null,r.a.createElement(ce,{style:{textAlign:"center",justifyContent:"center",alignItems:"center",alignContent:"center",marginLeft:"auto",marginRight:"auto"}},r.a.createElement("div",null,r.a.createElement("table",{style:{margin:"auto"}},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"score name"),r.a.createElement("th",null,"instrument"),r.a.createElement("th",null,"technique"),r.a.createElement("th",null,"dynamic"),r.a.createElement("th",null,"orch/target"),r.a.createElement("th",null,"on/off"),r.a.createElement("th",null,"transpose")),this.state.instNames.map((function(t,n){return r.a.createElement(oe,{idx:n,instName:t,scoreNames:e.state.scoreNames[n],scoreTechs:e.state.scoreTechs[n],scoreDyns:e.state.scoreDyns[n],scoreTgt:e.state.scoreTgt[n],scoreOnoff:e.state.scoreOnoff[n],scoreModify:e.state.scoreModify[n],onChange:function(t){return a=n,r=t,void e.setState((function(e){e.scoreNames[a]=r.scoreNames,e.scoreTechs[a]=r.scoreTechs,e.scoreDyns[a]=r.scoreDyns,e.scoreTgt[a]=r.scoreTgt,e.scoreOnoff[a]=r.scoreOnoff,e.scoreModify[a]=r.scoreModify}));var a,r}})}))))),r.a.createElement(k.a,null,"Select bar range with slider"),r.a.createElement(v,{range:this.state.measureRange,max:this.state.maxMeasure,measureHandleChange:this.measureHandleChange}),r.a.createElement(p.a,{style:{display:n},variant:"contained",onClick:function(){e.renderScore()}},"Show score"),t),this.state.calculIndications&&r.a.createElement(k.a,{style:{display:"inline"}},"Color indications:",r.a.createElement("div",{style:{backgroundImage:"linear-gradient(to right, rgba(120,0,0,0.7) , rgba(255,0,0,0.5))",display:"inline",marginInline:2}}," Target masked"),r.a.createElement("div",{style:{backgroundImage:"linear-gradient(to right, rgba(255,0,0,0.5) , rgba(255,255,0,0.5))",display:"inline",marginInline:2}}," Target nearly masked"),r.a.createElement("div",{style:{backgroundImage:"linear-gradient(to right, rgba(255,255,0,0.5) , rgba(0,255,0,0.3))",display:"inline",marginInline:2}}," Target audible"),r.a.createElement("div",{style:{backgroundColor:"rgba(255,51,255,0.5)",display:"inline"}}," Orchestration heaviest masker"),r.a.createElement("div",{style:{backgroundColor:"rgba(255,153,51,0.5)",display:"inline"}}," Orchestration second heaviest masker"),r.a.createElement("div",{style:{backgroundColor:"rgba(51,153,255,0.5)",display:"inline"}}," Orchestration third heaviest masker ")),r.a.createElement(ce,null,r.a.createElement("div",{ref:this.divRef,style:{width:window.innerWidth-100},onClick:function(t){var n=t.clientX,a=t.clientY,r=new h.PointF2D(n,a);r=e.osmd.graphic.domToSvg(r),r=e.osmd.graphic.svgToOsmd(r);var o=e.osmd.graphic.GetNearestNote(r,{x:15,y:15});if("undefined"!==typeof o){var s=o.sourceNote.voiceEntry.parentSourceStaffEntry.AbsoluteTimestamp.realValue;console.log("thnote"),console.log(o);var c="";try{c=o.ParentMusicPage.labels[0].label.text+", Bar:"+o.vfnote[0].stave.MeasureNumber+", Position:"+o.parentVoiceEntry.parentStaffEntry.relInMeasureTimestamp.realValue}catch(d){c="Score orchestral chord"}for(e.osmd.cursor.hide(),e.osmd.cursor.reset();e.osmd.cursor.iterator.currentTimeStamp.RealValue!=s;)e.osmd.cursor.next();e.osmd.cursor.show();var i=e.orchestrationChords.notes[s],l=[],u=[],m=!1;i.map((function(t,n){if(e.orchestrationChords.databaseEntries.tgt[n]&&u.push(n),t.length>0){var a=[];"from_score"!==e.orchestrationChords.databaseEntries.dyn[n]&&(a=e.orchestrationChords.databaseEntries.dyn[n]),e.orchestrationChords.databaseEntries.tgt[n]&&(m=!0),t.map((function(t){0===a.length&&["ppppp","pppp","ppp","pp","p"].includes(t.dynamic)?a="p":0===a.length&&["fffff","ffff","fff","ff","f","sfz","sf"].includes(t.dynamic)?a="f":0===a.length&&["mf","mp","mfz"].includes(t.dynamic)&&(a="mf"),l.push([e.orchestrationChords.databaseEntries.inst[n],e.orchestrationChords.databaseEntries.tech[n],a,t.note+12+e.orchestrationChords.databaseEntries.modify[n],e.orchestrationChords.databaseEntries.tgt[n],e.orchestrationChords.databaseEntries.onoff[n],n,0])}))}})),l=l.filter((function(e,t,n){if(!e[5])return!1;try{return e[3]>=S[e[0]][e[1]][e[2]][0]&&e[3]<=S[e[0]][e[1]][e[2]][1]}catch(a){return!1}})),x.a.post("https://rest.score-tool.com/modalSlice",l).then((function(t){var n=t.data,a=o.sourceNote.parentStaffEntry.verticalContainerParent.parentMeasure.measureNumber,r=e.orchestrationChords.xpos[String(s)]-1;e.osmd.graphic.MusicPages[0];n&&(m&&u.map((function(t){var o=e.osmd.graphic.musicSheet.sourceMeasures[a-1].verticalMeasureList[t].boundingBox.absolutePosition.y+2;new h.PointF2D(r,o),new h.PointF2D(r+2,o);n[0]>=75||n[0]})),n[1]&&n[1].map((function(t,n){var o=e.osmd.graphic.musicSheet.sourceMeasures[a-1].verticalMeasureList[t].boundingBox.absolutePosition.y+2;new h.PointF2D(r,o),new h.PointF2D(r+2,o)}))),e.setState((function(e){return e.modalData=[n,l,c]}))})).finally((function(){e.setState((function(e){e.open=!0,e.time=Date.now()})),e.forceUpdate()}))}}})),r.a.createElement(ae,{handleClose:this.handleClose,open:this.state.open,time:this.state.time,data:this.state.modalData}))}}]),n}(a.Component),le=n(136),ue=(n(251),n(306)),me=n(177),de=n(48),fe=n.n(de),he=n(78),pe=n.n(he),ge=n(60),be=n.n(ge),ve=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],ye=["Db","Eb","Gb","Ab","Bb"],Ee={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11},_e=/([a-g])([#b]?)(\d+)/;var Oe=be()(12,128).reduce((function(e,t){return e[t]=function(e){var t=(e-12)%12,n=Math.floor((e-12)/12),a=ve[t];return{note:"".concat(a).concat(n),pitchName:a,octave:n,midiNumber:e,isAccidental:ye.includes(a)}}(t),e}),{});function ke(e){var t=Oe[e];if(!t)throw Error("Invalid MIDI number");return t}var Ce=be()(12,128).filter((function(e){return!ke(e).isAccidental})),xe={fromNote:function(e){if(!e)throw Error("Invalid note argument");var t=_e.exec(e.toLowerCase());if(!t)throw Error("Invalid note argument");var n=Object(g.a)(t,4),a=n[1],r=n[2],o=n[3],s="".concat(a.toUpperCase()).concat(r),c=Ee[s];if(null==c)throw Error("Invalid note argument");return 12+c+12*parseInt(o,10)},getAttributes:ke,MIN_MIDI_NUMBER:12,MAX_MIDI_NUMBER:127,NATURAL_MIDI_NUMBERS:Ce},we=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onPlayNoteInput=function(){e.props.onPlayNoteInput(e.props.midiNumber)},e.onStopNoteInput=function(){e.props.onStopNoteInput(e.props.midiNumber)},e.onLeaveNote=function(){e.props.onLeaveNote(e.props.midiNumber)},e}return Object(i.a)(n,[{key:"getAbsoluteKeyPosition",value:function(e){var t=xe.getAttributes(e),n=t.octave,a=t.pitchName;return this.props.pitchPositions[a]+7*n}},{key:"getRelativeKeyPosition",value:function(e){return this.getAbsoluteKeyPosition(e)-this.getAbsoluteKeyPosition(this.props.noteRange.first)}},{key:"render",value:function(){var e=this.props,t=e.naturalKeyWidth,n=e.accidentalWidthRatio,a=e.midiNumber,o=e.gliss,s=e.useTouchEvents,c=e.accidental,i=e.active,l=e.disabled,u=e.children;return r.a.createElement("div",{className:fe()("ReactPiano__Key",{"ReactPiano__Key--accidental":c,"ReactPiano__Key--natural":!c,"ReactPiano__Key--disabled":l,"ReactPiano__Key--active":i}),style:{left:je(this.getRelativeKeyPosition(a)*t),width:je(c?n*t:t)},onMouseDown:s?null:this.onPlayNoteInput,onMouseUp:s?null:this.onStopNoteInput,onMouseEnter:null,onMouseLeave:o?this.onStopNoteInput:null,onTouchStart:s?this.onPlayNoteInput:null,onTouchCancel:o?this.onStopNoteInput:null,onTouchMove:null,onTouchEnd:s?this.onStopNoteInput:null},r.a.createElement("div",{className:"ReactPiano__NoteLabelContainer"},u))}}]),n}(r.a.Component);function je(e){return"".concat(100*e,"%")}we.defaultProps={accidentalWidthRatio:.65,pitchPositions:{C:0,Db:.55,D:1,Eb:1.8,E:2,F:3,Gb:3.5,G:4,Ab:4.7,A:5,Bb:5.85,B:6}};var Se=we,Ne=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"getMidiNumbers",value:function(){return be()(this.props.noteRange.first,this.props.noteRange.last+1)}},{key:"getNaturalKeyCount",value:function(){return this.getMidiNumbers().filter((function(e){return!xe.getAttributes(e).isAccidental})).length}},{key:"getNaturalKeyWidth",value:function(){return 1/this.getNaturalKeyCount()}},{key:"getWidth",value:function(){return this.props.width?this.props.width:"100%"}},{key:"getHeight",value:function(){if(!this.props.width)return"100%";var e=this.props.width*this.getNaturalKeyWidth();return"".concat(e/this.props.keyWidthToHeight,"px")}},{key:"render",value:function(){var e=this,t=this.getNaturalKeyWidth();return r.a.createElement("div",{className:fe()("ReactPiano__Keyboard",this.props.className),style:{width:this.getWidth(),height:this.getHeight()}},this.getMidiNumbers().map((function(n){var a=xe.getAttributes(n),o=(a.note,a.isAccidental),s=!e.props.disabled&&e.props.activeNotes.includes(n);return r.a.createElement(Se,{naturalKeyWidth:t,midiNumber:n,noteRange:e.props.noteRange,active:s,accidental:o,disabled:e.props.disabled,onPlayNoteInput:e.props.onPlayNoteInput,onStopNoteInput:e.props.onStopNoteInput,onLeaveNote:e.props.onLeaveNote,gliss:e.props.gliss,useTouchEvents:e.props.useTouchEvents,key:n},e.props.disabled?null:e.props.renderNoteLabel({isActive:s,isAccidental:o,midiNumber:n}))})))}}]),n}(r.a.Component);Ne.defaultProps={disabled:!1,gliss:!1,useTouchEvents:!1,keyWidthToHeight:.33,renderNoteLabel:function(){}};var Te=Ne,Ie=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isMouseDown:!1,useTouchEvents:!1},e.handleNoteChanges=function(t){var n=t.prevActiveNotes,a=t.nextActiveNotes;if(!e.props.disabled){var r=pe()(n,a);pe()(a,n).forEach((function(t){e.props.playNote(t)})),r.forEach((function(t){e.props.stopNote(t)}))}},e.getMidiNumberForKey=function(t){if(!e.props.keyboardShortcuts)return null;var n=e.props.keyboardShortcuts.find((function(e){return e.key===t}));return n&&n.midiNumber},e.getKeyForMidiNumber=function(t){if(!e.props.keyboardShortcuts)return null;var n=e.props.keyboardShortcuts.find((function(e){return e.midiNumber===t}));return n&&n.key},e.onKeyDown=function(t){if(!(t.ctrlKey||t.metaKey||t.shiftKey)){var n=e.getMidiNumberForKey(t.key);n&&e.onPlayNoteInput(n)}},e.onKeyUp=function(t){var n=e.getMidiNumberForKey(t.key);n&&e.onStopNoteInput(n)},e.onPlayNoteInput=function(t){e.props.disabled||e.props.onPlayNoteInput(t,e.props.activeNotes)},e.onStopNoteInput=function(t){e.props.disabled||e.props.onStopNoteInput(t,e.props.activeNotes)},e.onLeaveNote=function(t){e.props.disabled||e.props.onLeaveNote(t,e.props.activeNotes)},e.onMouseDown=function(){e.setState({isMouseDown:!0})},e.onMouseUp=function(){e.setState({isMouseDown:!1})},e.onTouchStart=function(){e.setState({useTouchEvents:!0})},e.renderNoteLabel=function(t){var n=t.midiNumber,a=t.isActive,r=t.isAccidental,o=e.getKeyForMidiNumber(n);return e.props.renderNoteLabel({keyboardShortcut:o,midiNumber:n,isActive:a,isAccidental:r})},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}},{key:"componentDidUpdate",value:function(e,t){this.props.activeNotes!==e.activeNotes&&this.handleNoteChanges({prevActiveNotes:e.activeNotes||[],nextActiveNotes:this.props.activeNotes||[]})}},{key:"render",value:function(){return r.a.createElement("div",{style:{width:"100%",height:"100%"},onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchStart:this.onTouchStart,"data-testid":"container"},r.a.createElement(Te,{noteRange:this.props.noteRange,onPlayNoteInput:this.onPlayNoteInput,onStopNoteInput:this.onStopNoteInput,onLeaveNote:this.onLeaveNote,activeNotes:this.props.activeNotes,className:this.props.className,disabled:this.props.disabled,width:this.props.width,keyWidthToHeight:this.props.keyWidthToHeight,gliss:this.state.isMouseDown,useTouchEvents:this.state.useTouchEvents,renderNoteLabel:this.renderNoteLabel}))}}]),n}(r.a.Component);Ie.defaultProps={renderNoteLabel:function(e){var t=e.keyboardShortcut,n=(e.midiNumber,e.isActive),a=e.isAccidental;return t?r.a.createElement("div",{className:fe()("ReactPiano__NoteLabel",{"ReactPiano__NoteLabel--active":n,"ReactPiano__NoteLabel--accidental":a,"ReactPiano__NoteLabel--natural":!a})},t):null}};var Ae=Ie,Me=["activeNotes","onPlayNoteInput","onStopNoteInput"],Pe=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={activeNotes:e.props.activeNotes||[]},e.handlePlayNoteInput=function(t){e.setState((function(n){return e.props.onPlayNoteInput&&e.props.onPlayNoteInput(t,{prevActiveNotes:n.activeNotes}),n.activeNotes.includes(t)?null:{activeNotes:n.activeNotes.concat(t)}}))},e.handleStopNoteInput=function(t){e.setState((function(n){return e.props.onStopNoteInput&&e.props.onStopNoteInput(t),{activeNotes:n.activeNotes.filter((function(e){return t!==e}))}}))},e.handleLeave=function(t){e.setState((function(e){return{activeNotes:e.activeNotes.filter((function(e){return t!==e}))}}))},e}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(e){e.activeNotes!==this.props.activeNotes&&this.state.activeNotes!==this.props.activeNotes&&this.setState({activeNotes:this.props.activeNotes||[]})}},{key:"render",value:function(){var e=this.props,t=(e.activeNotes,e.onPlayNoteInput,e.onStopNoteInput,Object(me.a)(e,Me));return r.a.createElement(Ae,Object.assign({activeNotes:this.state.activeNotes,onLeaveNote:this.handleLeave,onPlayNoteInput:this.handlePlayNoteInput,onStopNoteInput:this.handleStopNoteInput},t))}}]),n}(r.a.Component),De=(n(164),n(67)),Le=R.a.Flow,ze=function(e){var t=e.note;return r.a.createElement("div",{ref:function(e){if(e){for(var n=e;n.hasChildNodes();)n.removeChild(n.lastChild);var a=new Le.Renderer(n,Le.Renderer.Backends.SVG);a.resize(100,100);var r=a.getContext();r.scale(.5,.5);var o=new De.a(20,40,150);o.setContext(r);var s=t.filter((function(e,t,n){return parseInt(e.slice(-1))<4})),c=t.filter((function(e,t,n){return parseInt(e.slice(-1))>=4})),i="treble";s.length>c.length&&(i="bass"),o.setClef(i);var l=[],u=[];if(t.map((function(e){var t=e.slice(0,1)+"/"+e.slice(-1),n=e.slice(-2,-1);/[#db+n]/.test(n)||(n="n"),l.push(t),u.push(n)})),0===t.length)o.draw();else{var m=new Le.StaveNote({clef:i,keys:l,duration:"4"});u.map((function(e,t){return m.addAccidental(t,new Le.Accidental(e))}));var d=new Le.Voice({num_beats:1,beat_value:4});d.addTickables([m]),o.draw();(new Le.Formatter).joinVoices([d]).formatToStave([d],o);d.draw(r,o)}}}})};function Re(e){var t=0;"number"===typeof e.data[7]&&(t=e.data[7]);var n=Object(a.useState)({idx:e.data[6],scoreNames:e.data[0],scoreTechs:e.data[1],scoreDyns:e.data[2],scorePitch:e.data[3],scoreTgt:e.data[4],scoreOnoff:e.data[5],scoreIdx:e.data[6],scoreMicro:t,scoreModify:0,popOpen:!1,anchorEl:null}),o=Object(g.a)(n,2),s=o[0],c=o[1],i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function l(e){var t=e-Math.floor(e),n=Math.round(e),a=i[n%12];return t>=.2&&t<.5?/[#]/.test(a)?a=i[(n+1)%12]+"d":a+="+":t>=.5&&t<=.8&&(/[#]/.test(a)?a=i[(n-1)%12]+"+":a+="d"),a+(Math.floor(n/12)-1)}var u,m,f=function(e){var t=e.currentTarget;c((function(e){return Object(d.a)(Object(d.a)({},e),{},{popOpen:!e.popOpen,anchorEl:t})}))},h=function(){c((function(e){return Object(d.a)(Object(d.a)({},e),{},{anchorEl:null,popOpen:!1})})),e.onChange([s.scoreNames,s.scoreTechs,s.scoreDyns,s.scorePitch,s.scoreTgt,s.scoreOnoff,s.scoreIdx,s.scoreMicro])},v=function(e,t){c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreMicro:t})}))},C=function(t,n){e.onChange([s.scoreNames,s.scoreTechs,s.scoreDyns,s.scorePitch,s.scoreTgt,s.scoreOnoff,s.scoreIdx,s.scoreMicro])},x=function(){return c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreMicro:0})}))};s.scorePitch.map((function(e){return l(e)}));return r.a.createElement("tr",null,r.a.createElement("td",{key:"nam"+s.idx},s.instName),r.a.createElement("td",{key:"scor"+s.idx},function(t,n){var a=Object.keys(S);return r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"instrument-select"},"Instr."),r.a.createElement(y.a,{labelId:"instrument-select",id:"instrument-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;c((function(e){return Object(d.a)(Object(d.a)({},e),{},{popOpen:!1})})),c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreNames:a,scoreTechs:"normal",scoreDyns:"mf"})})),e.onChange([a,"normal","mf",s.scorePitch,s.scoreTgt,s.scoreOnoff,s.scoreIdx,s.scoreMicro])}(0,t)},autoWidth:!0,label:"instr."},a.map((function(e){return r.a.createElement(_.a,{value:e},e)})))))}(s.scoreNames,s.idx)),r.a.createElement("td",{key:"tec"+s.idx},function(t,n){var a=Object.keys(S[s.scoreNames]);return r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"tech-select"},"Tech."),r.a.createElement(y.a,{labelId:"tech-select",id:"tech-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTechs:a})})),e.onChange([s.scoreNames,a,s.scoreDyns,s.scorePitch,s.scoreTgt,s.scoreOnoff,s.scoreIdx,s.scoreMicro])}(0,t)},autoWidth:!0,label:"tech."},a.map((function(e){return r.a.createElement(_.a,{value:e},e)})))))}(s.scoreTechs,s.idx)),r.a.createElement("td",{key:"dy"+s.idx},function(t,n){var a=Object.keys(S[s.scoreNames][s.scoreTechs]);return r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"dyn-select"},"Dyn."),r.a.createElement(y.a,{labelId:"dyn-select",id:"dyn-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreDyns:a})})),e.onChange([s.scoreNames,s.scoreTechs,a,s.scorePitch,s.scoreTgt,s.scoreOnoff,s.scoreIdx,s.scoreMicro])}(0,t)},autoWidth:!0,label:"dyn."},a.map((function(e){return r.a.createElement(_.a,{value:e},e)})))))}(s.scoreDyns,s.idx)),r.a.createElement("td",{key:"mi"+s.idx},(s.scoreMicro,s.idx,r.a.createElement($.a,{sx:{width:70}},r.a.createElement(Q.a,{spacing:0,direction:"row",sx:{mb:1},alignItems:"center"},r.a.createElement(k.a,{variant:"caption",style:{textAlign:"center"}}," tune "),r.a.createElement(P.a,{"aria-label":"zero",size:"small",onClick:x},r.a.createElement(k.a,{variant:"caption",style:{textAlign:"center"}}," (reset) "))),r.a.createElement(Q.a,{spacing:1,direction:"row",sx:{mb:1},alignItems:"center"},r.a.createElement("img",{src:"/flat.png",height:"20"}),r.a.createElement(b.a,{valueLabelDisplay:"auto","aria-label":"tune",size:"small",min:-.49,step:.01,max:.49,value:s.scoreMicro,onChangeCommitted:C,onChange:v}),r.a.createElement("img",{src:"/sharp.png",height:"20"}))))),r.a.createElement("td",{key:"pi"+s.idx},function(e,t){var n=[S[s.scoreNames][s.scoreTechs][s.scoreDyns][0],S[s.scoreNames][s.scoreTechs][s.scoreDyns][S[s.scoreNames][s.scoreTechs][s.scoreDyns].length-1]];return r.a.createElement("div",null,r.a.createElement("div",{"aria-describedby":t,onClick:f},r.a.createElement(ze,{note:s.scorePitch.sort().map((function(e){return l(e+s.scoreMicro)}))})),r.a.createElement(ue.a,{id:t,open:s.popOpen,anchorEl:s.anchorEl,onClose:h,style:{zIndex:1e4},anchorOrigin:{vertical:"bottom",horizontal:"left"},sx:{marginTop:3},transformOrigin:{vertical:"bottom",horizontal:"right"}},r.a.createElement($.a,{sx:{border:1,p:1,bgcolor:"white"}},r.a.createElement(Pe,{noteRange:{first:n[0],last:n[1]},activeNotes:s.scorePitch,playNote:function(e){},stopNote:function(e){var t=Object(N.a)(s.scorePitch);if(t.includes(e)){var n=t.filter((function(t,n,a){return t!=e}));c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scorePitch:n})}))}else t.push(e),c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scorePitch:t})}))},width:400}))))}(s.scorePitch,"pi"+s.idx)),r.a.createElement("td",null," ",r.a.createElement(p.a,{variant:"outlined",color:"warning",onClick:function(){c((function(e){return Object(d.a)(Object(d.a)({},e),{},{popOpen:!1})})),c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scorePitch:[]})})),c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreMicro:0})})),e.onChange([s.scoreNames,s.scoreTechs,s.scoreDyns,[],s.scoreTgt,s.scoreOnoff,s.scoreIdx,0])},size:"small"}," clear notes ")),r.a.createElement("td",{key:"tg"+s.idx},r.a.createElement("div",{style:{border:"1px solid lightGray",borderRadius:5,padding:8}},r.a.createElement(Q.a,{direction:"row",spacing:1,alignItems:"center"},r.a.createElement(k.a,null,"orch."),r.a.createElement(re.a,{key:"tgtswitch"+s.idx,checked:s.scoreTgt,color:"secondary",onChange:function(t){return function(t,n){var a=n.target.checked;c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTgt:a})})),e.onChange([s.scoreNames,s.scoreTechs,s.scoreDyns,s.scorePitch,a,s.scoreOnoff,s.scoreIdx,s.scoreMicro])}(s.idx,t)}}),r.a.createElement(k.a,null,"tgt")))),r.a.createElement("td",{key:"onoff"+s.idx},r.a.createElement("div",{style:{border:"1px solid lightGray",borderRadius:5,padding:8}},r.a.createElement(Q.a,{direction:"row",spacing:1,alignItems:"center"},r.a.createElement(k.a,null,"off"),r.a.createElement(re.a,{key:"onoffswitch"+s.idx,checked:s.scoreOnoff,onChange:function(t){return function(t,n){var a=n.target.checked;c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreOnoff:a})})),e.onChange([s.scoreNames,s.scoreTechs,s.scoreDyns,s.scorePitch,s.scoreTgt,a,s.scoreIdx,s.scoreMicro])}(s.idx,t)}}),r.a.createElement(k.a,null,"on")))),r.a.createElement("td",{key:"mod"+s.idx},(u=s.scoreModify,m=s.idx,r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"mod-select"},"Transpose"),r.a.createElement(y.a,{labelId:"mod-select",id:"mod-sel"+m,value:u,onChange:function(t){return function(t,n){var a=n.target.value,r=s.scorePitch.map((function(e){return e+a>=S[s.scoreNames][s.scoreTechs][s.scoreDyns][0]&&e+a<=S[s.scoreNames][s.scoreTechs][s.scoreDyns][1]?e+a:null}));r=r.filter((function(e,t,n){return null!=e})),console.log(r),c((function(e){return Object(d.a)(Object(d.a)({},e),{},{scorePitch:r,scoreModify:0})})),e.onChange([s.scoreNames,s.scoreTechs,s.scoreDyns,r,s.scoreTgt,s.scoreOnoff,s.scoreIdx,s.scoreMicro])}(0,t)},autoWidth:!0,label:"trans."},[0,12,-12,24,-24].map((function(e){return r.a.createElement(_.a,{value:e},e)}))))))),r.a.createElement("td",null," ",r.a.createElement(p.a,{variant:"outlined",color:"warning",onClick:function(t){return e.onDelete(s.scoreIdx)},size:"small"}," delete ")))}var Fe=n(143),We=n(310),Ve=Object(Fe.a)({palette:{neutral:{main:"#dcc4ac",contrastText:"#black"}}});function Ge(e){var t=Object(a.useState)({instList:[],listenList:[],data:[],selected:null,saved:!1,audibilityPercent:0,textFieldValue:"Chord Editor orchestration "+JSON.parse(localStorage.getItem("orchestrations")).length}),n=Object(g.a)(t,2),r=n[0],o=n[1];a.useEffect((function(){if(null!=sessionStorage.getItem("LastChord")){var e=JSON.parse(sessionStorage.getItem("LastChord"));o((function(t){return Object(d.a)(Object(d.a)({},t),{},{instList:e})})),s(e)}}),[]);var s=function(e){var t=[],n=[],a=0;e.map((function(e,r){e[3].map((function(r){var o=0;"number"===typeof e[7]&&(o=e[7]),e[5]&&(t.push([e[0],e[1],e[2],r,e[4],e[5],a,o]),n.push([e[0],e[1],e[2],r+o,e[4],e[5],a])),a+=1}))})),x.a.post("https://rest.score-tool.com/modalSlice",t).then((function(e){var t=e.data;o((function(e){return Object(d.a)(Object(d.a)({},e),{},{data:t.data,listenList:n,audibilityPercent:100-t.data[2].masking_percent})}))}))},c=function(e){e.persist();var t=e.target.textContent.toLowerCase(),n=Object(N.a)(r.instList),a="normal";"percussion_misc"===t&&(a="castanet");var s=[];S[t][a].mf[0]===S[t][a].mf[1]&&(s=[S[t][a].mf[0]]),0===n.length?n.push([t,a,"mf",s,!1,!0,0]):n.push([t,a,"mf",s,!1,!0,n[n.length-1][6]+1]),console.log(n),o((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n})}))},i=function(e){console.log(r.instList);var t=r.instList.filter((function(t,n,a){return t[6]!=e}));console.log(t),o((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:t})})),s(t)};return a.createElement(a.Fragment,null,a.createElement(We.a,{theme:Ve},a.createElement(p.a,{variant:"contained",color:"warning",onClick:function(){o((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:[],listenList:[],data:[],selected:null,saved:!1})}))}}," Clear all instruments "),a.createElement(k.a,{style:{textAlign:"center"}}," Select orchestration from your saved orchestrations  "),a.createElement(O.a,{sx:{m:1,minWidth:50}},a.createElement(E.a,{id:"orchestration-select"},"Orchestrations"),a.createElement(y.a,{labelId:"orchestration-select",id:"orchestration-select1",value:r.selected,onChange:function(e){var t=e.target.value,n=JSON.parse(localStorage.getItem("orchestrations")).filter((function(e,n,a){return e.id===t}))[0].data.map((function(e,t){return[e[0],e[1],e[2],e[3],e[4],e[5],t]}));o((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n,selected:t})})),s(n)},autoWidth:!0,label:"orch."},null===localStorage.getItem("orchestrations")?null:JSON.parse(localStorage.getItem("orchestrations")).map((function(e){return a.createElement(_.a,{value:e.id},e.name)})))),a.createElement(k.a,{style:{textAlign:"center"}}," or/and  "),a.createElement(k.a,{style:{textAlign:"center"}}," Click below to add instrument to orchestration  "),a.createElement("table",null,a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,"Woodwinds"),a.createElement("td",null,"Brass"),a.createElement("td",null,"Strings"),a.createElement("td",null,"Percussion"),a.createElement("td",null,"Various")),a.createElement("tr",null,a.createElement("td",null,["piccolo","flute","alto_flute","bass_flute","oboe","english_horn","clarinet","clarinet_eb","bass_cl","bassoon"].map((function(e){return a.createElement(p.a,{variant:"contained",onClick:c,color:"neutral",size:"small"},e)}))),a.createElement("td",null,["trumpet","horn","tenor_trombone","bass_trombone","soprano_sax","alto_sax"].map((function(e){return a.createElement(p.a,{variant:"contained",onClick:c,color:"neutral",size:"small"},e)}))),a.createElement("td",null,["violin","viola","cello","double_bass","solo_violin","solo_viola","solo_cello","solo_double_bass"].map((function(e){return a.createElement(p.a,{variant:"contained",onClick:c,color:"neutral",size:"small"},e)}))),a.createElement("td",null,["crotale","cymbal","percussion_misc","tambourine","tamtam","tamtam_22","tamtam_40","thaigong","triangle_6","triangle_8","vibraphone","woodblock","xylophone","timp"].map((function(e){return a.createElement(p.a,{variant:"contained",onClick:c,color:"neutral",size:"small"},e)}))),a.createElement("td",null,["piano","harp","guitar","soprano_generic","tenor_generic","baritone_generic"].map((function(e){return a.createElement(p.a,{variant:"contained",onClick:c,color:"neutral",size:"small"},e)}))))))),a.createElement("div",{style:{zoom:1}},a.createElement("table",null,r.instList.map((function(e,t){return a.createElement(Re,{key:e,data:e,onChange:function(e){return function(e,t){var n=Object(N.a)(r.instList);n[e]=t,o((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n,saved:!1})})),sessionStorage.setItem("LastChord",JSON.stringify(n)),s(n)}(t,e)},onDelete:i,idx:"fgfg"+t})})))),a.createElement("br",null),a.createElement("div",{style:{margin:"auto",textAlign:"center"}},a.createElement(k.a,{variant:"caption",component:"div",color:"text.secondary"},"Target audibility:"),a.createElement($.a,{sx:{position:"relative",display:"inline-flex"}},a.createElement(ee.a,{variant:"determinate",value:r.audibilityPercent,color:r.audibilityPercent<=30?"error":r.audibilityPercent<=50?"warning":"success"}),a.createElement($.a,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"}},a.createElement(k.a,{variant:"caption",component:"div",color:"text.secondary"},"".concat(Math.round(r.audibilityPercent),"%"))))),a.createElement("br",null),a.createElement(We.a,{theme:Ve},a.createElement(p.a,{variant:"contained",color:"neutral",onClick:function(){return s(r.instList)},style:{display:"none"}}," Click to update graphs "),a.createElement(Y,{text:r.textFieldValue,orchestration:r.instList})),a.createElement("div",{style:{textAlign:"center",margin:"auto"}},a.createElement(te,{instrumentList:r.listenList})),a.createElement(J,{data:r.data}),a.createElement(X,{instrumentList:r.listenList}))}var Ke=a.forwardRef((function(e,t){return a.createElement(D.a,Object.assign({direction:"up",ref:t},e))}));function Be(e){var t=a.useState(!1),n=Object(g.a)(t,2),r=n[0],o=n[1];return a.useEffect((function(){o((function(t){return e.open}))}),[e]),a.createElement("div",null,a.createElement(T.a,{fullScreen:!0,open:r,onClose:e.handleClose,TransitionComponent:Ke,PaperProps:{style:{backgroundColor:"#fffef0"}}},a.createElement(A.a,{sx:{position:"relative",backgroundColor:"#dcc4ac",color:"#4c4c48"}},a.createElement(M.a,null,a.createElement(P.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},a.createElement("div",null,"Click here, or press ESC to close Chord Editor")))),a.createElement(Ge,null)))}function Ue(e){var t=Object(a.useState)({idx:e.data[6],scoreNames:e.data[0],scoreTechs:e.data[1],scoreDyns:e.data[2],scorePitch:e.data[3],scoreTgt:e.data[4],scoreOnoff:e.data[5],scoreIdx:e.data[6],scoreModify:0,popOpen:!1,anchorEl:null}),n=Object(g.a)(t,2),o=n[0],s=n[1],c=["C","C#","D","D#","E","F","F#","G","G#","A","Bb","B"];var i,l,u=function(e){var t=e.currentTarget;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{popOpen:!e.popOpen,anchorEl:t})}))},m=function(){s((function(e){return Object(d.a)(Object(d.a)({},e),{},{anchorEl:null,popOpen:!1})})),e.onChange([o.scoreNames,o.scoreTechs,o.scoreDyns,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])};return r.a.createElement("tr",null,r.a.createElement("td",{key:"nam"+o.idx},o.instName),r.a.createElement("td",{key:"scor"+o.idx},function(t,n){var a=Object.keys(S);return r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"instrument-select"},"Instr."),r.a.createElement(y.a,{labelId:"instrument-select",id:"instrument-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{popOpen:!1})})),s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreNames:a,scoreTechs:"normal",scoreDyns:"mf"})})),e.onChange([a,"normal","mf",o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])}(0,t)},autoWidth:!0,label:"instr."},a.map((function(e){return r.a.createElement(_.a,{value:e},e)})))))}(o.scoreNames,o.idx)),r.a.createElement("td",{key:"tec"+o.idx},function(t,n){var a=Object.keys(S[o.scoreNames]);return r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"tech-select"},"Tech."),r.a.createElement(y.a,{labelId:"tech-select",id:"tech-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTechs:a})})),e.onChange([o.scoreNames,a,o.scoreDyns,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])}(0,t)},autoWidth:!0,label:"tech."},a.map((function(e){return r.a.createElement(_.a,{value:e},e)})))))}(o.scoreTechs,o.idx)),r.a.createElement("td",{key:"dy"+o.idx},function(t,n){var a=Object.keys(S[o.scoreNames][o.scoreTechs]);return r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"dyn-select"},"Dyn."),r.a.createElement(y.a,{labelId:"dyn-select",id:"dyn-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreDyns:a})})),e.onChange([o.scoreNames,o.scoreTechs,a,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])}(0,t)},autoWidth:!0,label:"dyn."},a.map((function(e){return r.a.createElement(_.a,{value:e},e)})))))}(o.scoreDyns,o.idx)),r.a.createElement("td",{key:"pi"+o.idx},function(e,t){var n,a=[S[o.scoreNames][o.scoreTechs][o.scoreDyns][0],S[o.scoreNames][o.scoreTechs][o.scoreDyns][S[o.scoreNames][o.scoreTechs][o.scoreDyns].length-1]];return r.a.createElement("div",null,r.a.createElement("div",{"aria-describedby":t,onClick:u},r.a.createElement(ze,{note:[(n=o.scorePitch,c[n%12]+(Math.floor(n/12)-1))]})),r.a.createElement(ue.a,{id:t,open:o.popOpen,anchorEl:o.anchorEl,onClose:m,style:{zIndex:1e4},anchorOrigin:{vertical:"bottom",horizontal:"left"},sx:{marginTop:3},transformOrigin:{vertical:"bottom",horizontal:"right"}},r.a.createElement($.a,{sx:{border:1,p:1,bgcolor:"white"}},r.a.createElement(le.a,{noteRange:{first:a[0],last:a[1]},activeNotes:[o.scorePitch],playNote:function(e){},onPlayNoteInput:function(e){s((function(t){return Object(d.a)(Object(d.a)({},t),{},{scorePitch:e})}))},stopNote:function(e){return null},width:400}))))}(o.scorePitch,"pi"+o.idx)),r.a.createElement("td",{key:"mod"+o.idx},(i=o.scoreModify,l=o.idx,r.a.createElement("div",null,r.a.createElement(O.a,{sx:{m:1,minWidth:50}},r.a.createElement(E.a,{id:"mod-select"},"Transpose"),r.a.createElement(y.a,{labelId:"mod-select",id:"mod-sel"+l,value:i,onChange:function(e){return function(e,t){var n=t.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scorePitch:e.scorePitch+n,scoreModify:0})}))}(0,e)},autoWidth:!0,label:"trans."},[0,12,-12,24,-24].map((function(e){return r.a.createElement(_.a,{value:e},e)}))))))))}var He=Object(B.a)(U.a)((function(e){var t=e.theme;return Object(d.a)(Object(d.a)({},t.typography.body2),{},{backgroundColor:"#fffef0",padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})}));function Je(e){var t=e.data;return t.length<2?null:a.createElement("div",null,a.createElement(K.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:.5},a.createElement(K.a,{item:!0,xs:6,md:6},a.createElement(He,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(k.a,null,"Overtone structure of ",t[3].instruments[0]),a.createElement(W,{notes:t[1].notes,instruments:t[1].instruments,target:t[1].target,target_color:"red",width:200,text_space:200}))),a.createElement(K.a,{item:!0,xs:6,md:6},a.createElement(He,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(k.a,null,"Overtone structure of ",t[3].instruments[1]),a.createElement(W,{notes:t[2].notes,instruments:t[2].instruments,target:t[2].target,target_color:"red",width:200,text_space:200}))),a.createElement(K.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:.5},a.createElement(K.a,{item:!0,xs:6,md:6},a.createElement(He,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(k.a,null,"Spectral centroids"),a.createElement(W,{notes:t[3].notes,instruments:t[3].instruments,target:[],width:150,text_space:200}))),a.createElement(K.a,{item:!0,xs:6,md:6},a.createElement(He,null,a.createElement(z.a,{data:t[0][1].data,layout:Object(d.a)(Object(d.a)({},t[0][1].layout),{},{width:window.innerWidth/2-50}),config:{displayModeBar:!1},width:200}))))),a.createElement(K.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"left",alignItems:"left",spacing:.5},a.createElement(K.a,{item:!0,xs:12,md:12},a.createElement(He,null,a.createElement(z.a,{data:t[0][0].data,layout:Object(d.a)(Object(d.a)({},t[0][0].layout),{},{width:window.innerWidth-50}),config:{displayModeBar:!1}})))))}Object(B.a)(U.a)((function(e){var t=e.theme;return Object(d.a)(Object(d.a)({},t.typography.body2),{},{backgroundColor:"#fffef0",padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})}));var qe=Object(Fe.a)({palette:{neutral:{main:"#dcc4ac",contrastText:"#black"}}}),Xe=a.forwardRef((function(e,t){return a.createElement(D.a,Object.assign({direction:"up",ref:t},e))}));function Ye(e){var t=a.useState(!1),n=Object(g.a)(t,2),r=n[0],o=n[1],s=a.useState([["flute","normal","mf",60,0,1,0],["flute","normal","mf",60,0,1,1]]),c=Object(g.a)(s,2),i=c[0],l=c[1],u=a.useState([]),m=Object(g.a)(u,2),d=m[0],f=m[1];a.useEffect((function(){o((function(t){return e.open}))}),[e]),a.useEffect((function(){if(null!=sessionStorage.getItem("LastCompare")){var e=JSON.parse(sessionStorage.getItem("LastCompare"));l((function(){return e})),b(e)}}),[]);var h=function(e){var t=Object(N.a)(i);t[e[6]]=e,l((function(){return t})),sessionStorage.setItem("LastCompare",JSON.stringify(t)),b(t)},b=function(e){var t=[];e.map((function(e){t.push([e[0],e[1],e[2],e[3]])})),x.a.post("https://rest.score-tool.com/compare",t).then((function(e){var t=e.data;f((function(){return t}))}))};return a.createElement("div",null,a.createElement(T.a,{fullScreen:!0,open:r,onClose:e.handleClose,TransitionComponent:Xe,PaperProps:{style:{backgroundColor:"#fffef0"}}},a.createElement(A.a,{sx:{position:"relative",backgroundColor:"#dcc4ac",color:"#4c4c48"}},a.createElement(M.a,null,a.createElement(P.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},a.createElement("div",null,"Click here, or press ESC to close Compare Editor")))),a.createElement(k.a,{style:{textAlign:"center"}},"Compare two instrument timbres. Select instruments to compare below."),a.createElement("table",{style:{marginInline:"20vw"}},a.createElement("tbody",null,a.createElement(Ue,{data:i[0],onChange:h}),a.createElement(Ue,{data:i[1],onChange:h}))),a.createElement(We.a,{theme:qe},a.createElement(p.a,{variant:"contained",color:"neutral",onClick:function(){return b(i)},style:{display:"none"}}," Click to compare")),a.createElement(Je,{data:d})))}var Qe=n(294),$e=n(322),Ze=n(301),et=a.forwardRef((function(e,t){return a.createElement(D.a,Object.assign({direction:"up",ref:t},e))}));function tt(e){var t=["piccolo","flute","alto_flute","bass_flute","oboe","english_horn","clarinet","clarinet_eb","bass_cl","bassoon"],n=["trumpet","horn","tenor_trombone","bass_trombone","soprano_sax","alto_sax"],r=["crotale","cymbal","percussion_misc","tambourine","tamtam","tamtam_22","tamtam_40","thaigong","triangle_6","triangle_8","vibraphone","woodblock","xylophone","timp"],o=["piano","harp","guitar","soprano_generic","tenor_generic","baritone_generic"],s=["violin","viola","cello","double_bass","solo_violin","solo_viola","solo_cello","solo_double_bass"],c=["p","mf","f"],i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],l=[1,2,3,4,5,6,7,8];function u(e){var t=e-Math.floor(e),n=Math.round(e),a=i[n%12];return t>=.2&&t<.5?/[#]/.test(a)?a=i[(n+1)%12]+"d":a+="+":t>=.5&&t<=.8&&(/[#]/.test(a)?a=i[(n-1)%12]+"+":a+="d"),a+(Math.floor(n/12)-1)}var m=a.useState(!1),f=Object(g.a)(m,2),h=f[0],b=f[1],v=a.useState({selected:null,instList:[],searchInstruments:t.concat(n).concat(s),searchTechs:["normal"],availableTechs:[],searchPitch:i,searchOct:l,searchDyn:c,searchMethod:["peaks"],searchPeaks:3,toggle:[!0,!0,!0,!1,!1,!1],result:null}),C=Object(g.a)(v,2),w=C[0],j=C[1];a.useEffect((function(){b((function(t){return e.open}))}),[e]),a.useEffect((function(){var e=[];w.searchInstruments.map((function(t){Object.keys(S[t]).map((function(t){e.includes(t)||e.push(t)}))})),j((function(t){return Object(d.a)(Object(d.a)({},t),{},{availableTechs:e})}))}),[w.searchInstruments]);var I=function(e,t,n){if(n.target.checked){var a=Object(N.a)(w.searchInstruments);a.push(t),j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:a})}))}else{var r=w.searchInstruments.filter((function(e,n,a){return e!==t}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:r})}))}},D=function(e,a){var c=Object(N.a)(w.toggle);if(c[e]=!c[e],j((function(e){return Object(d.a)(Object(d.a)({},e),{},{toggle:c})})),0===e)if(c[e]){var i=w.searchInstruments.concat(t);j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:i})}))}else{var l=w.searchInstruments.filter((function(e,n,a){return!t.includes(e)}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:l})}))}if(1===e)if(c[e]){var u=w.searchInstruments.concat(n);j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:u})}))}else{var m=w.searchInstruments.filter((function(e,t,a){return!n.includes(e)}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:m})}))}if(2===e)if(c[e]){var f=w.searchInstruments.concat(s);j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:f})}))}else{var h=w.searchInstruments.filter((function(e,t,n){return!s.includes(e)}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:h})}))}if(3===e)if(c[e]){var p=w.searchInstruments.concat(r);j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:p})}))}else{var g=w.searchInstruments.filter((function(e,t,n){return!r.includes(e)}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:g})}))}if(4===e)if(c[e]){var b=w.searchInstruments.concat(o);j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:b})}))}else{var v=w.searchInstruments.filter((function(e,t,n){return!o.includes(e)}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:v})}))}if(5===e)if(c[e]){var y=w.searchTechs.concat(w.availableTechs);j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchTechs:y})}))}else j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchTechs:["normal"]})}))};return a.createElement("div",null,a.createElement(T.a,{fullScreen:!0,open:h,onClose:e.handleClose,TransitionComponent:et,PaperProps:{style:{backgroundColor:"#fffef0"}}},a.createElement(A.a,{sx:{position:"relative",backgroundColor:"#dcc4ac",color:"#4c4c48"}},a.createElement(M.a,null,a.createElement(P.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},a.createElement("div",null,"Click here, or press ESC to close Search Panel")))),a.createElement(k.a,{style:{textAlign:"center"}}," Select search source from your saved orchestrations  "),a.createElement(O.a,{sx:{m:1,minWidth:50}},a.createElement(E.a,{id:"orchestration-select"},"Orchestrations"),a.createElement(y.a,{labelId:"orchestration-select",id:"orchestration-select1",value:w.selected,onChange:function(e){var t=e.target.value,n=JSON.parse(localStorage.getItem("orchestrations")).filter((function(e,n,a){return e.id===t}))[0].data.map((function(e,t){return[e[0],e[1],e[2],e[3],e[4],e[5],t,e[7]]}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n,selected:t})}))},autoWidth:!0,label:"orch."},null===localStorage.getItem("orchestrations")?null:JSON.parse(localStorage.getItem("orchestrations")).map((function(e){return a.createElement(_.a,{value:e.id},e.name)})))),a.createElement(k.a,{variant:"h5",style:{textAlign:"center",margin:"auto"}},"Search source"),function(e){if(e.length>0){var t=[],n=0;e.map((function(e,a){e[3].map((function(a){var r=0;"number"===typeof e[7]&&(r=e[7]),t.push([e[0],e[1],e[2],a,e[4],e[5],n,r]),n+=1}))})),t.sort((function(e,t){return e[3]-t[3]}));var r=t.map((function(e){return u(e[3]+e[7])})),o=t.map((function(e){return e[0]}));return a.createElement("div",{style:{textAlign:"center",margin:"auto"}},a.createElement(W,{notes:r,instruments:o,target:[],scale:.8,width:200,height:250,t_score_y:110,b_score_y:170,text_space:100}))}}(w.instList),a.createElement(k.a,{variant:"h5",style:{textAlign:"center",margin:"auto"}},"Search space"),a.createElement("table",null,a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,a.createElement(k.a,null,"Woodwinds"),a.createElement($e.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ze.a,{checked:w.toggle[0],size:"small",color:"success",onChange:function(e){return D(0)}})})),a.createElement("td",null,a.createElement(k.a,null,"Brass"),a.createElement($e.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ze.a,{checked:w.toggle[1],size:"small",color:"success",onChange:function(e){return D(1)}})})),a.createElement("td",null,a.createElement(k.a,null,"Strings"),a.createElement($e.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ze.a,{checked:w.toggle[2],color:"success",size:"small",onChange:function(e){return D(2)}})})),a.createElement("td",null,a.createElement(k.a,null,"Percussion"),a.createElement($e.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ze.a,{checked:w.toggle[3],color:"success",size:"small",onChange:function(e){return D(3)}})})),a.createElement("td",null,a.createElement(k.a,null,"Other"),a.createElement($e.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ze.a,{checked:w.toggle[4],color:"success",size:"small",onChange:function(e){return D(4)}})}))),a.createElement("tr",null,a.createElement("td",null,a.createElement(Qe.a,{sx:{display:"inline"}},t.map((function(e,t){return a.createElement($e.a,{label:e,control:a.createElement(Ze.a,{checked:w.searchInstruments.includes(e),size:"small",onChange:function(t){return I(0,e,t)}})})})))),a.createElement("td",null,a.createElement(Qe.a,{sx:{display:"inline"}},n.map((function(e,t){return a.createElement($e.a,{label:e,control:a.createElement(Ze.a,{checked:w.searchInstruments.includes(e),size:"small",onChange:function(t){return I(0,e,t)}})})})))),a.createElement("td",null,a.createElement(Qe.a,{sx:{display:"inline"}},s.map((function(e,t){return a.createElement($e.a,{label:e,control:a.createElement(Ze.a,{checked:w.searchInstruments.includes(e),size:"small",onChange:function(t){return I(0,e,t)}})})})))),a.createElement("td",null,a.createElement(Qe.a,{sx:{display:"inline"}},r.map((function(e,t){return a.createElement($e.a,{label:e,control:a.createElement(Ze.a,{checked:w.searchInstruments.includes(e),size:"small",onChange:function(t){return I(0,e,t)}})})})))),a.createElement("td",null,a.createElement(Qe.a,{sx:{display:"inline"}},o.map((function(e,t){return a.createElement($e.a,{label:e,control:a.createElement(Ze.a,{checked:w.searchInstruments.includes(e),onChange:function(t){return I(0,e,t)}})})}))))))),a.createElement(k.a,null,"Techniques"),a.createElement($e.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ze.a,{checked:w.toggle[5],color:"success",size:"small",onChange:function(e){return D(5)}})}),a.createElement(Qe.a,{sx:{display:"inline"}},w.availableTechs.map((function(e,t){return a.createElement($e.a,{label:e,control:a.createElement(Ze.a,{checked:w.searchTechs.includes(e),size:"small",onChange:function(t){return function(e,t,n){if(n.target.checked){var a=Object(N.a)(w.searchTechs);a.push(t),j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchTechs:a})}))}else{var r=w.searchTechs.filter((function(e,n,a){return e!==t}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchTechs:r})}))}}(0,e,t)}})})}))),a.createElement(k.a,null,"Dynamics"),a.createElement(Qe.a,{sx:{display:"inline"}},c.map((function(e,t){return a.createElement($e.a,{label:e,control:a.createElement(Ze.a,{checked:w.searchDyn.includes(e),size:"small",onChange:function(t){return function(e,t,n){if(n.target.checked){var a=Object(N.a)(w.searchDyn);a.push(t),j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchDyn:a})}))}else{var r=w.searchDyn.filter((function(e,n,a){return e!==t}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchDyn:r})}))}}(0,e,t)}})})}))),a.createElement(k.a,null,"Pitch classes"),a.createElement(Qe.a,{sx:{display:"inline"}},i.map((function(e,t){return a.createElement($e.a,{label:e,control:a.createElement(Ze.a,{checked:w.searchPitch.includes(e),size:"small",onChange:function(t){return function(e,t,n){if(n.target.checked){var a=Object(N.a)(w.searchPitch);a.push(t),j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchPitch:a})}))}else{var r=w.searchPitch.filter((function(e,n,a){return e!==t}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchPitch:r})}))}}(0,e,t)}})})}))),a.createElement(k.a,null,"Octaves"),a.createElement(Qe.a,{sx:{display:"inline"}},l.map((function(e,t){return a.createElement($e.a,{label:e,control:a.createElement(Ze.a,{checked:w.searchOct.includes(e),size:"small",onChange:function(t){return function(e,t,n){if(n.target.checked){var a=Object(N.a)(w.searchOct);a.push(t),j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchOct:a})}))}else{var r=w.searchOct.filter((function(e,n,a){return e!==t}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchOct:r})}))}}(0,e,t)}})})}))),a.createElement(k.a,null,"Search method"),a.createElement(Qe.a,{sx:{display:"inline"}},["mfcc","centroid","masking_curve","peaks"].map((function(e,t){return a.createElement($e.a,{label:e,control:a.createElement(Ze.a,{checked:w.searchMethod.includes(e),size:"small",onChange:function(t){return function(e,t,n){if(n.target.checked){var a=Object(N.a)(w.searchMethod);a.push(t),j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchMethod:a})}))}else{var r=w.searchMethod.filter((function(e,n,a){return e!==t}));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchMethod:r})}))}}(0,e,t)}})})})),a.createElement(O.a,{fullWidth:!0},a.createElement(E.a,{id:"overlapping"},"Overlappin partials for peaks"),a.createElement(y.a,{labelId:"overlapping",id:"overlapping-select",value:w.searchPeaks,label:"Overlappin partials for peaks",onChange:function(e){var t=e.target.value;j((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchPeaks:t})}))}},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15].map((function(e){return a.createElement(_.a,{value:e},e)}))))),a.createElement(p.a,{onClick:function(){j((function(e){return Object(d.a)(Object(d.a)({},e),{},{result:""})}));var e=[];w.instList.map((function(t,n){t[3].map((function(n){e.push(t[0]+","+t[1]+","+t[2]+","+Math.round(n))}))}));var t=[e,w.searchMethod,w.searchInstruments,w.searchTechs,w.searchDyn,w.searchPitch,w.searchOct,w.searchPeaks];x.a.post("https://rest.score-tool.com/search",t).then((function(e){var t=e.data,n=a.createElement("div",{id:t[0]},a.createElement(k.a,{style:{textAlign:"center",margin:"auto"}}," Search result: ",t[0][0]," ",t[0][1]," ",t[0][2]," ",u(t[0][3])),a.createElement("div",{style:{textAlign:"center",margin:"auto"}},a.createElement(W,{notes:[u(t[0][3])],instruments:[t[0][0]],target:[],scale:.8,width:200,height:250,t_score_y:50,b_score_y:140,text_space:100})),a.createElement(k.a,{style:{textAlign:"center",margin:"auto"}}," Play search result, ",t[0][0],": "),a.createElement("div",null,a.createElement("audio",{controls:!0,id:"yks"+t[0]}," ",a.createElement("source",{src:t[1],autoPlay:"true",type:"audio/x-wav"})," ")),a.createElement(k.a,{style:{textAlign:"center",margin:"auto"}}," Play search source: "),a.createElement("div",null,a.createElement("audio",{controls:!0,id:"kaks"+t[0]}," ",a.createElement("source",{src:t[2],type:"audio/x-wav"})," ")),a.createElement(k.a,{style:{textAlign:"center",margin:"auto"}}," Play both together: "),a.createElement("div",null,a.createElement("audio",{controls:!0,id:"kol"+t[0]},"  ",a.createElement("source",{src:t[3],type:"audio/x-wav"})," ")),a.createElement(p.a,{onClick:function(e){return function(e,t){var n=Object(N.a)(w.instList);n.push([e[0],e[1],e[2],[e[3]],0,1,n[n.length-1][6]+1],0),j((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n})}))}(t[0])},variant:"contained",color:"secondary",style:{padding:10,margin:5}}," Add search result to search source "),a.createElement(p.a,{onClick:function(e){return function(e,t){var n=Object(N.a)(w.instList);n.push([e[0],e[1],e[2],[e[3]],0,1,n[n.length-1][6]+1],0),j((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n})}));var a=JSON.parse(localStorage.getItem("orchestrations"));a[w.selected].data=n,localStorage.setItem("orchestrations",JSON.stringify(a))}(t[0])},variant:"contained",color:"secondary",style:{padding:10,margin:5}}," Update your saved orchestration with search result "));j((function(e){return Object(d.a)(Object(d.a)({},e),{},{result:n})}))}))},variant:"contained",color:"primary",style:{padding:10,margin:5}}," SEARCH "),a.createElement("br",null),w.result))}var nt=a.forwardRef((function(e,t){return a.createElement(D.a,Object.assign({direction:"up",ref:t},e))}));function at(e){var t=["C","C#","D","D#","E","F","F#","G","G#","A","B#","B"];var n=a.useState(!1),r=Object(g.a)(n,2),o=r[0],s=r[1],c=a.useState([]),i=Object(g.a)(c,2),l=i[0],u=i[1],m=a.useState([]),d=Object(g.a)(m,2),h=d[0],b=d[1];a.useEffect((function(){s((function(t){return e.open}));var t=[];t.length=JSON.parse(localStorage.getItem("orchestrations")).length,b((function(){return t}))}),[e]),a.useEffect((function(){u((function(){return JSON.parse(localStorage.getItem("orchestrations"))}));var e=[];e.length=JSON.parse(localStorage.getItem("orchestrations")).length,b((function(){return e}))}),[]),a.useEffect((function(){u((function(){return JSON.parse(localStorage.getItem("orchestrations"))}));var e=[];e.length=JSON.parse(localStorage.getItem("orchestrations")).length,b((function(){return e}))}),[localStorage.getItem("orchestrations")]);var v=function(e){if(e.length>0){var n=[],r=0;e.map((function(e,t){e[3].map((function(t){var a=0;"number"===typeof e[7]&&(a=e[7]),n.push([e[0],e[1],e[2],t+a,e[4],e[5],r]),r+=1}))})),n.sort((function(e,t){return e[3]-t[3]}));var o=n.map((function(e){return function(e){var n=e-Math.floor(e),a=Math.round(e),r=t[a%12];return n>=.2&&n<.5?/[#]/.test(r)?r=t[(a+1)%12]+"d":r+="+":n>=.5&&n<=.8&&(/[#]/.test(r)?r=t[(a-1)%12]+"+":r+="d"),r+(Math.floor(a/12)-1)}(e[3])})),s=n.map((function(e){return e[0]}));return a.createElement("div",{style:{textAlign:"center",margin:"auto"}},a.createElement(W,{notes:o,instruments:s,target:[],scale:.3,width:150,height:90,t_score_y:110,b_score_y:170,text_space:30}))}};return a.createElement("div",null,a.createElement(T.a,{fullScreen:!0,open:o,onClose:e.handleClose,TransitionComponent:nt,PaperProps:{style:{backgroundColor:"#fffef0"}}},a.createElement(A.a,{sx:{position:"relative",backgroundColor:"#dcc4ac",color:"#4c4c48"}},a.createElement(M.a,null,a.createElement(P.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},a.createElement("div",null,"Click here, or press ESC to close Manage Panel")))),a.createElement(k.a,{style:{textAlign:"center"}},"Here you can manage your saved orchestrations"),a.createElement(f.a,{onDrop:function(e){e.forEach((function(e){var t=new FileReader;t.onabort=function(){return console.log("file reading was aborted")},t.onerror=function(){return console.log("file reading has failed")},t.onload=function(){var e=JSON.parse(localStorage.getItem("orchestrations")),n=0;e.length>0&&(n=e[e.length-1].id+1);var a=JSON.parse(t.result);a.map((function(e){e.id,e.name,e.data})),a.map((function(t,a){var r=t;r.id=n+a,e.push(r)})),u((function(){return e})),localStorage.setItem("orchestrations",JSON.stringify(e))},t.readAsText(e)}))},maxFiles:1,accept:".chords"},(function(e){var t=e.getRootProps,n=e.getInputProps;return a.createElement("section",{className:"container"},a.createElement("div",Object.assign({},t({className:"dropzone Upload"}),{style:{margin:5,padding:5,borderRadius:10,border:"2px dashed #4c4c48"}}),a.createElement("input",n()),a.createElement("p",{style:{textAlign:"center"}},"Upload your saved file of orchestration chords")),a.createElement("aside",null,a.createElement("div",null)))})),0===l.length&&a.createElement(k.a,{style:{textAlign:"center"}},"Add some orchestrations to your list (Upload a pre-saved file, or click save either in Score Analyzer or in Chord Editor.)"),l.length>0&&a.createElement("div",null,a.createElement(p.a,{onClick:function(){var e=document.createElement("a"),t=new Blob([localStorage.getItem("orchestrations")],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download="orchestration.chords",document.body.appendChild(e),e.click()},variant:"contained",color:"primary",style:{padding:10,margin:5}}," Download your orchestrations "),a.createElement(k.a,{style:{textAlign:"center"}},"List of your orchestrations"),a.createElement("table",{style:{textAlign:"center",margin:"auto"}},a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,"Name"),a.createElement("td",null,"Orchestration"),a.createElement("td",null,"Listen"),a.createElement("td",null,"Delete")),l.map((function(e,t){return a.createElement("tr",null," ",a.createElement("td",null,e.name),"  ",a.createElement("td",null,v(e.data)),a.createElement("td",null,a.createElement(p.a,{onClick:function(n){return function(e,t,n){var r=[];t.map((function(e,t){e[3].map((function(t){var n=0;"number"===typeof e[7]&&(n=e[7]),r.push(e[0]+","+e[1]+","+e[2]+","+(t+n))}))})),x.a.post("https://rest.score-tool.com/listen",{orchestration:r,positions:Array(r.length).fill(17),listeningPosition:"audience"},{headers:{auth:"uljasPulkkis"}}).then((function(t){var n=a.createElement("div",null,a.createElement("audio",{controls:!0,autoPlay:"true"}," ",a.createElement("source",{src:t.data,type:"audio/x-wav"})," ")),r=Object(N.a)(h);r[e]=n,b((function(){return r}))}))}(t,e.data)},variant:"contained",color:"secondary",style:{padding:10,margin:5}}," LISTEN "),h[t]),a.createElement("td",null,a.createElement(p.a,{onClick:function(t){return function(e,t){console.log(e);var n=JSON.parse(localStorage.getItem("orchestrations")).filter((function(t,n,a){return t.id!=e}));u((function(){return n})),localStorage.setItem("orchestrations",JSON.stringify(n))}(e.id)},variant:"contained",color:"warning",style:{padding:10,margin:5}}," DELETE ")))})))),a.createElement(p.a,{onClick:function(){u((function(){return[]})),localStorage.setItem("orchestrations",JSON.stringify([]))},variant:"contained",color:"error",style:{padding:10,margin:5}}," Erase all your orchestrations "))))}function rt(e){return a.createElement("div",null,a.createElement(k.a,{variant:"h4",style:{border:"1px solid",padding:5}},"This is a completely new version of Score-Tool. If you want to use the old version, visit ",a.createElement("a",{href:"https://old.score-tool.com",target:"_blank"},"old.score-tool.com")," "),a.createElement(k.a,{variant:"h5"},"About"),a.createElement(k.a,null,"Score-Tool is an analysis tool for music orchestration. The purpose of the tool is to help composers, conductors and other musicians to extract information about audibility and timbre from the score. The analysis results are showed on graphs, and there is also a possibility to listen any orchestration chord in a real binaural simulation of the concert hall."),a.createElement(k.a,{variant:"h5"},"Score"),a.createElement(k.a,null,'For analysis, the score must be in uncompressed musicXML format. All current notation programs can export musicXML from the "SaveAs" menu. Drag and drop, or click drop area to upload your score to Score-Tool. Click "load score". Analyzed score can be downloaded as PNG file.'),a.createElement(k.a,{variant:"h5"},"Chord"),a.createElement(k.a,null,'The Chord editor can be used without any files. Click any instrument name to add it to your orchestration. Click the notation stave and add notes with piano keyboard. After editing the instrumentation press "Update graphs" to view the analysis information.'),a.createElement(k.a,{variant:"h5"},"Compare"),a.createElement(k.a,null,"The Compare editor lets you compare two individual timbres. Click the mini-staff to select pitch for each instrument. The graphs show the overtone structure and timbre data of both instruments."),a.createElement(k.a,{variant:"h5"},"Search"),a.createElement(k.a,null,"The Search feature requires you to save some orchestrations first. Orchestrations can be saved in Score and Chord editors. Select the search source from your saved orchestrations, select search space from orchestra instruments, select search method(s) and click SEARCH. As result you will get the closest match from database, which can be added to your saved orchestration."),a.createElement(k.a,{variant:"h5"},"Manage"),a.createElement(k.a,null,"Here you can manage your saved orchestrations. You can listen individual chords, and delete the ones you don't need anymore. The saved chords are already in your machine, in browser's local storage, but here you can also download them as file, or upload your orchestratrions to browser."),a.createElement(k.a,{variant:"h6",style:{padding:10}},"Created in 2021 by ",a.createElement("a",{href:"https://uljaspulkkis.com",target:"_blank"},"Uljas Pulkkis")," "))}var ot=n(174),st=n.n(ot),ct=n(173),it=n.n(ct),lt=n(176),ut=n.n(lt),mt=n(172),dt=n.n(mt),ft=n(175),ht=n.n(ft),pt=n(295),gt=Object(Fe.a)({palette:{neutral:{main:"#dcc4ac",contrastText:"#black"}}}),bt=Object(B.a)(U.a)((function(e){var t=e.theme;return Object(d.a)(Object(d.a)({},t.typography.body2),{},{backgroundColor:"#fffef0",padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})})),vt=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={file:"",cursor:!1,next:0,files:[],load:"none",chord:!1,compare:!1,search:!1,manage:!1,analyze:"none",about:"block",osmd:""},a.setcursor=a.setcursor.bind(Object(l.a)(a)),a.setnext=a.setnext.bind(Object(l.a)(a)),a.loadFile=a.loadFile.bind(Object(l.a)(a)),a.onDrop=function(e){a.setState({files:e})},document.title="Score-Tool 2.0",a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){null===JSON.parse(localStorage.getItem("orchestrations"))&&localStorage.setItem("orchestrations",JSON.stringify([]))}},{key:"chordClose",value:function(){this.setState((function(e){return e.chord=!1}))}},{key:"compareClose",value:function(){this.setState((function(e){return e.compare=!1}))}},{key:"searchClose",value:function(){this.setState((function(e){return e.search=!1}))}},{key:"manageClose",value:function(){this.setState((function(e){return e.manage=!1}))}},{key:"setcursor",value:function(){this.setState((function(e){return e.cursor=!0}))}},{key:"loadFile",value:function(){var e=this;this.state.files.forEach((function(t){var n=new FileReader;n.onabort=function(){return console.log("file reading was aborted")},n.onerror=function(){return console.log("file reading has failed")},n.onload=function(){var t=n.result;e.setState((function(e){e.file=t,e.load="inline-block"})),e.forceUpdate()};var a=t.name;a.toLowerCase().indexOf(".xml")>0||a.toLowerCase().indexOf(".musicxml")>0?n.readAsText(t):a.toLowerCase().indexOf(".mxl")>0?n.readAsBinaryString(t):alert("No vaild .xml/.mxl/.musicxml file!")}))}},{key:"setnext",value:function(){var e=this.state.next;this.setState((function(t){return t.next=e+1}))}},{key:"handleClick",value:function(e){var t=e.target.value;this.setState((function(e){return e.file=t}))}},{key:"render",value:function(){var e=this,t=this.state.files.map((function(e){return r.a.createElement("li",{key:e.name},e.name," - ",e.size," bytes")})),n=[];if(this.state.files[0]){var a="inline-block";"inline-block"===this.state.load&&(a="none"),n=r.a.createElement("div",null,r.a.createElement("div",{style:{display:a}},r.a.createElement(p.a,{onClick:this.loadFile,variant:"contained"},"Load current file")),r.a.createElement("div",{style:{display:this.state.load}},r.a.createElement(ie,{file:this.state.file,show:this.state.cursor,next:this.state.next})))}return document.body.style.backgroundColor="#fffef0",r.a.createElement("div",{className:"App"},r.a.createElement(bt,null,r.a.createElement("header",{className:"App-header",style:{padding:10,borderRadius:20}},r.a.createElement("h1",{className:"App-title",style:{padding:10,borderRadius:20}},"Score-Tool 2.0"),r.a.createElement("h1",{className:"App-title",style:{padding:10,borderRadius:20}},"Psychoacoustic orchestration tool by Uljas Pulkkis 2021")),r.a.createElement(We.a,{theme:gt},r.a.createElement("div",{style:{padding:10}},r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{analyze:"none",about:"block"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(dt.a,null),style:{padding:10,margin:5}}," About Score-tool")),r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{analyze:"block",about:"none"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(it.a,null),style:{padding:10,margin:5}}," Open score analyzer")),r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{chord:!0,analyze:"none",about:"none"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(st.a,null),style:{padding:10,margin:5}}," Open chord editor")),r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{compare:!0,analyze:"none",about:"none"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(ht.a,null),style:{padding:10,margin:5}}," Open compare editor")),r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{search:!0,analyze:"none",about:"none"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(pt.a,null),style:{padding:10,margin:5}}," Open search panel")),r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{manage:!0,analyze:"none",about:"none"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(ut.a,null),style:{padding:10,margin:5}}," Manage your orchestrations ")))),r.a.createElement(Be,{handleClose:this.chordClose.bind(this),open:this.state.chord}),r.a.createElement(Ye,{handleClose:this.compareClose.bind(this),open:this.state.compare}),r.a.createElement(tt,{handleClose:this.searchClose.bind(this),open:this.state.search}),r.a.createElement(at,{handleClose:this.manageClose.bind(this),open:this.state.manage}),r.a.createElement("div",{className:"",style:{display:this.state.analyze}},r.a.createElement(k.a,{style:{textAlign:"center"}}," Select an example score  "),r.a.createElement(O.a,{sx:{m:1,minWidth:150}},r.a.createElement(E.a,{id:"score-select"},"Scores"),r.a.createElement(y.a,{labelId:"score-select",id:"score-select1",value:this.state.selected,onChange:function(t){var n=t.target.value;e.setState((function(t){return t.osmd=r.a.createElement(ie,{file:n,show:e.state.cursor,next:e.state.next})}))},autoWidth:!0,label:"score"},["test_score2.xml","sonority.xml"].map((function(e){return r.a.createElement(_.a,{value:e},e)})))),r.a.createElement(k.a,{style:{textAlign:"center"}}," or  "),r.a.createElement(f.a,{onDrop:this.onDrop,maxFiles:1},(function(e){var n=e.getRootProps,a=e.getInputProps;return r.a.createElement("section",{className:"container"},r.a.createElement("div",Object.assign({},n({className:"dropzone Upload"}),{style:{margin:20,padding:10,borderRadius:10,border:"2px dashed #4c4c48",backgroundColor:"#dcc4ac"}}),r.a.createElement("input",a()),r.a.createElement("p",null,"Drop musicXML or click")),r.a.createElement("aside",null,r.a.createElement("div",null,t)))})),n,this.state.osmd),r.a.createElement("div",{style:{display:this.state.about,textAlign:"left",textJustify:"left",paddingInline:"20vw"}},r.a.createElement(rt,null))))}}]),n}(a.Component),yt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Et(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(r.a.createElement(vt,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");yt?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Et(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Et(e)}))}}()}},[[197,1,2]]]);