(this["webpackJsonpreact-score-tool"]=this["webpackJsonpreact-score-tool"]||[]).push([[0],{161:function(e,t,n){},193:function(e,t,n){e.exports=n(248)},198:function(e,t,n){},201:function(e,t,n){},248:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(69),s=n.n(o),c=(n(198),n(5)),l=n(6),i=n(33),u=n(9),m=n(10),d=n(3),h=n(116),f=(n(201),n(48)),p=n(306),g=n(294),b=n(290),v=n(296),y=n(293),E=n(307),_=n(309),O=n(37),k=n.n(O),C=n(164),w={alto_flute:["normal"],alto_sax:["normal"],baritone_generic:["normal"],bassoon:["normal"],bass_cl:["normal"],bass_flute:["normal"],bass_trombone:["normal"],cello:["harmonics","normal","pizz","pizz_harmonics","sord","sord_trem","trem"],clarinet:["normal"],clarinet_eb:["normal"],crotale:["normal"],cymbal:["13crash_bell","13crash_bow","13crash_chokecrash","13crash_mallet","13crash_normal","13crash_roll","13crash_shoulder","16chinese_bell","16chinese_bow","16chinese_chokecrash","16chinese_mallet","16chinese_normal","16chinese_roll","16chinese_shoulder","17crash_bell","17crash_bow","17crash_chokecrash","17crash_mallet","17crash_normal","17crash_roll","17crash_shoulder","17orchcrash","18crash_bell","18crash_bow","18crash_chokecrash","18crash_mallet","18crash_normal","18crash_roll","18crash_shoulder","18orchcrash_french","18orchcrash_germanic","18orchcrash_viennese","19chinese_bell","19chinese_bow","19chinese_chokecrash","19chinese_mallet","19chinese_normal","19chinese_roll","19chinese_shoulder","20chinese_bell","20chinese_bow","20chinese_chokecrash","20chinese_mallet","20chinese_normal","20chinese_roll","20chinese_shoulder","20crash_bell","20crash_bow","20crash_chokecrash","20crash_mallet","20crash_normal","20crash_roll","20crash_shoulder","21ride_bell","21ride_mallet","21ride_normal","21ride_roll","21ride_shoulder","hihat_bell","hihat_footclose","hihat_footsplash","hihat_normal","hihat_shoulder","normal","smallmetals","splash_bell","splash_mallet","splash_roll","splash_splash","windgong","windgong_bow"],double_bass:["harmonics","normal","pizz","pizz_harmonics","trem"],english_horn:["normal"],flute:["normal","vib"],guitar:["normal","normal_sulA","normal_sulB","normal_sulD","normal_sulE","normal_sulG","normal_sul_E"],harp:["normal"],horn:["normal"],oboe:["normal"],percussion_misc:["castanet","guiro_away","guiro_toward","shakers"],piano:["normal"],piccolo:["normal"],solo_cello:["arco_sulA","arco_sulC","arco_sulD","arco_sulG","normal"],solo_double_bass:["arco_sulA","arco_sulD","arco_sulE","arco_sulG","normal","pizz","pizz_sulA","pizz_sulD","pizz_sulE","pizz_sulG"],solo_viola:["arco_sulA","arco_sulC","arco_sulD","arco_sulG","normal"],solo_violin:["arco_sulA","arco_sulD","arco_sulE","arco_sulG","normal"],soprano_generic:["normal"],soprano_sax:["normal","normal_Vib"],tambourine:["normal","normal_fingerroll","normal_sforzando","normal_shakeroll","normal_thumbroll"],tamtam:["bow","normal"],tamtam_22:["bow","normal"],tamtam_40:["bow","normal"],tenor_generic:["normal"],thaigong:["normal"],triangle_6:["normal","normal_roll"],triangle_8:["normal","normal_roll"],trumpet:["normal","vib"],tuba:["normal"],vibraphone:["normal","normal_bow"],viola:["harmonics","normal","pizz","sord","sord_trem","trem"],violin:["harmonics","normal","pizz","sord","sord_trem","tremolo"],woodblock:["clave","graniteblock","normal"],xylophone:["gliss_down","gliss_up","normal","normal_hardrubber"],tenor_trombone:["normal"],timp:["normal"]},x=n(20),j=n(14),S=n(303),N=n(297),T=n(312),I=n(313),A=n(308),D=n(284),P=n(70),M=n.n(P),L=n(83),z=L.a.Flow,R=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).notes=0,a.target=0,a.instruments=0,a.renderer=0,a.context=0,a.scale=1,a.state={x:0,y:0},a}return Object(l.a)(n,[{key:"setupScore",value:function(){var e=document.createElement("div"),t=this.props,n=(t.id,t.notes),a=t.target,r=t.instruments,o=(t.setProps,t.width),s=t.height,c=t.t_score_y,l=t.b_score_y,i=t.target_color,u=t.text_space,m=t.highlights,d=t.indexing,h=t.scale;this.notes=n,this.target=a,this.instruments=r,this.scale=h,this.renderer=new z.Renderer(e,z.Renderer.Backends.SVG),this.renderer.resize(o+u,s);var f=this.renderer.getContext();this.context=f,this.context.scale(this.scale,this.scale);var p=new z.Stave(20,c,o);p.addClef("treble"),p.setContext(this.context).draw();var g=new z.Stave(20,l,o);g.addClef("bass"),g.setContext(this.context).draw();var b=function(e,t,n){var a,r,o,s,c,l,i,u=[],h=[],f=[],p=[],g=[],b=[],v=[],y=[],E=[],_=[],O=[],k=[],C=[],w=[],x=[];for(a=0;a<e.length;a++){c=e[a],i=d?a+": "+t[a]:t[a];var j="";if("undefined"!==typeof m[a]&&(j=m[a]),r=c[0],o=c[c.length-1],s=c.length>2?c[1]:"n",l=r.concat("/",o),S=n[a],parseInt(o)>=4&&parseInt(o)<6){u.push(l),h.push(s),p.push(i),g.push(j);for(var S=0,N=0;N<n.length;N++)n[N]===a&&(S=1);f.push(S)}else if(parseInt(o)>=6){o-=2,l=r.concat("/",o),O.push(l),k.push(s),w.push(i),x.push(j);for(S=0,N=0;N<n.length;N++)n[N]===a&&(S=1);C.push(S)}else{b.push(l),v.push(s),E.push(i),_.push(j);for(S=0,N=0;N<n.length;N++)n[N]===a&&(S=1);y.push(S)}}return[u,h,f,b,v,y,p,E,g,_,O,k,C,w,x]}(this.notes,this.instruments,this.target);if(Array.isArray(b[10])&&b[10].length){var v=new z.Stave(20,40,o);v.addClef("treble"),v.setContext(this.context).draw(),this.context.fillText("15ma",v.x+6,v.y+26);for(var y=[],E=0;E<b[10].length;E++)y.push("c/4");var _=new z.StaveNote({clef:"treble",keys:y,duration:"q"});_.setStemStyle({strokeStyle:"none"}),_.setLedgerLineStyle({strokeStyle:"none"});for(E=0;E<b[10].length;E++)_.setKeyLine(E,E-1.5);var O=new z.StaveNote({clef:"treble",keys:b[10],duration:"q"}),k=b[13],C=b[14];for(E=0;E<b[11].length;E++){O.addAccidental(E,new z.Accidental(b[11][E]));var w=F(k[E],z.Modifier.Position.RIGHT);w.setOffsetX(-10),_.note_heads[E].glyph_code="v23",_.addModifier(E,w),C[E]&&O.setKeyStyle(E,{shadowColor:C[E],shadowBlur:100}),1===b[12][E]&&(O.setKeyStyle(E,{fillStyle:i}),_.setKeyStyle(E,{fillStyle:i}))}var x=new z.StaveConnector(v,g),j=new z.StaveConnector(v,g)}else x=new z.StaveConnector(p,g),j=new z.StaveConnector(p,g);x.setType(z.StaveConnector.type.SINGLE_LEFT),x.setContext(this.context),x.draw(),j.setType(z.StaveConnector.type.BRACKET),j.setContext(this.context),j.draw();var S=[];for(E=0;E<b[0].length;E++)S.push("c/4");var N=new z.StaveNote({clef:"treble",keys:S,duration:"q"});N.setStemStyle({strokeStyle:"none"}),N.setLedgerLineStyle({strokeStyle:"none"});for(E=0;E<b[0].length;E++)N.setKeyLine(E,E-1.5);var T=[];for(E=0;E<b[3].length;E++)T.push("c/3");var I=new z.StaveNote({clef:"bass",keys:T,duration:"q"});I.setStemStyle({strokeStyle:"none"}),I.setLedgerLineStyle({strokeStyle:"none"});for(E=0;E<b[3].length;E++)I.setKeyLine(E,E-1.5);var A=new z.StaveNote({clef:"treble",keys:b[0],duration:"q"}),D=new z.StaveNote({clef:"bass",keys:b[3],duration:"q"}),P=b[6],M=b[7],L=b[8],R=b[9];function F(e,t){return new z.FretHandFinger(e).setPosition(t)}for(E=0;E<b[1].length;E++){A.addAccidental(E,new z.Accidental(b[1][E]));var V=F(P[E],z.Modifier.Position.RIGHT);V.setOffsetX(-10),N.note_heads[E].glyph_code="v23",N.addModifier(E,V),L[E]&&A.setKeyStyle(E,{shadowColor:L[E],shadowBlur:100}),1===b[2][E]&&(A.setKeyStyle(E,{fillStyle:i}),N.setKeyStyle(E,{fillStyle:i}))}for(E=0;E<b[3].length;E++){D.addAccidental(E,new z.Accidental(b[4][E]));var W=F(M[E],z.Modifier.Position.RIGHT);W.setOffsetX(-10),I.note_heads[E].glyph_code="v23",I.addModifier(E,W),R[E]&&D.setKeyStyle(E,{shadowColor:R[E],shadowBlur:100}),1===b[5][E]&&(D.setKeyStyle(E,{fillStyle:i}),I.setKeyStyle(E,{fillStyle:i}))}if(Array.isArray(b[0])&&b[0].length){var G=new z.Voice({num_beats:1,beat_value:4}).setMode(2),K=new z.Voice({num_beats:1,beat_value:4}).setMode(2);G.addTickables([A]),K.addTickables([N]);(new z.Formatter).joinVoices([G]).format([G],o);(new z.Formatter).joinVoices([K]).format([K],o).tickContexts.array[0].x=o-40,G.draw(this.context,p),K.draw(this.context,p)}var B=new z.Voice({num_beats:1,beat_value:4}),U=new z.Voice({num_beats:1,beat_value:4});if(U.addTickables([I]),Array.isArray(b[3])&&b[3].length){B.addTickables([D]);(new z.Formatter).joinVoices([B]).format([B],o);(new z.Formatter).joinVoices([U]).format([U],o).tickContexts.array[0].x=o-40,B.draw(this.context,g),U.draw(this.context,g)}if(Array.isArray(b[10])&&b[10].length){var H=new z.Voice({num_beats:1,beat_value:4}).setMode(2),J=new z.Voice({num_beats:1,beat_value:4}).setMode(2);H.addTickables([O]),J.addTickables([_]);(new z.Formatter).joinVoices([H]).format([H],o);(new z.Formatter).joinVoices([J]).format([J],o).tickContexts.array[0].x=o-40,H.draw(this.context,v),J.draw(this.context,v);var q=[];for(E=0;E<y.length;E++){var X=new z.StaveLine({first_note:O,last_note:_,first_indices:[E],last_indices:[E]});X.render_options.line_width=3,X.render_options.padding_right=-4,C[E]&&(X.render_options.color=C[E]),1===b[12][E]&&(X.render_options.color=i),q.push(X)}for(var Y=0;Y<q.length;Y++)q[Y].setContext(f),q[Y].draw()}var Q=[];for(E=0;E<S.length;E++){var $=new z.StaveLine({first_note:A,last_note:N,first_indices:[E],last_indices:[E]});$.render_options.line_width=3,$.render_options.padding_right=-4,L[E]&&($.render_options.color=L[E]),1===b[2][E]&&($.render_options.color=i),Q.push($)}var Z=[];for(E=0;E<T.length;E++){var ee=new z.StaveLine({first_note:D,last_note:I,first_indices:[E],last_indices:[E]});ee.render_options.line_width=3,ee.render_options.padding_right=-4,R[E]&&(ee.render_options.color=R[E]),1===b[5][E]&&(ee.render_options.color=i),Z.push(ee)}for(Y=0;Y<Q.length;Y++)Q[Y].setContext(f),Q[Y].draw();for(Y=0;Y<Z.length;Y++)Z[Y].setContext(f),Z[Y].draw();this.refs.outer.appendChild(e),this.refs.outer.addEventListener("click",this.orchClick.bind(this),!1)}},{key:"orchClick",value:function(e){var t=this.props,n=t.setProps,a=t.indexing;if(e.target.closest("text")&&a){var r=e.target.innerHTML.split(":"),o=parseInt(r[0]);n&&n({onClick:o}),console.log(o)}}},{key:"componentDidMount",value:function(){this.setupScore()}},{key:"componentDidUpdate",value:function(e){for(var t=this.refs.outer;t.hasChildNodes();)t.removeChild(t.lastChild);this.setupScore()}},{key:"render",value:function(){var e=this.props,t=e.id;e.notes,e.instruments,e.target;return r.a.createElement("div",{id:t,ref:"outer",style:{border:"none",padding:0,borderRadius:0,display:"inline-block"}})}}]),n}(a.Component);R.defaultProps={width:200,height:400,t_score_y:110,b_score_y:200,text_space:120,target_color:"red",highlights:[],indexing:!0};var F=L.a.Flow,V=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={x:0,y:0},a}return Object(l.a)(n,[{key:"setupScore",value:function(){var e=document.createElement("div"),t=this.props,n=(t.id,t.masking_notevalues),a=t.masking_notesizes,r=t.masking_colors,o=t.target_notevalues,s=t.target_notesizes,c=t.target_colors,l=(t.setProps,new F.Renderer(e,F.Renderer.Backends.SVG));l.resize(100,250);var i=l.getContext(),u=new F.Stave(10,60,100);u.addClef("treble"),u.setContext(i).draw();var m=new F.Stave(10,120,100);m.addClef("bass"),m.setContext(i).draw();var d=new F.StaveConnector(u,m);d.setType(F.StaveConnector.type.SINGLE_LEFT),d.setContext(i),d.draw();var h=new F.StaveConnector(u,m);h.setType(F.StaveConnector.type.BRACKET),h.setContext(i),h.draw();for(var f=[],p=[],g=[],b=[],v=[],y=[],E=0;E<n.length;E++)n[E]>59?(f.push(n[E]),p.push(a[E]),g.push(r[E])):(b.push(n[E]),v.push(a[E]),y.push(r[E]));var _=[],O=[],k=[],C=[],w=[],x=[];for(E=0;E<o.length;E++)o[E]>59?(_.push(o[E]),O.push(s[E]),k.push(c[E])):(C.push(o[E]),w.push(s[E]),x.push(c[E]));var j=new Array,S=new Array,N=new Array,T=new Array;function I(e,t){var n=0;return 40===t&&(n=-1),(e=(e-t)/4)>1+n&&(e+=.25),e>3+n&&(e+=.25),e>4.5+n&&(e+=.25),e>6.5+n&&(e+=.25),e>8+n&&(e+=.25),e>10+n&&(e+=.25),e>13.5+n&&(e+=.25),e>15.5+n&&(e+=.25),e}var A=[];if(Array.isArray(b)&&b.length){for(E=0;E<b.length;E++){var D=I(b[E],40);(z=new F.NoteHead({duration:"128",line:D,custom_glyph_code:"vd2",glyph_font_scale:v[E],style:{fillStyle:"none"}})).setCenterAlignment(!0),S.push(z)}var P=new F.Voice({num_beats:1,beat_value:1}).setMode(2);P.addTickables(S);(new F.Formatter).joinVoices([P]).format([P],1);P.draw(i,m)}if(Array.isArray(f)&&f.length){for(E=0;E<f.length;E++){D=I(f[E],60);(z=new F.NoteHead({duration:"128",line:D,custom_glyph_code:"vd2",glyph_font_scale:p[E],style:{fillStyle:"none"}})).setCenterAlignment(!0),j.push(z)}var M=new F.Voice({num_beats:1,beat_value:1}).setMode(2);M.addTickables(j);(new F.Formatter).joinVoices([M]).format([M],1);M.draw(i,u)}if(Array.isArray(_)&&_.length){N.push(new F.GhostNote("q"));for(E=0;E<_.length;E++){D=I(_[E],60);(z=new F.NoteHead({duration:"128",displaced:!1,line:D,custom_glyph_code:"vb",glyph_font_scale:O[E],style:{fillStyle:k[E]}})).setCenterAlignment(!0),N.push(z)}var L=new F.Voice({num_beats:1,beat_value:1}).setMode(2);L.addTickables(N);(new F.Formatter).joinVoices([L]).format([L],10);L.draw(i,u)}if(Array.isArray(C)&&C.length){T.push(new F.GhostNote("q"));for(E=0;E<C.length;E++){var z;D=I(C[E],60);(z=new F.NoteHead({duration:"128",displaced:!1,line:D,custom_glyph_code:"vb",glyph_font_scale:w[E],style:{fillStyle:x[E]}})).setCenterAlignment(!0),T.push(z)}var R=new F.Voice({num_beats:1,beat_value:1}).setMode(2);R.addTickables(T);(new F.Formatter).joinVoices([R]).format([R],10);R.draw(i,u)}if(Array.isArray(b)&&b.length)for(E=0;E<b.length;E++)A.push(P.tickables[E].y);if(Array.isArray(f)&&f.length)for(E=0;E<f.length;E++)A.push(M.tickables[E].y);for(var V=0;V<A.length-1;V++)i.beginPath().moveTo(40,A[V]).lineTo(90,A[V]).lineTo(90,A[V+1]).lineTo(40,A[V+1]).closePath().fill({fill:r[V]});i.beginPath().closePath(),this.refs.outer2.appendChild(e)}},{key:"componentDidMount",value:function(){this.setupScore()}},{key:"componentDidUpdate",value:function(e){for(var t=this.refs.outer2;t.hasChildNodes();)t.removeChild(t.lastChild);this.setupScore()}},{key:"render",value:function(){var e=this.props.id;return r.a.createElement("div",{id:e,ref:"outer2",style:{border:"none",padding:0,borderRadius:0,display:"inline-block"}})}}]),n}(a.Component);V.defaultProps={};var W=n(299),G=n(12),K=n(305),B=Object(G.a)(K.a)((function(e){var t=e.theme;return Object(d.a)(Object(d.a)({},t.typography.body2),{},{backgroundColor:"#fffef0",padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})}));function U(e){if(e.data.length<2)return null;var t=[{domain:{x:[0,1],y:[0,1]},value:e.data[2].var_coeff_graph,title:{text:"Orch. timbre homogeneity"},type:"indicator",mode:"gauge+number",gauge:{axis:{range:[null,100]}}}],n=e.data[2].fig_config,r=e.data[2].msking_graph.data,o=e.data[2].msking_graph.layout;return o.width=window.innerWidth-380,a.createElement("div",null,a.createElement(W.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:.5},a.createElement(W.a,{item:!0,xs:6,md:6},a.createElement(B,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(_.a,null,"Orchestration at clicked point"),a.createElement("div",{style:{backgroundColor:"rgba(0,255,0,0.3)",display:"inline"}},"Target"),a.createElement("div",{style:{backgroundColor:"rgba(255,0,0,0.5)",display:"inline"}}," Orchestration heaviest masker"),a.createElement("div",{style:{backgroundColor:"rgba(255,255,0,0.5)",display:"inline"}}," Orchestration second heaviest masker"),a.createElement("div",{style:{backgroundColor:"rgba(255,0,255,0.5)",display:"inline"}}," Orchestration third heaviest masker "),a.createElement(R,{notes:e.data[4].notes,instruments:e.data[4].instruments,target:e.data[4].target,target_color:"green",highlights:e.data[4].highlights,width:200,text_space:200}))),a.createElement(W.a,{item:!0,xs:6,md:6},a.createElement(B,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(_.a,null,"Spectral centroid at clicked point"),a.createElement(R,{notes:e.data[2].centroid_graph.notes,instruments:e.data[2].centroid_graph.markings,target:[],width:150,text_space:200})))),a.createElement(W.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:.5},a.createElement(W.a,{item:!0,xs:6,md:6},a.createElement(B,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(_.a,null,"Timbre distance data"),a.createElement(_.a,null,"Target timbre distance from orchestration: ",e.data[2].distance_graph,"/100"),a.createElement(M.a,{data:t,layout:{width:350,margin:{t:0,b:0},plot_bgcolor:"#fffef0",paper_bgcolor:"#fffef0"},config:n}))),a.createElement(W.a,{item:!0,xs:6,md:6},a.createElement(B,{style:{height:452,backgroundColor:"#fffef0",verticalAlign:"center"}},a.createElement(_.a,null,"Masking staff graph"),a.createElement("br",null),a.createElement("br",null),a.createElement(V,{masking_notevalues:e.data[2].masking_score.masking_notevalues,masking_colors:e.data[2].masking_score.masking_colors,masking_notesizes:e.data[2].masking_score.masking_notesizes,target_notevalues:e.data[2].masking_score.target_notevalues,target_colors:e.data[2].masking_score.target_colors,target_notesizes:e.data[2].masking_score.target_notesizes})))),a.createElement(W.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"left",alignItems:"left",spacing:.5},a.createElement(W.a,{item:!0,xs:12,md:12},a.createElement(B,null,a.createElement(M.a,{data:r,layout:Object(d.a)(Object(d.a)({},o),{},{width:window.innerWidth-50}),config:n})))),a.createElement(W.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:.5},a.createElement(W.a,{item:!0,xs:4,md:4},a.createElement(B,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(_.a,null,"Summary of the current orchestration"),a.createElement("br",null),a.createElement("br",null),a.createElement(_.a,null,e.data[2].summary))),a.createElement(W.a,{item:!0,xs:8,md:8},a.createElement(B,null,a.createElement(M.a,{data:e.data[2].mfcc_graph.data,layout:Object(d.a)(Object(d.a)({},e.data[2].mfcc_graph.layout),{},{width:window.innerWidth/1.5-50}),config:n,width:200})))))}var H=n(135);function J(e){var t=function(e){var t=21,n={violin:2,viola:8,cello:11,double_bass:14,flute:15,oboe:16,clarinet:17,bassoon:18,horn:19,trumpet:22,tenor_trombone:23,bass_trombone:21,timpani:22,cymbal:24};return Object.keys(n).includes(e)&&(t=n[e]),t},n=[];e.instrumentList.map((function(e){return n.push(e[0])}));var r=[[10,50,3],[20,50,2],[30,50,1],[60,50,10],[70,50,11],[80,50,12],[15,35,6],[25,35,5],[40,40,4],[55,40,7],[65,35,8],[75,35,9],[86,35,13],[18,20,20],[32,20,19],[45,30,15],[50,30,16],[70,20,24],[80,20,14],[40,10,22],[50,10,21],[60,10,23],[45,20,17],[50,20,18],[45,55,25]],o=[];r.map((function(e){return o.push(!1)}));var s=a.useState({clicked:!1,over:!1,drop:"not yet",instrument_assignment:n.map((function(e){return t(e)})),hoverState:o,position:"audience",audio:""}),c=Object(j.a)(s,2),l=c[0],i=c[1];if(a.useEffect((function(){i((function(e){return Object(d.a)(Object(d.a)({},e),{},{instrument_assignment:n.map((function(e){return t(e)}))})}))}),[e]),0===e.instrumentList.length)return null;var u=function(e,t){if(console.log(e),t){var n=Object(x.a)(l.instrument_assignment);n[t.dragData.data]=e;var a=Object(x.a)(l.hoverState);a[e-1]=!1,i(Object(d.a)(Object(d.a)({},l),{},{instrument_assignment:n,hoverState:a}))}},m=function(e,t,n){var r=e+"%",o=t+"%";return a.createElement("div",{style:{left:r,position:"absolute",top:o}},a.createElement(H.DropTarget,{onHit:function(e){return u(n,e)},targetKey:"foo",onDragEnter:function(e){return function(e,t){var n=Object(x.a)(l.hoverState);n[e]=!0,i(Object(d.a)(Object(d.a)({},l),{},{hoverState:n}))}(n-1)},onDragLeave:function(e){return function(e,t){var n=Object(x.a)(l.hoverState);n[e]=!1,i(Object(d.a)(Object(d.a)({},l),{},{hoverState:n}))}(n-1)}},a.createElement("h2",{style:{backgroundColor:"rgba(0,255,0,0.3)",borderRadius:"30px",padding:6}},n," ",l.hoverState[n-1]?"DROP HERE":"")))};return a.createElement("div",{style:{maxWidth:800,textAlign:"center",margin:"auto",alignItems:"center"}},a.createElement("div",{style:{padding:20}},"Here you can listen how your orchestration sounds like played with real instruments in Helsinki Music Center hall. The algorithm utilize pre-calculated impulse responses. Helsinki Musiikkitalo spatial impulse response measurements are done by Aalto University. They are used here with permission from Prof. Tapio Lokki, who has computed the binaural responses"),a.createElement("div",{style:{marginTop:-20,padding:20}},"Drag the instruments of your orchestration to the place on stage you want them to play. Select the listening position, selecting 'conductor' places you on the conductor podium and 'audience' to the center of row 6. When you are ready, tap 'listen' and wait for a few seconds for calculations."),a.createElement(p.a,{onClick:function(){i(Object(d.a)(Object(d.a)({},l),{},{audio:""}));var t={orchestration:e.instrumentList.map((function(e){return e[0]+","+e[1]+","+e[2]+","+e[3]})),positions:l.instrument_assignment,listeningPosition:l.position};k.a.post("https://rest.score-tool.com/listen",t,{headers:{auth:"uljasPulkkis"}}).then((function(e){var t=a.createElement("div",null,a.createElement("audio",{controls:!0}," ",a.createElement("source",{src:e.data,type:"audio/x-wav"})," "));i(Object(d.a)(Object(d.a)({},l),{},{audio:t}))})).catch((function(e){return console.log(e)}))},variant:"contained"},"click here to calculate acoustics and listen"),l.audio,a.createElement("div",{style:{display:"block"}},a.createElement(E.a,{sx:{m:1,minWidth:50}},a.createElement(v.a,{id:"listen-select"},"Position"),a.createElement(b.a,{labelId:"listen-select",id:"listen-select",value:l.position,onChange:function(e){return i(Object(d.a)(Object(d.a)({},l),{},{position:e.target.value}))},autoWidth:!0,label:"listen-select"},a.createElement(y.a,{value:"audience"},"audience"),a.createElement(y.a,{value:"conductor"},"conductor")))),a.createElement("div",{style:{float:"left"}},n.map((function(e,t){return a.createElement(H.DragDropContainer,{dragClone:!1,targetKey:"foo",onDrop:u,dragData:{data:t}},a.createElement("div",{style:{backgroundColor:"rgba(0,255,255,0.3)",borderRadius:"30px",fontSize:24,padding:10}},e+": "+l.instrument_assignment[t]))}))),a.createElement("div",{style:{clear:"both"}},"\xa0"),a.createElement("div",{style:{backgroundImage:"url(./musatalo.jpg)",position:"relative",backgroundSize:"100% 120%",backgroundRepeat:"no-repeat"}},a.createElement("div",{style:{minHeight:"50vh"}},r.map((function(e){return m(e[0],e[1],e[2])})))))}function q(e){var t=e.text,n=e.orchestration,r=a.useState({textFieldValue:t,saved:!1}),o=Object(j.a)(r,2),s=o[0],c=o[1];a.useEffect((function(){c((function(e){return Object(d.a)(Object(d.a)({},e),{},{saved:!1,textFieldValue:t})}))}),[n]);var l=function(){if(n.length>0){var e=JSON.parse(localStorage.getItem("orchestrations")),t=0;null!=e&&(e.length>0&&(t=e[e.length-1].id+1),console.log(n),console.log(typeof n[0][3]),"number"===typeof n[0][3]?e.push({id:t,name:s.textFieldValue,data:n.map((function(e){return[e[0],e[1],e[2],[e[3]],e[4],e[5],e[6]]}))}):e.push({id:t,name:s.textFieldValue,data:n}),localStorage.setItem("orchestrations",JSON.stringify(e)),c((function(e){return Object(d.a)(Object(d.a)({},e),{},{saved:!0})})))}},i=function(e){var t=e.target.value;c((function(e){return Object(d.a)(Object(d.a)({},e),{},{textFieldValue:t})}))};return a.createElement("div",null,s.saved?a.createElement("div",{style:{textAlign:"center"}},"Saved!"):a.createElement("div",null,a.createElement(N.a,{fullWidth:!0,value:s.textFieldValue,label:"save name",onChange:i}),a.createElement(p.a,{fullWidth:!0,variant:"contained",color:"secondary",onClick:l}," Save to your list of orchestrations ")))}function X(e){var t=Object(a.useState)({idx:e.idx,scoreNames:e.row[0],scoreTechs:e.row[1],scoreDyns:e.row[2],scorePitch:e.row[3],scoreTgt:e.row[4],scoreOnoff:e.row[5],scoreIdx:e.row[6],color:e.color,scoreModify:0}),n=Object(j.a)(t,2),o=n[0],s=n[1],c=function(t,n){var a=0;0===o.scoreModify?a=-12:-12===o.scoreModify&&(a=12),s((function(t){return Object(d.a)(Object(d.a)({},t),{},{scoreModify:a,scorePitch:e.row[3]+a})})),e.onChange({idx:o.idx,row:[o.scoreNames,o.scoreTechs,o.scoreDyns,e.row[3]+a,o.scoreTgt,o.scoreOnoff,o.idx]})},l=[];return-12===o.scoreModify?l=r.a.createElement("div",{onClick:c,style:{backgroundColor:"rgba(123,30,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}},"-12"):12===o.scoreModify?l=r.a.createElement("div",{onClick:c,style:{backgroundColor:"rgba(30,123,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}},"12"):0===o.scoreModify&&(l=r.a.createElement("div",{onClick:c,style:{backgroundColor:"rgba(30,30,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}},"0")),r.a.createElement("tr",null,r.a.createElement("td",{key:"scor"+o.idx,style:{backgroundColor:o.color}},o.scoreNames),r.a.createElement("td",{key:"tec"+o.idx},o.scoreTechs),r.a.createElement("td",{key:"dy"+o.idx},r.a.createElement("div",{onClick:function(t,n){var a="mf";"mf"===o.scoreDyns?a="f":"f"===o.scoreDyns&&(a="p"),s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreDyns:a})})),e.onChange({idx:o.idx,row:[o.scoreNames,o.scoreTechs,a,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx]})},style:{backgroundColor:"rgba(123,200,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}}," ",o.scoreDyns," ")),r.a.createElement("td",{key:"tg"+o.idx},r.a.createElement("div",{onClick:function(t,n){s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTgt:!e.scoreTgt})})),e.onChange({idx:o.idx,row:[o.scoreNames,o.scoreTechs,o.scoreDyns,o.scorePitch,!o.scoreTgt,o.scoreOnoff,o.idx]})},style:{backgroundColor:"rgba(123,200,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}},o.scoreTgt?"target":"orchestration")),r.a.createElement("td",{key:"onof"+o.idx}," ",r.a.createElement("div",{onClick:function(t,n){s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreOnoff:!e.scoreOnoff})})),e.onChange({idx:o.idx,row:[o.scoreNames,o.scoreTechs,o.scoreDyns,o.scorePitch,o.scoreTgt,!o.scoreOnoff,o.idx]})},style:{backgroundColor:o.scoreOnoff?"rgba(123,200,30,0.3)":"rgba(200,123,30,0.3)",borderRadius:10,padding:3,textAlign:"center"}},o.scoreOnoff?"ON":"OFF"," ")),r.a.createElement("td",{key:"mo"+o.idx},l))}var Y=a.forwardRef((function(e,t){return a.createElement(D.a,Object.assign({direction:"up",ref:t},e))}));function Q(e){var t=a.useState(!1),n=Object(j.a)(t,2),r=n[0],o=n[1],s=a.useState([]),c=Object(j.a)(s,2),l=c[0],i=c[1],u=a.useState([]),m=Object(j.a)(u,2),d=m[0],h=m[1],f=a.useState([]),p=Object(j.a)(f,2),g=p[0],b=p[1],v=a.useState([]),y=Object(j.a)(v,2),E=y[0],O=y[1],C=a.useState(!1),w=Object(j.a)(C,2),N=(w[0],w[1],a.useState({textFieldValue:"Score Editor orchestration "+JSON.parse(localStorage.getItem("orchestrations")).length})),D=Object(j.a)(N,2),P=D[0],M=(D[1],[]);a.useEffect((function(){o((function(t){return e.open})),e.data.length>1&&(i((function(t){return e.data[1]})),h([])),e.data.length>1&&(b((function(t){return e.data[0].data})),e.data[1].map((function(e){return M.push("")})),e.data[0].data[3].map((function(e,t){M[e]=0===t?"red":1===t?"magenta":2===t?"yellow":""})),O(M))}),[e]);var L=function(t){var n=[];(n=0===d.length?Object(x.a)(l):Object(x.a)(d))[t.idx]=t.row,h((function(e){return n}));var a=[];n.map((function(e){e[5]&&a.push(e)})),k.a.post("https://rest.score-tool.com/modalSlice",a).then((function(t){var n=t.data;b((function(e){return e.data=n.data}));var r=[];e.data[1].map((function(e){return r.push("")})),n.data[3].map((function(t,n){if(0===n){var o=a[t][6];e.data[1].map((function(e,t){e[6]===o&&(r[t]="red")}))}else if(1===n){var s=a[t][6];e.data[1].map((function(e,t){e[6]===s&&(r[t]="magenta")}))}else if(2===n){var c=a[t][6];e.data[1].map((function(e,t){e[6]===c&&(r[t]="yellow")}))}})),O((function(e){return r}))}))},z=[];0===d.length?z=l:d.map((function(e){e[5]&&z.push(e)}));var R=["C","C#","D","D#","E","F","F#","G","G#","A","Bb","B"];return a.createElement("div",null,a.createElement(S.a,{fullScreen:!0,open:r,onClose:e.handleClose,TransitionComponent:Y,PaperProps:{style:{backgroundColor:"#fffef0"}}},a.createElement(T.a,{sx:{position:"relative",backgroundColor:"#dcc4ac",color:"#4c4c48"}},a.createElement(I.a,null,a.createElement(A.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},a.createElement("div",null,"Click here, or press ESC to close")))),a.createElement("div",{style:{textAlign:"center"}},a.createElement(_.a,null,"You can alter the orchestration by clicking the colored values. The changes do not affect the original score."),a.createElement("table",{style:{margin:"auto",display:"inline"}},a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,"Instr."),a.createElement("td",null,"Tech."),a.createElement("td",null,"Dyn."),a.createElement("td",null,"Role"),a.createElement("td",null,"On/Off"),a.createElement("td",null,"Transpose +- oct.")),l.map((function(e,t){return a.createElement(X,{onChange:L,idx:t,row:e,color:""})})))),a.createElement("table",{style:{margin:"auto",display:"inline"}},a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,"maskers")),E.map((function(e,t){return a.createElement("tr",null,a.createElement("td",{style:{backgroundColor:e,borderRadius:10,padding:4,textAlign:"center",margin:4}},l[t][0]," ",(n=l[t][3],R[n%12]+(Math.floor(n/12)-1))));var n})))),a.createElement("br",null),a.createElement(q,{text:P.textFieldValue,orchestration:l}),a.createElement(U,{data:g}),a.createElement(J,{instrumentList:z}))))}var $=n(314),Z=n(286);function ee(e){var t=Object(a.useState)({idx:e.idx,instName:e.instName,scoreNames:e.scoreNames,scoreTechs:e.scoreTechs,scoreDyns:e.scoreDyns,scoreTgt:e.scoreTgt,scoreOnoff:e.scoreOnoff,scoreModify:e.scoreModify}),n=Object(j.a)(t,2),o=n[0],s=n[1];e.onChange({instName:o.instName,scoreNames:o.scoreNames,scoreTechs:o.scoreTechs,scoreDyns:o.scoreDyns,scoreTgt:o.scoreTgt,scoreOnoff:o.scoreOnoff,scoreModify:o.scoreModify});var c,l;return r.a.createElement("tr",null,r.a.createElement("td",{key:"nam"+o.idx},o.instName),r.a.createElement("td",{key:"scor"+o.idx},function(e,t){var n=Object.keys(w);return r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"instrument-select"},"Instr."),r.a.createElement(b.a,{labelId:"instrument-select",id:"instrument-sel"+t,value:e,onChange:function(e){return t=e,void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreNames:t.target.value})}));var t},autoWidth:!0,label:"instr."},n.map((function(e){return r.a.createElement(y.a,{value:e},e)})))))}(o.scoreNames,o.idx)),r.a.createElement("td",{key:"tec"+o.idx},function(e,t){var n=w[o.scoreNames];return r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"tech-select"},"Tech."),r.a.createElement(b.a,{labelId:"tech-select",id:"tech-sel"+t,value:e,onChange:function(e){return t=e,void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTechs:t.target.value})}));var t},autoWidth:!0,label:"tech."},n.map((function(e){return r.a.createElement(y.a,{value:e},e)})))))}(o.scoreTechs,o.idx)),r.a.createElement("td",{key:"dy"+o.idx},(c=o.scoreDyns,l=o.idx,r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"dyn-select"},"Dyn."),r.a.createElement(b.a,{labelId:"dyn-select",id:"dyn-sel"+l,value:c,onChange:function(e){return t=e,void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreDyns:t.target.value})}));var t},autoWidth:!0,label:"dyn."},["from_score","p","mf","f"].map((function(e){return r.a.createElement(y.a,{value:e},e)}))))))),r.a.createElement("td",{key:"tg"+o.idx},r.a.createElement("div",{style:{border:"1px solid lightGray",borderRadius:5,padding:8}},r.a.createElement(Z.a,{direction:"row",spacing:1,alignItems:"center"},r.a.createElement(_.a,null,"orch."),r.a.createElement($.a,{key:"tgtswitch"+o.idx,checked:o.scoreTgt,color:"secondary",onChange:function(e){return o.idx,(t=e).persist(),void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTgt:t.target.checked})}));var t}}),r.a.createElement(_.a,null,"tgt")))),r.a.createElement("td",{key:"onoff"+o.idx},r.a.createElement("div",{style:{border:"1px solid lightGray",borderRadius:5,padding:8}},r.a.createElement(Z.a,{direction:"row",spacing:1,alignItems:"center"},r.a.createElement(_.a,null,"off"),r.a.createElement($.a,{key:"onoffswitch"+o.idx,checked:o.scoreOnoff,onChange:function(e){return o.idx,(t=e).persist(),void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreOnoff:t.target.checked})}));var t}}),r.a.createElement(_.a,null,"on")))),r.a.createElement("td",{key:"mod"+o.idx},function(e,t){return r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"mod-select"},"Transpose"),r.a.createElement(b.a,{labelId:"mod-select",id:"mod-sel"+t,value:e,onChange:function(e){return t=e,void s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreModify:t.target.value})}));var t},autoWidth:!0,label:"trans."},[0,12,-12,24,-24].map((function(e){return r.a.createElement(y.a,{value:e},e)})))))}(o.scoreModify,o.idx)))}var te=n(168),ne=Object(G.a)(K.a)((function(e){var t=e.theme;return Object(d.a)(Object(d.a)({},t.typography.body2),{},{backgroundColor:"#fffef0",padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})})),ae=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={dataReady:!1,loaded:!1,cur:!1,calculIndications:!1,measureTimestamps:[],measureRange:[1,2],maxMeasure:2,instNames:[],scoreNames:[],scoreTechs:[],scoreDyns:[],scoreTgt:[],scoreOnoff:[],scoreModify:[],instData:{},open:!1,time:[],modalData:[]},a.osmd=void 0,a.orchestrationChords=void 0,a.cursor=void 0,a.next=void 0,a.show=!0,a.divRef=r.a.createRef(),a.measureHandleChange=a.measureHandleChange.bind(Object(i.a)(a)),a.calculateMasking=a.calculateMasking.bind(Object(i.a)(a)),a.update=a.update.bind(Object(i.a)(a)),a.handleClose=a.handleClose.bind(Object(i.a)(a)),a}return Object(l.a)(n,[{key:"setupOsmd",value:function(){var e=this,t={autoResize:void 0!==this.props.autoResize&&this.props.autoResize,drawTitle:void 0===this.props.drawTitle||this.props.drawTitle};this.osmd=new f.OpenSheetMusicDisplay(this.divRef.current,t),this.osmd.load(this.props.file).then((function(){var t=.5,n=e.osmd.sheet.staves.length;n>10?t=.4:n>20?t=.2:n>30?t=.1:n>40&&(t=.05),e.osmd.zoom=t;var a=[],r=[],o=[],s=[],c=[],l=[],i=[];e.osmd.sheet.staves.map((function(e){a.push(e.parentInstrument.nameLabel.text),r.push(Object(C.a)(e.parentInstrument.nameLabel.text,Object.keys(w))[0][0]),o.push("normal"),s.push("from_score"),c.push(0),l.push(1),i.push(0)})),console.log(e.osmd);var u=[];e.osmd.sheet.sourceMeasures.map((function(e){return u.push(e.absoluteTimestamp.realValue)})),u.push(999999),e.setState((function(t){t.measureRange=[1,e.osmd.sheet.SourceMeasures.length],t.maxMeasure=e.osmd.sheet.SourceMeasures.length,t.instNames=a,t.scoreNames=r,t.scoreTechs=o,t.scoreDyns=s,t.scoreTgt=c,t.scoreOnoff=l,t.scoreModify=i,t.measureTimestamps=u})),e.forceUpdate()}))}},{key:"update",value:function(){this.osmd.updateGraphic()}},{key:"renderScore",value:function(){var e=this;this.osmd.setOptions({drawFromMeasureNumber:this.state.measureRange[0],drawUpToMeasureNumber:this.state.measureRange[1]}),this.osmd.render(),this.setState((function(e){return e.loaded=!0}));for(var t=[],n=0;n<this.osmd.graphic.VerticalGraphicalStaffEntryContainers[0].StaffEntries.length;n++)t.push({0:"mf"});var a={},r={},o=[];o.length=this.state.instNames.length;for(var s=[],c=0;c<this.state.instNames.length;c++)s.push("mf");this.osmd.sheet.sourceMeasures.map((function(t){t.absoluteTimestamp.realValue<e.state.measureTimestamps[e.state.measureRange[0]-1]&&t.staffLinkedExpressions.map((function(e,t){console.log(e),e.length>0&&e.map((function(e){e.expressions.map((function(e){e.expression.dynamicEnum<=5?s[t]="p":e.expression.dynamicEnum<=7?s[t]="mf":e.expression.dynamicEnum<=13&&(s[t]="f")}))}))}))})),this.osmd.graphic.VerticalGraphicalStaffEntryContainers.map((function(n){var c=[];if(c.length=n.StaffEntries.length,n.absoluteTimestamp.realValue>=e.state.measureTimestamps[e.state.measureRange[0]-1]&&n.absoluteTimestamp.realValue<=e.state.measureTimestamps[e.state.measureRange[1]])for(var l=function(e){c[e]=[],n.StaffEntries[e]?("undefined"!==typeof n.StaffEntries[e].parentMeasure.parentStaffLine&&n.StaffEntries[e].parentMeasure.parentStaffLine.hasOwnProperty("abstractExpressions")&&n.StaffEntries[e].parentMeasure.parentStaffLine.abstractExpressions.map((function(n){n.SourceExpression.hasOwnProperty("multiExpression")&&(t[e][String(n.SourceExpression.multiExpression.AbsoluteTimestamp.realValue)]=n.Expression)})),n.StaffEntries[e].sourceStaffEntry.voiceEntries&&n.StaffEntries[e].sourceStaffEntry.voiceEntries[0].notes.map((function(a){a.halfTone>0&&(t[e].hasOwnProperty(String(n.AbsoluteTimestamp.realValue))&&(s[e]=t[e][String(n.AbsoluteTimestamp.realValue)]),r[String(n.AbsoluteTimestamp.realValue)]=n.StaffEntries[e].boundingBox.absolutePosition.x,c[e].push({note:a.halfTone,dynamic:s[e]}),o[e]={note:a.halfTone,start:n.AbsoluteTimestamp.realValue,duration:a.length.realValue})}))):o[e]&&(o[e].start+o[e].duration>=n.AbsoluteTimestamp.realValue?(t[e].hasOwnProperty(String(n.AbsoluteTimestamp.realValue))&&(s[e]=t[e][String(n.AbsoluteTimestamp.realValue)]),c[e].push({note:o[e].note,dynamic:s[e]})):o[e]=[])},i=0;i<n.StaffEntries.length;i++)l(i);a[n.AbsoluteTimestamp.realValue]=c})),this.orchestrationChords={instruments:this.state.instNames,databaseEntries:{inst:this.state.scoreNames,tech:this.state.scoreTechs,dyn:this.state.scoreDyns,tgt:this.state.scoreTgt,onoff:this.state.scoreOnoff,modify:this.state.scoreModify},dynamics:t,notes:a,xpos:r}}},{key:"resize",value:function(){}},{key:"handleClose",value:function(){this.setState((function(e){return e.open=!1}))}},{key:"measureHandleChange",value:function(e,t,n){var a=this;Array.isArray(t)&&this.setState((function(e){return Object(d.a)(Object(d.a)({},a.state),{},{measureRange:t})}))}},{key:"calculateMasking",value:function(){var e=0;function t(n){var a=this,r=this.osmd.graphic.VerticalGraphicalStaffEntryContainers[n];if(r.absoluteTimestamp.realValue>=this.state.measureTimestamps[this.state.measureRange[0]-1]&&r.absoluteTimestamp.realValue<=this.state.measureTimestamps[this.state.measureRange[1]]){var o=this.orchestrationChords.notes[r.absoluteTimestamp.realValue],s=[],c=[],l=!1;o.map((function(e,t){if(a.orchestrationChords.databaseEntries.tgt[t]&&c.push(t),e.length>0){var n=[];"from_score"!==a.orchestrationChords.databaseEntries.dyn[t]&&(n=a.orchestrationChords.databaseEntries.dyn[t]),a.orchestrationChords.databaseEntries.tgt[t]&&(l=!0),e.map((function(e){console.log(e.dynamic),console.log(["ppppp","pppp","ppp","pp","p"].includes(e.dynamic)),0===n.length&&["ppppp","pppp","ppp","pp","p"].includes(e.dynamic)?n="p":0===n.length&&["fffff","ffff","fff","ff","f","sfz","sf"].includes(e.dynamic)?n="f":0===n.length&&["mf","mp","mfz"].includes(e.dynamic)&&(n="mf"),s.push([a.orchestrationChords.databaseEntries.inst[t],a.orchestrationChords.databaseEntries.tech[t],n,e.note+12+a.orchestrationChords.databaseEntries.modify[t],a.orchestrationChords.databaseEntries.tgt[t],a.orchestrationChords.databaseEntries.onoff[t],t])}))}})),k.a.post("https://rest.score-tool.com/maskingSlice",s).then((function(e){var t=e.data,n=[];r.StaffEntries.map((function(e){return n=e.sourceStaffEntry.voiceEntries[0].notes[0]}));var o=n.parentStaffEntry.verticalContainerParent.parentMeasure.measureNumber,s=a.orchestrationChords.xpos[r.absoluteTimestamp.realValue]-1,i=a.osmd.graphic.MusicPages[0];t&&(l&&c.map((function(e){var n=a.osmd.graphic.musicSheet.sourceMeasures[o-1].verticalMeasureList[e].boundingBox.absolutePosition.y+2,r=new f.PointF2D(s,n),c=new f.PointF2D(s+2,n),l=[];l=t[0]>=75?"rgba(255,0,0,0.7)":t[0]>=55?"rgba(255,255,0,0.5)":"rgba(0,255,0,0.3)",console.log(t[0]),a.osmd.Drawer.DrawOverlayLine(r,c,i,l,4)})),t[1]&&t[1].map((function(e,t){var n=a.osmd.graphic.musicSheet.sourceMeasures[o-1].verticalMeasureList[e].boundingBox.absolutePosition.y+2,r=new f.PointF2D(s,n),c=new f.PointF2D(s+2,n),l=[];0===t?(l="rgba(255,51,255,0.5)",a.osmd.Drawer.DrawOverlayLine(r,c,i,l,4)):1===t?(l="rgba(255,153,51,0.5)",a.osmd.Drawer.DrawOverlayLine(r,c,i,l,4)):2===t&&(l="rgba(51,153,355,0.5)",a.osmd.Drawer.DrawOverlayLine(r,c,i,l,4))})))})).finally((function(){e++,a.osmd.graphic.VerticalGraphicalStaffEntryContainers.length>e&&t(e)}))}else e++,this.osmd.graphic.VerticalGraphicalStaffEntryContainers.length>e&&t(e)}(t=t.bind(this))(e),this.setState((function(e){return e.calculIndications=!0}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"componentDidUpdate",value:function(e){(this.props.drawTitle!==e.drawTitle||this.props.file!==e.file)&&this.setupOsmd();var t=!1;this.props.file&&"undefined"!==typeof this.osmd&&"undefined"!==typeof this.osmd.cursor&&(("undefined"===typeof this.osmd.cursor.hidden||this.osmd.cursor.hidden)&&(console.log(this.osmd.cursor.hidden),t=!0),this.props.show&&t&&this.osmd.cursor.show(),this.props.next!==e.next&&(this.osmd.cursor.next(),console.log(this.osmd.cursor),console.log(this.osmd.cursor.NotesUnderCursor()),console.log(this.osmd.cursor.VoicesUnderCursor()),console.log(this.osmd.cursor.iterator.currentTimeStamp.RealValue)),window.addEventListener("resize",this.resize))}},{key:"componentDidMount",value:function(){this.props.file&&this.setupOsmd()}},{key:"render",value:function(){var e=this,t=[],n="inline-block";this.state.loaded&&(n="none",t=r.a.createElement("div",null,r.a.createElement(p.a,{variant:"contained",color:"secondary",onClick:function(){e.calculateMasking()}},"calculate masking"),r.a.createElement(p.a,{style:{marginInline:10},variant:"contained",color:"warning",onClick:function(){e.renderScore()}},"redraw score (remove masking indications)"),r.a.createElement(p.a,{variant:"contained",color:"primary",onClick:function(){return te.saveSvgAsPng(document.getElementById("osmdSvgPage1"),"score.png")}},"Download the score as PNG"),r.a.createElement(_.a,{variant:"h5",style:{display:"block"}}," Click any note in score for full analysis.")));return r.a.createElement(r.a.Fragment,null,r.a.createElement(ne,{style:{textAlign:"center",justifyContent:"center",alignItems:"center",alignContent:"center",marginLeft:"auto",marginRight:"auto"}},r.a.createElement("div",null,r.a.createElement("table",{style:{margin:"auto"}},r.a.createElement("tr",null,r.a.createElement("th",null,"score name"),r.a.createElement("th",null,"instrument"),r.a.createElement("th",null,"technique"),r.a.createElement("th",null,"dynamic"),r.a.createElement("th",null,"orch/target"),r.a.createElement("th",null,"on/off"),r.a.createElement("th",null,"transpose")),this.state.instNames.map((function(t,n){return r.a.createElement(ee,{idx:n,instName:t,scoreNames:e.state.scoreNames[n],scoreTechs:e.state.scoreTechs[n],scoreDyns:e.state.scoreDyns[n],scoreTgt:e.state.scoreTgt[n],scoreOnoff:e.state.scoreOnoff[n],scoreModify:e.state.scoreModify[n],onChange:function(t){return a=n,r=t,void e.setState((function(e){e.scoreNames[a]=r.scoreNames,e.scoreTechs[a]=r.scoreTechs,e.scoreDyns[a]=r.scoreDyns,e.scoreTgt[a]=r.scoreTgt,e.scoreOnoff[a]=r.scoreOnoff,e.scoreModify[a]=r.scoreModify}));var a,r}})})))),r.a.createElement(_.a,null,"Select bar range with slider"),r.a.createElement(g.a,{value:this.state.measureRange,min:1,max:this.state.maxMeasure,step:1,marks:!0,onChange:this.measureHandleChange,valueLabelDisplay:"auto",disableSwap:!0}),r.a.createElement(p.a,{style:{display:n},variant:"contained",onClick:function(){e.renderScore()}},"Show score"),t),this.state.calculIndications&&r.a.createElement(_.a,{style:{display:"inline"}},"Color indications:",r.a.createElement("div",{style:{backgroundColor:"rgba(255,0,0,0.7)",display:"inline"}}," Target masked"),r.a.createElement("div",{style:{backgroundColor:"rgba(255,255,0,0.5)",display:"inline"}}," Target nearly masked"),r.a.createElement("div",{style:{backgroundColor:"rgba(0,255,0,0.3)",display:"inline"}}," Target audible"),r.a.createElement("div",{style:{backgroundColor:"rgba(255,51,255,0.5)",display:"inline"}}," Orchestration heaviest masker"),r.a.createElement("div",{style:{backgroundColor:"rgba(255,153,51,0.5)",display:"inline"}}," Orchestration second heaviest masker"),r.a.createElement("div",{style:{backgroundColor:"rgba(51,153,255,0.5)",display:"inline"}}," Orchestration third heaviest masker ")),r.a.createElement(ne,null,r.a.createElement("div",{ref:this.divRef,style:{width:window.innerWidth-100},onClick:function(t){var n=t.clientX,a=t.clientY,r=new f.PointF2D(n,a);r=e.osmd.graphic.domToSvg(r),r=e.osmd.graphic.svgToOsmd(r);var o=e.osmd.graphic.GetNearestNote(r,{x:15,y:15});if("undefined"!==typeof o){var s=o.sourceNote.voiceEntry.parentSourceStaffEntry.AbsoluteTimestamp.realValue;for(e.osmd.cursor.hide(),e.osmd.cursor.reset();e.osmd.cursor.iterator.currentTimeStamp.RealValue!=s;)e.osmd.cursor.next();e.osmd.cursor.show();var c=e.orchestrationChords.notes[s],l=[],i=[],u=!1;c.map((function(t,n){if(e.orchestrationChords.databaseEntries.tgt[n]&&i.push(n),t.length>0){var a=[];"from_score"!==e.orchestrationChords.databaseEntries.dyn[n]&&(a=e.orchestrationChords.databaseEntries.dyn[n]),e.orchestrationChords.databaseEntries.tgt[n]&&(u=!0),t.map((function(t){0===a.length&&["ppppp","pppp","ppp","pp","p"].includes(t.dynamic)?a="p":0===a.length&&["fffff","ffff","fff","ff","f","sfz","sf"].includes(t.dynamic)?a="f":0===a.length&&["mf","mp","mfz"].includes(t.dynamic)&&(a="mf"),l.push([e.orchestrationChords.databaseEntries.inst[n],e.orchestrationChords.databaseEntries.tech[n],a,t.note+12+e.orchestrationChords.databaseEntries.modify[n],e.orchestrationChords.databaseEntries.tgt[n],e.orchestrationChords.databaseEntries.onoff[n],n])}))}})),k.a.post("https://rest.score-tool.com/modalSlice",l).then((function(t){console.log(l);var n=t.data;console.log(n);var a=o.sourceNote.parentStaffEntry.verticalContainerParent.parentMeasure.measureNumber,r=e.orchestrationChords.xpos[String(s)]-1;e.osmd.graphic.MusicPages[0];n&&(u&&i.map((function(t){var o=e.osmd.graphic.musicSheet.sourceMeasures[a-1].verticalMeasureList[t].boundingBox.absolutePosition.y+2;new f.PointF2D(r,o),new f.PointF2D(r+2,o);n[0]>=75||n[0]})),n[1]&&n[1].map((function(t,n){var o=e.osmd.graphic.musicSheet.sourceMeasures[a-1].verticalMeasureList[t].boundingBox.absolutePosition.y+2;new f.PointF2D(r,o),new f.PointF2D(r+2,o)}))),e.setState((function(e){return e.modalData=[n,l]}))})).finally((function(){e.setState((function(e){e.open=!0,e.time=Date.now()})),e.forceUpdate()}))}}})),r.a.createElement(Q,{handleClose:this.handleClose,open:this.state.open,time:this.state.time,data:this.state.modalData}))}}]),n}(a.Component),re=n(133),oe=(n(247),{alto_flute:{normal:{f:[55,92],mf:[54,92],p:[54,80]}},alto_sax:{normal:{f:[48,81],mf:[48,81],p:[48,81]}},baritone_generic:{normal:{f:[30,66],mf:[30,66],p:[30,66]}},bassoon:{normal:{f:[33,75],mf:[33,75],p:[33,75]}},bass_cl:{normal:{f:[36,83],mf:[36,83],p:[36,83]}},bass_flute:{normal:{f:[47,86],mf:[47,83],p:[47,77]}},bass_trombone:{normal:{f:[24,66],mf:[24,68],p:[23,71]}},cello:{harmonics:{f:[36,72],mf:[36,72],p:[36,72]},normal:{f:[36,74],mf:[36,74],p:[36,74]},pizz:{f:[35,67],mf:[35,67],p:[35,67]},pizz_harmonics:{f:[47,70],mf:[47,70],p:[47,70]},sord:{f:[36,74],mf:[36,74],p:[36,74]},sord_trem:{f:[35,73],mf:[35,73],p:[35,73]},trem:{f:[36,74],mf:[36,74],p:[36,74]}},clarinet:{normal:{f:[49,95],mf:[49,96],p:[49,95]}},clarinet_eb:{normal:{f:[54,94],mf:[54,96],p:[54,93]}},crotale:{normal:{f:[83,108],p:[83,108]}},cymbal:{"13crash_bell":{f:[60,60],mf:[60,60],p:[60,60]},"13crash_bow":{mf:[60,60]},"13crash_chokecrash":{mf:[60,60]},"13crash_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"13crash_normal":{f:[60,60],mf:[60,60],p:[60,60]},"13crash_roll":{mf:[60,60]},"13crash_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"16chinese_bell":{f:[60,60],mf:[60,60],p:[60,60]},"16chinese_bow":{mf:[60,60]},"16chinese_chokecrash":{mf:[60,60]},"16chinese_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"16chinese_normal":{f:[60,60],mf:[60,60],p:[60,60]},"16chinese_roll":{mf:[60,60]},"16chinese_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"17crash_bell":{f:[60,60],mf:[60,60],p:[60,60]},"17crash_bow":{mf:[60,60]},"17crash_chokecrash":{mf:[60,60]},"17crash_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"17crash_normal":{f:[60,60],mf:[60,60],p:[60,60]},"17crash_roll":{mf:[60,60]},"17crash_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"17orchcrash":{f:[60,60],mf:[60,60],p:[60,60]},"18crash_bell":{f:[60,60]},"18crash_bow":{mf:[60,60]},"18crash_chokecrash":{mf:[60,60]},"18crash_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"18crash_normal":{f:[60,60],mf:[60,60],p:[60,60]},"18crash_roll":{mf:[60,60]},"18crash_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"18orchcrash_french":{f:[60,60],mf:[60,60],p:[60,60]},"18orchcrash_germanic":{f:[60,60],mf:[60,60],p:[60,60]},"18orchcrash_viennese":{f:[60,60],mf:[60,60],p:[60,60]},"19chinese_bell":{f:[60,60],mf:[60,60],p:[60,60]},"19chinese_bow":{mf:[60,60]},"19chinese_chokecrash":{mf:[60,60]},"19chinese_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"19chinese_normal":{f:[60,60],mf:[60,60],p:[60,60]},"19chinese_roll":{mf:[60,60]},"19chinese_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"20chinese_bell":{f:[60,60],mf:[60,60],p:[60,60]},"20chinese_bow":{mf:[60,60]},"20chinese_chokecrash":{mf:[60,60]},"20chinese_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"20chinese_normal":{f:[60,60],mf:[60,60],p:[60,60]},"20chinese_roll":{mf:[60,60]},"20chinese_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"20crash_bell":{f:[60,60],mf:[60,60],p:[60,60]},"20crash_bow":{mf:[60,60]},"20crash_chokecrash":{mf:[60,60]},"20crash_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"20crash_normal":{f:[60,60],mf:[60,60],p:[60,60]},"20crash_roll":{mf:[60,60]},"20crash_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},"21ride_bell":{f:[60,60],mf:[60,60],p:[60,60]},"21ride_mallet":{f:[60,60],mf:[60,60],p:[60,60]},"21ride_normal":{f:[60,60],mf:[60,60],p:[60,60]},"21ride_roll":{mf:[60,60]},"21ride_shoulder":{f:[60,60],mf:[60,60],p:[60,60]},hihat_bell:{f:[60,60],mf:[60,60],p:[60,60]},hihat_footclose:{f:[60,60],mf:[60,60],p:[60,60]},hihat_footsplash:{f:[60,60],mf:[60,60],p:[60,60]},hihat_normal:{f:[60,60],mf:[60,60],p:[60,60]},hihat_shoulder:{f:[60,60],mf:[60,60],p:[60,60]},normal:{f:[60,60],mf:[60,60],p:[60,60]},smallmetals:{mf:[60,60]},splash_bell:{f:[60,60],mf:[60,60],p:[60,60]},splash_mallet:{f:[60,60],mf:[60,60],p:[60,60]},splash_roll:{mf:[60,60]},splash_splash:{f:[60,60],mf:[60,60],p:[60,60]},windgong:{f:[60,60],mf:[60,60],p:[60,60]},windgong_bow:{mf:[60,60]}},double_bass:{harmonics:{f:[39,72],mf:[39,72],p:[39,72]},normal:{f:[22,61],mf:[22,61],p:[22,61]},pizz:{f:[28,51],mf:[28,51],p:[28,51]},pizz_harmonics:{f:[39,63],mf:[39,63],p:[39,63]},trem:{f:[23,61],mf:[23,61],p:[23,61]}},english_horn:{normal:{f:[51,84],mf:[51,84],p:[51,84]}},flute:{normal:{f:[58,97],mf:[58,96],p:[58,95]},vib:{f:[58,97],mf:[58,97],p:[58,95]}},guitar:{normal:{f:[39,84],mf:[39,85],p:[38,85]},normal_sulA:{f:[43,66],mf:[43,66],p:[43,66]},normal_sulB:{f:[57,80],mf:[57,80],p:[57,80]},normal_sulD:{f:[48,70],mf:[48,70],p:[48,70]},normal_sulE:{f:[38,61],mf:[38,61],p:[38,61]},normal_sulG:{f:[53,75],mf:[53,75],p:[53,75]},normal_sul_E:{f:[62,84],mf:[62,85],p:[62,85]}},harp:{normal:{f:[17,90],mf:[19,90],p:[17,90]}},horn:{normal:{f:[32,79],mf:[32,79],p:[32,78]}},oboe:{normal:{f:[57,93],mf:[57,93],p:[57,92]}},percussion_misc:{castanet:{f:[60,60],mf:[60,60],p:[60,60]},guiro_away:{f:[60,60],mf:[60,60],p:[60,60]},guiro_toward:{f:[60,60],mf:[60,60]},shakers:{mf:[60,60]}},piano:{normal:{f:[20,108],mf:[22,108],p:[21,108]}},piccolo:{normal:{f:[74,109],mf:[74,109],p:[74,109]}},solo_cello:{arco_sulA:{f:[56,83],mf:[56,82],p:[56,84]},arco_sulC:{f:[35,61],mf:[35,62],p:[35,62]},arco_sulD:{f:[49,75],mf:[49,75],p:[49,75]},arco_sulG:{f:[42,69],mf:[42,68],p:[42,68]},normal:{f:[35,83],mf:[35,82],p:[35,83]}},solo_double_bass:{arco_sulA:{f:[32,58],mf:[32,58],p:[32,58]},arco_sulD:{f:[37,63],mf:[37,63],p:[37,63]},arco_sulE:{f:[27,51],mf:[27,51],p:[27,51]},arco_sulG:{f:[42,68],mf:[42,60],p:[42,68]},normal:{f:[27,68],mf:[27,68],p:[27,68]},pizz:{f:[27,68],mf:[27,68],p:[27,68]},pizz_sulA:{f:[32,58],mf:[32,58],p:[32,58]},pizz_sulD:{f:[37,63],mf:[37,63],p:[37,63]},pizz_sulE:{f:[27,53],mf:[27,53],p:[27,53]},pizz_sulG:{f:[42,68],mf:[42,68],p:[42,68]}},solo_viola:{arco_sulA:{f:[68,93],mf:[68,93],p:[68,92]},arco_sulC:{f:[47,72],mf:[47,72],p:[47,73]},arco_sulD:{f:[61,87],mf:[61,86],p:[61,84]},arco_sulG:{f:[54,81],mf:[54,79],p:[54,79]},normal:{f:[47,93],mf:[47,93],p:[47,91]}},solo_violin:{arco_sulA:{f:[68,92],mf:[68,93],p:[68,93]},arco_sulD:{f:[61,87],mf:[61,87],p:[61,85]},arco_sulE:{f:[75,108],mf:[75,105],p:[75,107]},arco_sulG:{f:[54,79],mf:[54,80],p:[54,78]},normal:{f:[54,108],mf:[54,105],p:[54,107]}},soprano_generic:{normal:{f:[59,82],mf:[59,82],p:[65,87]}},soprano_sax:{normal:{f:[55,88],mf:[55,88],p:[55,88]},normal_Vib:{f:[55,88],mf:[55,88],p:[55,88]}},tambourine:{normal:{f:[60,60],mf:[60,60],p:[60,60]},normal_fingerroll:{f:[60,60],mf:[60,60],p:[60,60]},normal_sforzando:{mf:[60,60]},normal_shakeroll:{f:[60,60],mf:[60,60],p:[60,60]},normal_thumbroll:{f:[60,60],mf:[60,60],p:[60,60]}},tamtam:{bow:{mf:[60,60]},normal:{f:[60,60],mf:[60,60],p:[60,60]}},tamtam_22:{bow:{mf:[60,60]},normal:{f:[60,60],mf:[60,60],p:[60,60]}},tamtam_40:{bow:{mf:[60,60]},normal:{f:[60,60],mf:[60,60],p:[60,60]}},TenorTrombone:{normal:{f:[39,73],mf:[39,73],p:[39,73]}},tenor_generic:{normal:{f:[49,72],mf:[49,72],p:[49,71]}},thaigong:{normal:{f:[59,73],mf:[59,73],p:[59,73]}},triangle_6:{normal:{f:[60,60],mf:[60,60],p:[60,60]},normal_roll:{f:[60,60],mf:[60,60],p:[60,60]}},triangle_8:{normal:{f:[60,60],mf:[60,60],p:[60,60]},normal_roll:{f:[60,60],mf:[60,60],p:[60,60]}},trumpet:{normal:{f:[51,88],mf:[51,87],p:[51,88]},vib:{f:[51,87],mf:[51,87],p:[51,87]}},tuba:{normal:{f:[23,61],mf:[23,61],p:[23,61]}},vibraphone:{normal:{f:[47,91],mf:[47,90],p:[47,90]},normal_bow:{mf:[47,90]}},viola:{harmonics:{f:[66,88],mf:[66,88],p:[66,88]},normal:{f:[48,86],mf:[48,86],p:[48,86]},pizz:{f:[47,85],mf:[47,85],p:[47,85]},sord:{f:[48,86],mf:[48,86],p:[48,86]},sord_trem:{f:[47,85],mf:[47,85],p:[47,85]},trem:{f:[47,85],mf:[47,85],p:[47,85]}},violin:{harmonics:{f:[66,104],mf:[66,104],p:[66,104]},normal:{f:[54,97],mf:[55,96],p:[55,96]},pizz:{f:[54,96],mf:[54,96],p:[54,96]},sord:{f:[55,93],mf:[55,93],p:[55,93]},sord_trem:{f:[55,96],mf:[55,96],p:[55,96]},tremolo:{f:[54,96],mf:[54,96],p:[55,96]}},woodblock:{clave:{f:[60,60],mf:[60,60],p:[60,60]},graniteblock:{f:[60,60],mf:[60,60],p:[60,60]},normal:{f:[60,60],mf:[60,60],p:[60,60]}},xylophone:{gliss_down:{mf:[59,60]},gliss_up:{mf:[60,60]},normal:{f:[64,108],mf:[64,108],p:[64,108]},normal_hardrubber:{f:[64,108],mf:[64,108],p:[64,108]}},tenor_trombone:{normal:{f:[39,73],mf:[39,73],p:[39,73]}},timp:{normal:{f:[37,61],mf:[37,61],p:[37,57]}}}),se=n(300),ce=n(287),le=n(174),ie=n(46),ue=n.n(ie),me=n(78),de=n.n(me),he=n(60),fe=n.n(he),pe=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],ge=["Db","Eb","Gb","Ab","Bb"],be={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11},ve=/([a-g])([#b]?)(\d+)/;var ye=fe()(12,128).reduce((function(e,t){return e[t]=function(e){var t=(e-12)%12,n=Math.floor((e-12)/12),a=pe[t];return{note:"".concat(a).concat(n),pitchName:a,octave:n,midiNumber:e,isAccidental:ge.includes(a)}}(t),e}),{});function Ee(e){var t=ye[e];if(!t)throw Error("Invalid MIDI number");return t}var _e=fe()(12,128).filter((function(e){return!Ee(e).isAccidental})),Oe={fromNote:function(e){if(!e)throw Error("Invalid note argument");var t=ve.exec(e.toLowerCase());if(!t)throw Error("Invalid note argument");var n=Object(j.a)(t,4),a=n[1],r=n[2],o=n[3],s="".concat(a.toUpperCase()).concat(r),c=be[s];if(null==c)throw Error("Invalid note argument");return 12+c+12*parseInt(o,10)},getAttributes:Ee,MIN_MIDI_NUMBER:12,MAX_MIDI_NUMBER:127,NATURAL_MIDI_NUMBERS:_e},ke=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onPlayNoteInput=function(){e.props.onPlayNoteInput(e.props.midiNumber)},e.onStopNoteInput=function(){e.props.onStopNoteInput(e.props.midiNumber)},e.onLeaveNote=function(){e.props.onLeaveNote(e.props.midiNumber)},e}return Object(l.a)(n,[{key:"getAbsoluteKeyPosition",value:function(e){var t=Oe.getAttributes(e),n=t.octave,a=t.pitchName;return this.props.pitchPositions[a]+7*n}},{key:"getRelativeKeyPosition",value:function(e){return this.getAbsoluteKeyPosition(e)-this.getAbsoluteKeyPosition(this.props.noteRange.first)}},{key:"render",value:function(){var e=this.props,t=e.naturalKeyWidth,n=e.accidentalWidthRatio,a=e.midiNumber,o=e.gliss,s=e.useTouchEvents,c=e.accidental,l=e.active,i=e.disabled,u=e.children;return r.a.createElement("div",{className:ue()("ReactPiano__Key",{"ReactPiano__Key--accidental":c,"ReactPiano__Key--natural":!c,"ReactPiano__Key--disabled":i,"ReactPiano__Key--active":l}),style:{left:Ce(this.getRelativeKeyPosition(a)*t),width:Ce(c?n*t:t)},onMouseDown:s?null:this.onPlayNoteInput,onMouseUp:s?null:this.onStopNoteInput,onMouseEnter:null,onMouseLeave:o?this.onStopNoteInput:null,onTouchStart:s?this.onPlayNoteInput:null,onTouchCancel:s?this.onStopNoteInput:null,onTouchEnd:s?this.onStopNoteInput:null},r.a.createElement("div",{className:"ReactPiano__NoteLabelContainer"},u))}}]),n}(r.a.Component);function Ce(e){return"".concat(100*e,"%")}ke.defaultProps={accidentalWidthRatio:.65,pitchPositions:{C:0,Db:.55,D:1,Eb:1.8,E:2,F:3,Gb:3.5,G:4,Ab:4.7,A:5,Bb:5.85,B:6}};var we=ke,xe=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getMidiNumbers",value:function(){return fe()(this.props.noteRange.first,this.props.noteRange.last+1)}},{key:"getNaturalKeyCount",value:function(){return this.getMidiNumbers().filter((function(e){return!Oe.getAttributes(e).isAccidental})).length}},{key:"getNaturalKeyWidth",value:function(){return 1/this.getNaturalKeyCount()}},{key:"getWidth",value:function(){return this.props.width?this.props.width:"100%"}},{key:"getHeight",value:function(){if(!this.props.width)return"100%";var e=this.props.width*this.getNaturalKeyWidth();return"".concat(e/this.props.keyWidthToHeight,"px")}},{key:"render",value:function(){var e=this,t=this.getNaturalKeyWidth();return r.a.createElement("div",{className:ue()("ReactPiano__Keyboard",this.props.className),style:{width:this.getWidth(),height:this.getHeight()}},this.getMidiNumbers().map((function(n){var a=Oe.getAttributes(n),o=(a.note,a.isAccidental),s=!e.props.disabled&&e.props.activeNotes.includes(n);return r.a.createElement(we,{naturalKeyWidth:t,midiNumber:n,noteRange:e.props.noteRange,active:s,accidental:o,disabled:e.props.disabled,onPlayNoteInput:e.props.onPlayNoteInput,onStopNoteInput:e.props.onStopNoteInput,onLeaveNote:e.props.onLeaveNote,gliss:e.props.gliss,useTouchEvents:e.props.useTouchEvents,key:n},e.props.disabled?null:e.props.renderNoteLabel({isActive:s,isAccidental:o,midiNumber:n}))})))}}]),n}(r.a.Component);xe.defaultProps={disabled:!1,gliss:!1,useTouchEvents:!1,keyWidthToHeight:.33,renderNoteLabel:function(){}};var je=xe,Se=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isMouseDown:!1,useTouchEvents:!1},e.handleNoteChanges=function(t){var n=t.prevActiveNotes,a=t.nextActiveNotes;if(!e.props.disabled){var r=de()(n,a);de()(a,n).forEach((function(t){e.props.playNote(t)})),r.forEach((function(t){e.props.stopNote(t)}))}},e.getMidiNumberForKey=function(t){if(!e.props.keyboardShortcuts)return null;var n=e.props.keyboardShortcuts.find((function(e){return e.key===t}));return n&&n.midiNumber},e.getKeyForMidiNumber=function(t){if(!e.props.keyboardShortcuts)return null;var n=e.props.keyboardShortcuts.find((function(e){return e.midiNumber===t}));return n&&n.key},e.onKeyDown=function(t){if(!(t.ctrlKey||t.metaKey||t.shiftKey)){var n=e.getMidiNumberForKey(t.key);n&&e.onPlayNoteInput(n)}},e.onKeyUp=function(t){var n=e.getMidiNumberForKey(t.key);n&&e.onStopNoteInput(n)},e.onPlayNoteInput=function(t){e.props.disabled||e.props.onPlayNoteInput(t,e.props.activeNotes)},e.onStopNoteInput=function(t){e.props.disabled||e.props.onStopNoteInput(t,e.props.activeNotes)},e.onLeaveNote=function(t){e.props.disabled||e.props.onLeaveNote(t,e.props.activeNotes)},e.onMouseDown=function(){e.setState({isMouseDown:!0})},e.onMouseUp=function(){e.setState({isMouseDown:!1})},e.onTouchStart=function(){e.setState({useTouchEvents:!0})},e.renderNoteLabel=function(t){var n=t.midiNumber,a=t.isActive,r=t.isAccidental,o=e.getKeyForMidiNumber(n);return e.props.renderNoteLabel({keyboardShortcut:o,midiNumber:n,isActive:a,isAccidental:r})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}},{key:"componentDidUpdate",value:function(e,t){this.props.activeNotes!==e.activeNotes&&this.handleNoteChanges({prevActiveNotes:e.activeNotes||[],nextActiveNotes:this.props.activeNotes||[]})}},{key:"render",value:function(){return r.a.createElement("div",{style:{width:"100%",height:"100%"},onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchStart:this.onTouchStart,"data-testid":"container"},r.a.createElement(je,{noteRange:this.props.noteRange,onPlayNoteInput:this.onPlayNoteInput,onStopNoteInput:this.onStopNoteInput,onLeaveNote:this.onLeaveNote,activeNotes:this.props.activeNotes,className:this.props.className,disabled:this.props.disabled,width:this.props.width,keyWidthToHeight:this.props.keyWidthToHeight,gliss:this.state.isMouseDown,useTouchEvents:this.state.useTouchEvents,renderNoteLabel:this.renderNoteLabel}))}}]),n}(r.a.Component);Se.defaultProps={renderNoteLabel:function(e){var t=e.keyboardShortcut,n=(e.midiNumber,e.isActive),a=e.isAccidental;return t?r.a.createElement("div",{className:ue()("ReactPiano__NoteLabel",{"ReactPiano__NoteLabel--active":n,"ReactPiano__NoteLabel--accidental":a,"ReactPiano__NoteLabel--natural":!a})},t):null}};var Ne=Se,Te=["activeNotes","onPlayNoteInput","onStopNoteInput"],Ie=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={activeNotes:e.props.activeNotes||[]},e.handlePlayNoteInput=function(t){e.setState((function(n){return e.props.onPlayNoteInput&&e.props.onPlayNoteInput(t,{prevActiveNotes:n.activeNotes}),n.activeNotes.includes(t)?null:{activeNotes:n.activeNotes.concat(t)}}))},e.handleStopNoteInput=function(t){e.setState((function(n){return e.props.onStopNoteInput&&e.props.onStopNoteInput(t),{activeNotes:n.activeNotes.filter((function(e){return t!==e}))}}))},e.handleLeave=function(t){e.setState((function(e){return{activeNotes:e.activeNotes.filter((function(e){return t!==e}))}}))},e}return Object(l.a)(n,[{key:"componentDidUpdate",value:function(e){e.activeNotes!==this.props.activeNotes&&this.state.activeNotes!==this.props.activeNotes&&this.setState({activeNotes:this.props.activeNotes||[]})}},{key:"render",value:function(){var e=this.props,t=(e.activeNotes,e.onPlayNoteInput,e.onStopNoteInput,Object(le.a)(e,Te));return r.a.createElement(Ne,Object.assign({activeNotes:this.state.activeNotes,onLeaveNote:this.handleLeave,onPlayNoteInput:this.handlePlayNoteInput,onStopNoteInput:this.handleStopNoteInput},t))}}]),n}(r.a.Component),Ae=(n(161),n(67)),De=L.a.Flow,Pe=function(e){var t=e.note;return r.a.createElement("div",{ref:function(e){if(e){for(var n=e;n.hasChildNodes();)n.removeChild(n.lastChild);var a=new De.Renderer(n,De.Renderer.Backends.SVG);a.resize(100,100);var r=a.getContext();r.scale(.5,.5);var o=new Ae.a(20,40,150);o.setContext(r);var s=t.filter((function(e,t,n){return parseInt(e.slice(-1))<4})),c=t.filter((function(e,t,n){return parseInt(e.slice(-1))>=4})),l="treble";s.length>c.length&&(l="bass"),o.setClef(l);var i=[],u=[];if(t.map((function(e){var t=e.slice(0,-1)+"/"+e.slice(-1),n=e.slice(-2,-1);"#"!=n&&(n="n"),i.push(t),u.push(n)})),0===t.length)o.draw();else{var m=new De.StaveNote({clef:l,keys:i,duration:"4"});u.map((function(e,t){return m.addAccidental(t,new De.Accidental(e))}));var d=new De.Voice({num_beats:1,beat_value:4});d.addTickables([m]),o.draw();(new De.Formatter).joinVoices([d]).formatToStave([d],o);d.draw(r,o)}}}})};function Me(e){var t=Object(a.useState)({idx:e.data[6],scoreNames:e.data[0],scoreTechs:e.data[1],scoreDyns:e.data[2],scorePitch:e.data[3],scoreTgt:e.data[4],scoreOnoff:e.data[5],scoreIdx:e.data[6],scoreModify:0,popOpen:!1,anchorEl:null}),n=Object(j.a)(t,2),o=n[0],s=n[1],c=["C","C#","D","D#","E","F","F#","G","G#","A","Bb","B"];function l(e){return c[e%12]+(Math.floor(e/12)-1)}var i,u,m=function(e){var t=e.currentTarget;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{popOpen:!e.popOpen,anchorEl:t})}))},h=function(){s((function(e){return Object(d.a)(Object(d.a)({},e),{},{anchorEl:null,popOpen:!1})})),e.onChange([o.scoreNames,o.scoreTechs,o.scoreDyns,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])};o.scorePitch.map((function(e){return l(e)}));return r.a.createElement("tr",null,r.a.createElement("td",{key:"nam"+o.idx},o.instName),r.a.createElement("td",{key:"scor"+o.idx},function(t,n){var a=Object.keys(oe);return r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"instrument-select"},"Instr."),r.a.createElement(b.a,{labelId:"instrument-select",id:"instrument-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{popOpen:!1})})),s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreNames:a,scoreTechs:"normal",scoreDyns:"mf"})})),e.onChange([a,"normal","mf",o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])}(0,t)},autoWidth:!0,label:"instr."},a.map((function(e){return r.a.createElement(y.a,{value:e},e)})))))}(o.scoreNames,o.idx)),r.a.createElement("td",{key:"tec"+o.idx},function(t,n){var a=Object.keys(oe[o.scoreNames]);return r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"tech-select"},"Tech."),r.a.createElement(b.a,{labelId:"tech-select",id:"tech-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTechs:a})})),e.onChange([o.scoreNames,a,o.scoreDyns,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])}(0,t)},autoWidth:!0,label:"tech."},a.map((function(e){return r.a.createElement(y.a,{value:e},e)})))))}(o.scoreTechs,o.idx)),r.a.createElement("td",{key:"dy"+o.idx},function(t,n){var a=Object.keys(oe[o.scoreNames][o.scoreTechs]);return r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"dyn-select"},"Dyn."),r.a.createElement(b.a,{labelId:"dyn-select",id:"dyn-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreDyns:a})})),e.onChange([o.scoreNames,o.scoreTechs,a,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])}(0,t)},autoWidth:!0,label:"dyn."},a.map((function(e){return r.a.createElement(y.a,{value:e},e)})))))}(o.scoreDyns,o.idx)),r.a.createElement("td",{key:"pi"+o.idx},function(e,t){var n=[oe[o.scoreNames][o.scoreTechs][o.scoreDyns][0],oe[o.scoreNames][o.scoreTechs][o.scoreDyns][oe[o.scoreNames][o.scoreTechs][o.scoreDyns].length-1]];return r.a.createElement("div",null,r.a.createElement("div",{"aria-describedby":t,onClick:m},r.a.createElement(Pe,{note:o.scorePitch.map((function(e){return l(e)}))})),r.a.createElement(se.a,{id:t,open:o.popOpen,anchorEl:o.anchorEl,onClose:h,style:{zIndex:1e4},anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"}},r.a.createElement(ce.a,{sx:{border:1,p:1,bgcolor:"white"}},r.a.createElement(Ie,{noteRange:{first:n[0],last:n[1]},activeNotes:o.scorePitch,playNote:function(e){},stopNote:function(e){var t=Object(x.a)(o.scorePitch);if(t.includes(e)){var n=t.filter((function(t,n,a){return t!=e}));s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scorePitch:n})}))}else t.push(e),s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scorePitch:t})}))},width:400}))))}(o.scorePitch,"pi"+o.idx)),r.a.createElement("td",null," ",r.a.createElement(p.a,{variant:"outlined",color:"warning",onClick:function(){s((function(e){return Object(d.a)(Object(d.a)({},e),{},{popOpen:!1})})),s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scorePitch:[]})})),e.onChange([o.scoreNames,o.scoreTechs,o.scoreDyns,[],o.scoreTgt,o.scoreOnoff,o.scoreIdx])},size:"small"}," clear notes ")),r.a.createElement("td",{key:"tg"+o.idx},r.a.createElement("div",{style:{border:"1px solid lightGray",borderRadius:5,padding:8}},r.a.createElement(Z.a,{direction:"row",spacing:1,alignItems:"center"},r.a.createElement(_.a,null,"orch."),r.a.createElement($.a,{key:"tgtswitch"+o.idx,checked:o.scoreTgt,color:"secondary",onChange:function(t){return function(t,n){var a=n.target.checked;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTgt:a})})),e.onChange([o.scoreNames,o.scoreTechs,o.scoreDyns,o.scorePitch,a,o.scoreOnoff,o.scoreIdx])}(o.idx,t)}}),r.a.createElement(_.a,null,"tgt")))),r.a.createElement("td",{key:"onoff"+o.idx},r.a.createElement("div",{style:{border:"1px solid lightGray",borderRadius:5,padding:8}},r.a.createElement(Z.a,{direction:"row",spacing:1,alignItems:"center"},r.a.createElement(_.a,null,"off"),r.a.createElement($.a,{key:"onoffswitch"+o.idx,checked:o.scoreOnoff,onChange:function(t){return function(t,n){var a=n.target.checked;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreOnoff:a})})),e.onChange([o.scoreNames,o.scoreTechs,o.scoreDyns,o.scorePitch,o.scoreTgt,a,o.scoreIdx])}(o.idx,t)}}),r.a.createElement(_.a,null,"on")))),r.a.createElement("td",{key:"mod"+o.idx},(i=o.scoreModify,u=o.idx,r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"mod-select"},"Transpose"),r.a.createElement(b.a,{labelId:"mod-select",id:"mod-sel"+u,value:i,onChange:function(t){return function(t,n){var a=n.target.value,r=o.scorePitch.map((function(e){return e+a>=oe[o.scoreNames][o.scoreTechs][o.scoreDyns][0]&&e+a<=oe[o.scoreNames][o.scoreTechs][o.scoreDyns][1]?e+a:null}));r=r.filter((function(e,t,n){return null!=e})),console.log(r),s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scorePitch:r,scoreModify:0})})),e.onChange([o.scoreNames,o.scoreTechs,o.scoreDyns,r,o.scoreTgt,o.scoreOnoff,o.scoreIdx])}(0,t)},autoWidth:!0,label:"trans."},[0,12,-12,24,-24].map((function(e){return r.a.createElement(y.a,{value:e},e)}))))))),r.a.createElement("td",null," ",r.a.createElement(p.a,{variant:"outlined",color:"warning",onClick:function(t){return e.onDelete(o.scoreIdx)},size:"small"}," delete ")))}var Le=n(140),ze=n(304),Re=Object(Le.a)({palette:{neutral:{main:"#dcc4ac",contrastText:"#black"}}});function Fe(e){var t=Object(a.useState)({instList:[],listenList:[],data:[],selected:null,saved:!1,textFieldValue:"Chord Editor orchestration "+JSON.parse(localStorage.getItem("orchestrations")).length}),n=Object(j.a)(t,2),r=n[0],o=n[1];a.useEffect((function(){if(null!=sessionStorage.getItem("LastChord")){var e=JSON.parse(sessionStorage.getItem("LastChord"));o((function(t){return Object(d.a)(Object(d.a)({},t),{},{instList:e})})),s(e)}}),[]);var s=function(e){var t=[],n=0;e.map((function(e,a){e[3].map((function(a){t.push([e[0],e[1],e[2],a,e[4],e[5],n]),n+=1}))})),k.a.post("https://rest.score-tool.com/modalSlice",t).then((function(e){var n=e.data;o((function(e){return Object(d.a)(Object(d.a)({},e),{},{data:n.data,listenList:t})}))}))},c=function(e){e.persist();var t=e.target.textContent.toLowerCase(),n=Object(x.a)(r.instList),a="normal";"percussion_misc"===t&&(a="castanet");var s=[];oe[t][a].mf[0]===oe[t][a].mf[1]&&(s=[oe[t][a].mf[0]]),0===n.length?n.push([t,a,"mf",s,!1,!0,0]):n.push([t,a,"mf",s,!1,!0,n[n.length-1][6]+1]),console.log(n),o((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n})}))},l=function(e){var t=r.instList.filter((function(t,n,a){return t[6]!=e}));o((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:t})})),s(t)};return a.createElement(a.Fragment,null,a.createElement(ze.a,{theme:Re},a.createElement(p.a,{variant:"contained",color:"warning",onClick:function(){o((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:[],listenList:[],data:[],selected:null,saved:!1})}))}}," Clear all instruments "),a.createElement(_.a,{style:{textAlign:"center"}}," Select orchestration from your saved orchestrations  "),a.createElement(E.a,{sx:{m:1,minWidth:50}},a.createElement(v.a,{id:"orchestration-select"},"Orchestrations"),a.createElement(b.a,{labelId:"orchestration-select",id:"orchestration-select1",value:r.selected,onChange:function(e){var t=e.target.value,n=JSON.parse(localStorage.getItem("orchestrations")).filter((function(e,n,a){return e.id===t}))[0].data.map((function(e,t){return[e[0],e[1],e[2],e[3],e[4],e[5],t]}));o((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n,selected:t})})),s(n)},autoWidth:!0,label:"orch."},null===localStorage.getItem("orchestrations")?null:JSON.parse(localStorage.getItem("orchestrations")).map((function(e){return a.createElement(y.a,{value:e.id},e.name)})))),a.createElement(_.a,{style:{textAlign:"center"}}," or/and  "),a.createElement(_.a,{style:{textAlign:"center"}}," Click below to add instrument to orchestration  "),a.createElement("table",null,a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,"Woodwinds"),a.createElement("td",null,"Brass"),a.createElement("td",null,"Strings"),a.createElement("td",null,"Percussion"),a.createElement("td",null,"Various")),a.createElement("tr",null,a.createElement("td",null,["piccolo","flute","alto_flute","bass_flute","oboe","english_horn","clarinet","clarinet_eb","bass_cl","bassoon"].map((function(e){return a.createElement(p.a,{variant:"contained",onClick:c,color:"neutral",size:"small"},e)}))),a.createElement("td",null,["trumpet","horn","tenor_trombone","bass_trombone","soprano_sax","alto_sax"].map((function(e){return a.createElement(p.a,{variant:"contained",onClick:c,color:"neutral",size:"small"},e)}))),a.createElement("td",null,["violin","viola","cello","double_bass","solo_violin","solo_viola","solo_cello","solo_double_bass"].map((function(e){return a.createElement(p.a,{variant:"contained",onClick:c,color:"neutral",size:"small"},e)}))),a.createElement("td",null,["crotale","cymbal","percussion_misc","tambourine","tamtam","tamtam_22","tamtam_40","thaigong","triangle_6","triangle_8","vibraphone","woodblock","xylophone","timp"].map((function(e){return a.createElement(p.a,{variant:"contained",onClick:c,color:"neutral",size:"small"},e)}))),a.createElement("td",null,["piano","harp","guitar","soprano_generic","tenor_generic","baritone_generic"].map((function(e){return a.createElement(p.a,{variant:"contained",onClick:c,color:"neutral",size:"small"},e)}))))))),a.createElement("div",{style:{zoom:1}},a.createElement("table",null,r.instList.map((function(e,t){return a.createElement(Me,{key:e[0]+t,data:e,onChange:function(e){return function(e,t){var n=Object(x.a)(r.instList);n[e]=t,o((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n,saved:!1})})),sessionStorage.setItem("LastChord",JSON.stringify(n)),s(n)}(t,e)},onDelete:l,idx:"fgfg"+t})})))),a.createElement(ze.a,{theme:Re},a.createElement(p.a,{variant:"contained",color:"neutral",onClick:function(){return s(r.instList)},style:{display:"none"}}," Click to update graphs "),a.createElement(q,{text:r.textFieldValue,orchestration:r.instList})),a.createElement(U,{data:r.data}),a.createElement(J,{instrumentList:r.listenList}))}var Ve=a.forwardRef((function(e,t){return a.createElement(D.a,Object.assign({direction:"up",ref:t},e))}));function We(e){var t=a.useState(!1),n=Object(j.a)(t,2),r=n[0],o=n[1];return a.useEffect((function(){o((function(t){return e.open}))}),[e]),a.createElement("div",null,a.createElement(S.a,{fullScreen:!0,open:r,onClose:e.handleClose,TransitionComponent:Ve,PaperProps:{style:{backgroundColor:"#fffef0"}}},a.createElement(T.a,{sx:{position:"relative",backgroundColor:"#dcc4ac",color:"#4c4c48"}},a.createElement(I.a,null,a.createElement(A.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},a.createElement("div",null,"Click here, or press ESC to close Chord Editor")))),a.createElement(Fe,null)))}function Ge(e){var t=Object(a.useState)({idx:e.data[6],scoreNames:e.data[0],scoreTechs:e.data[1],scoreDyns:e.data[2],scorePitch:e.data[3],scoreTgt:e.data[4],scoreOnoff:e.data[5],scoreIdx:e.data[6],scoreModify:0,popOpen:!1,anchorEl:null}),n=Object(j.a)(t,2),o=n[0],s=n[1],c=["C","C#","D","D#","E","F","F#","G","G#","A","Bb","B"];var l,i,u=function(e){var t=e.currentTarget;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{popOpen:!e.popOpen,anchorEl:t})}))},m=function(){s((function(e){return Object(d.a)(Object(d.a)({},e),{},{anchorEl:null,popOpen:!1})})),e.onChange([o.scoreNames,o.scoreTechs,o.scoreDyns,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])};return r.a.createElement("tr",null,r.a.createElement("td",{key:"nam"+o.idx},o.instName),r.a.createElement("td",{key:"scor"+o.idx},function(t,n){var a=Object.keys(oe);return r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"instrument-select"},"Instr."),r.a.createElement(b.a,{labelId:"instrument-select",id:"instrument-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{popOpen:!1})})),s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreNames:a,scoreTechs:"normal",scoreDyns:"mf"})})),e.onChange([a,"normal","mf",o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])}(0,t)},autoWidth:!0,label:"instr."},a.map((function(e){return r.a.createElement(y.a,{value:e},e)})))))}(o.scoreNames,o.idx)),r.a.createElement("td",{key:"tec"+o.idx},function(t,n){var a=Object.keys(oe[o.scoreNames]);return r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"tech-select"},"Tech."),r.a.createElement(b.a,{labelId:"tech-select",id:"tech-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreTechs:a})})),e.onChange([o.scoreNames,a,o.scoreDyns,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])}(0,t)},autoWidth:!0,label:"tech."},a.map((function(e){return r.a.createElement(y.a,{value:e},e)})))))}(o.scoreTechs,o.idx)),r.a.createElement("td",{key:"dy"+o.idx},function(t,n){var a=Object.keys(oe[o.scoreNames][o.scoreTechs]);return r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"dyn-select"},"Dyn."),r.a.createElement(b.a,{labelId:"dyn-select",id:"dyn-sel"+n,value:t,onChange:function(t){return function(t,n){var a=n.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scoreDyns:a})})),e.onChange([o.scoreNames,o.scoreTechs,a,o.scorePitch,o.scoreTgt,o.scoreOnoff,o.scoreIdx])}(0,t)},autoWidth:!0,label:"dyn."},a.map((function(e){return r.a.createElement(y.a,{value:e},e)})))))}(o.scoreDyns,o.idx)),r.a.createElement("td",{key:"pi"+o.idx},function(e,t){var n,a=[oe[o.scoreNames][o.scoreTechs][o.scoreDyns][0],oe[o.scoreNames][o.scoreTechs][o.scoreDyns][oe[o.scoreNames][o.scoreTechs][o.scoreDyns].length-1]];return r.a.createElement("div",null,r.a.createElement("div",{"aria-describedby":t,onClick:u},r.a.createElement(Pe,{note:[(n=o.scorePitch,c[n%12]+(Math.floor(n/12)-1))]})),r.a.createElement(se.a,{id:t,open:o.popOpen,anchorEl:o.anchorEl,onClose:m,style:{zIndex:1e4},anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"center",horizontal:"right"}},r.a.createElement(ce.a,{sx:{border:1,p:1,bgcolor:"white"}},r.a.createElement(re.a,{noteRange:{first:a[0],last:a[1]},activeNotes:[o.scorePitch],playNote:function(e){s((function(t){return Object(d.a)(Object(d.a)({},t),{},{scorePitch:e})}))},stopNote:function(e){},width:400}))))}(o.scorePitch,"pi"+o.idx)),r.a.createElement("td",{key:"mod"+o.idx},(l=o.scoreModify,i=o.idx,r.a.createElement("div",null,r.a.createElement(E.a,{sx:{m:1,minWidth:50}},r.a.createElement(v.a,{id:"mod-select"},"Transpose"),r.a.createElement(b.a,{labelId:"mod-select",id:"mod-sel"+i,value:l,onChange:function(e){return function(e,t){var n=t.target.value;s((function(e){return Object(d.a)(Object(d.a)({},e),{},{scorePitch:e.scorePitch+n,scoreModify:0})}))}(0,e)},autoWidth:!0,label:"trans."},[0,12,-12,24,-24].map((function(e){return r.a.createElement(y.a,{value:e},e)}))))))))}var Ke=Object(G.a)(K.a)((function(e){var t=e.theme;return Object(d.a)(Object(d.a)({},t.typography.body2),{},{backgroundColor:"#fffef0",padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})}));function Be(e){var t=e.data;return t.length<2?null:a.createElement("div",null,a.createElement(W.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:.5},a.createElement(W.a,{item:!0,xs:6,md:6},a.createElement(Ke,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(_.a,null,"Overtone structure of ",t[3].instruments[0]),a.createElement(R,{notes:t[1].notes,instruments:t[1].instruments,target:t[1].target,target_color:"red",width:200,text_space:200}))),a.createElement(W.a,{item:!0,xs:6,md:6},a.createElement(Ke,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(_.a,null,"Overtone structure of ",t[3].instruments[1]),a.createElement(R,{notes:t[2].notes,instruments:t[2].instruments,target:t[2].target,target_color:"red",width:200,text_space:200}))),a.createElement(W.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:.5},a.createElement(W.a,{item:!0,xs:6,md:6},a.createElement(Ke,{style:{height:452,backgroundColor:"#fffef0"}},a.createElement(_.a,null,"Spectral centroids"),a.createElement(R,{notes:t[3].notes,instruments:t[3].instruments,target:[],width:150,text_space:200}))),a.createElement(W.a,{item:!0,xs:6,md:6},a.createElement(Ke,null,a.createElement(M.a,{data:t[0][1].data,layout:Object(d.a)(Object(d.a)({},t[0][1].layout),{},{width:window.innerWidth/2-50}),config:{displayModeBar:!1},width:200}))))),a.createElement(W.a,{style:{marginTop:.5},container:!0,direction:"row",justifyContent:"left",alignItems:"left",spacing:.5},a.createElement(W.a,{item:!0,xs:12,md:12},a.createElement(Ke,null,a.createElement(M.a,{data:t[0][0].data,layout:Object(d.a)(Object(d.a)({},t[0][0].layout),{},{width:window.innerWidth-50}),config:{displayModeBar:!1}})))))}Object(G.a)(K.a)((function(e){var t=e.theme;return Object(d.a)(Object(d.a)({},t.typography.body2),{},{backgroundColor:"#fffef0",padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})}));var Ue=Object(Le.a)({palette:{neutral:{main:"#dcc4ac",contrastText:"#black"}}}),He=a.forwardRef((function(e,t){return a.createElement(D.a,Object.assign({direction:"up",ref:t},e))}));function Je(e){var t=a.useState(!1),n=Object(j.a)(t,2),r=n[0],o=n[1],s=a.useState([["flute","normal","mf",60,0,1,0],["flute","normal","mf",60,0,1,1]]),c=Object(j.a)(s,2),l=c[0],i=c[1],u=a.useState([]),m=Object(j.a)(u,2),d=m[0],h=m[1];a.useEffect((function(){o((function(t){return e.open}))}),[e]),a.useEffect((function(){if(null!=sessionStorage.getItem("LastCompare")){var e=JSON.parse(sessionStorage.getItem("LastCompare"));i((function(){return e})),g(e)}}),[]);var f=function(e){var t=Object(x.a)(l);t[e[6]]=e,i((function(){return t})),sessionStorage.setItem("LastCompare",JSON.stringify(t)),g(t)},g=function(e){var t=[];e.map((function(e){t.push([e[0],e[1],e[2],e[3]])})),k.a.post("https://rest.score-tool.com/compare",t).then((function(e){var t=e.data;h((function(){return t}))}))};return a.createElement("div",null,a.createElement(S.a,{fullScreen:!0,open:r,onClose:e.handleClose,TransitionComponent:He,PaperProps:{style:{backgroundColor:"#fffef0"}}},a.createElement(T.a,{sx:{position:"relative",backgroundColor:"#dcc4ac",color:"#4c4c48"}},a.createElement(I.a,null,a.createElement(A.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},a.createElement("div",null,"Click here, or press ESC to close Compare Editor")))),a.createElement(_.a,{style:{textAlign:"center"}},"Compare two instrument timbres. Select instruments to compare below."),a.createElement("table",{style:{marginInline:"20vw"}},a.createElement("tbody",null,a.createElement(Ge,{data:l[0],onChange:f}),a.createElement(Ge,{data:l[1],onChange:f}))),a.createElement(ze.a,{theme:Ue},a.createElement(p.a,{variant:"contained",color:"neutral",onClick:function(){return g(l)},style:{display:"none"}}," Click to compare")),a.createElement(Be,{data:d})))}var qe=n(288),Xe=n(315),Ye=n(295),Qe=a.forwardRef((function(e,t){return a.createElement(D.a,Object.assign({direction:"up",ref:t},e))}));function $e(e){var t=["piccolo","flute","alto_flute","bass_flute","oboe","english_horn","clarinet","clarinet_eb","bass_cl","bassoon"],n=["trumpet","horn","tenor_trombone","bass_trombone","soprano_sax","alto_sax"],r=["crotale","cymbal","percussion_misc","tambourine","tamtam","tamtam_22","tamtam_40","thaigong","triangle_6","triangle_8","vibraphone","woodblock","xylophone","timp"],o=["piano","harp","guitar","soprano_generic","tenor_generic","baritone_generic"],s=["violin","viola","cello","double_bass","solo_violin","solo_viola","solo_cello","solo_double_bass"],c=["p","mf","f"],l=["C","C#","D","D#","E","F","F#","G","G#","A","Bb","B"],i=[1,2,3,4,5,6,7,8];function u(e){return l[e%12]+(Math.floor(e/12)-1)}var m=a.useState(!1),h=Object(j.a)(m,2),f=h[0],g=h[1],O=a.useState({selected:null,instList:[],searchInstruments:t.concat(n).concat(s),searchTechs:["normal"],availableTechs:[],searchPitch:l,searchOct:i,searchDyn:c,searchMethod:["peaks"],searchPeaks:3,toggle:[!0,!0,!0,!1,!1,!1],result:null}),C=Object(j.a)(O,2),w=C[0],N=C[1];a.useEffect((function(){g((function(t){return e.open}))}),[e]),a.useEffect((function(){var e=[];w.searchInstruments.map((function(t){Object.keys(oe[t]).map((function(t){e.includes(t)||e.push(t)}))})),N((function(t){return Object(d.a)(Object(d.a)({},t),{},{availableTechs:e})}))}),[w.searchInstruments]);var D=function(e,t,n){if(n.target.checked){var a=Object(x.a)(w.searchInstruments);a.push(t),N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:a})}))}else{var r=w.searchInstruments.filter((function(e,n,a){return e!==t}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:r})}))}},P=function(e,a){var c=Object(x.a)(w.toggle);if(c[e]=!c[e],N((function(e){return Object(d.a)(Object(d.a)({},e),{},{toggle:c})})),0===e)if(c[e]){var l=w.searchInstruments.concat(t);N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:l})}))}else{var i=w.searchInstruments.filter((function(e,n,a){return!t.includes(e)}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:i})}))}if(1===e)if(c[e]){var u=w.searchInstruments.concat(n);N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:u})}))}else{var m=w.searchInstruments.filter((function(e,t,a){return!n.includes(e)}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:m})}))}if(2===e)if(c[e]){var h=w.searchInstruments.concat(s);N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:h})}))}else{var f=w.searchInstruments.filter((function(e,t,n){return!s.includes(e)}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:f})}))}if(3===e)if(c[e]){var p=w.searchInstruments.concat(r);N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:p})}))}else{var g=w.searchInstruments.filter((function(e,t,n){return!r.includes(e)}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:g})}))}if(4===e)if(c[e]){var b=w.searchInstruments.concat(o);N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:b})}))}else{var v=w.searchInstruments.filter((function(e,t,n){return!o.includes(e)}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchInstruments:v})}))}if(5===e)if(c[e]){var y=w.searchTechs.concat(w.availableTechs);N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchTechs:y})}))}else N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchTechs:["normal"]})}))};return a.createElement("div",null,a.createElement(S.a,{fullScreen:!0,open:f,onClose:e.handleClose,TransitionComponent:Qe,PaperProps:{style:{backgroundColor:"#fffef0"}}},a.createElement(T.a,{sx:{position:"relative",backgroundColor:"#dcc4ac",color:"#4c4c48"}},a.createElement(I.a,null,a.createElement(A.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},a.createElement("div",null,"Click here, or press ESC to close Search Panel")))),a.createElement(_.a,{style:{textAlign:"center"}}," Select search source from your saved orchestrations  "),a.createElement(E.a,{sx:{m:1,minWidth:50}},a.createElement(v.a,{id:"orchestration-select"},"Orchestrations"),a.createElement(b.a,{labelId:"orchestration-select",id:"orchestration-select1",value:w.selected,onChange:function(e){var t=e.target.value,n=JSON.parse(localStorage.getItem("orchestrations")).filter((function(e,n,a){return e.id===t}))[0].data.map((function(e,t){return[e[0],e[1],e[2],e[3],e[4],e[5],t]}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n,selected:t})}))},autoWidth:!0,label:"orch."},null===localStorage.getItem("orchestrations")?null:JSON.parse(localStorage.getItem("orchestrations")).map((function(e){return a.createElement(y.a,{value:e.id},e.name)})))),a.createElement(_.a,{variant:"h5",style:{textAlign:"center",margin:"auto"}},"Search source"),function(e){if(e.length>0){var t=[],n=0;e.map((function(e,a){e[3].map((function(a){t.push([e[0],e[1],e[2],a,e[4],e[5],n]),n+=1}))})),t.sort((function(e,t){return e[3]-t[3]}));var r=t.map((function(e){return u(e[3])})),o=t.map((function(e){return e[0]}));return a.createElement("div",{style:{textAlign:"center",margin:"auto"}},a.createElement(R,{notes:r,instruments:o,target:[],scale:.8,width:200,height:250,t_score_y:50,b_score_y:140,text_space:100}))}}(w.instList),a.createElement(_.a,{variant:"h5",style:{textAlign:"center",margin:"auto"}},"Search space"),a.createElement("table",null,a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,a.createElement(_.a,null,"Woodwinds"),a.createElement(Xe.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ye.a,{checked:w.toggle[0],size:"small",color:"success",onChange:function(e){return P(0)}})})),a.createElement("td",null,a.createElement(_.a,null,"Brass"),a.createElement(Xe.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ye.a,{checked:w.toggle[1],size:"small",color:"success",onChange:function(e){return P(1)}})})),a.createElement("td",null,a.createElement(_.a,null,"Strings"),a.createElement(Xe.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ye.a,{checked:w.toggle[2],color:"success",size:"small",onChange:function(e){return P(2)}})})),a.createElement("td",null,a.createElement(_.a,null,"Percussion"),a.createElement(Xe.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ye.a,{checked:w.toggle[3],color:"success",size:"small",onChange:function(e){return P(3)}})})),a.createElement("td",null,a.createElement(_.a,null,"Other"),a.createElement(Xe.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ye.a,{checked:w.toggle[4],color:"success",size:"small",onChange:function(e){return P(4)}})}))),a.createElement("tr",null,a.createElement("td",null,a.createElement(qe.a,{sx:{display:"inline"}},t.map((function(e,t){return a.createElement(Xe.a,{label:e,control:a.createElement(Ye.a,{checked:w.searchInstruments.includes(e),size:"small",onChange:function(t){return D(0,e,t)}})})})))),a.createElement("td",null,a.createElement(qe.a,{sx:{display:"inline"}},n.map((function(e,t){return a.createElement(Xe.a,{label:e,control:a.createElement(Ye.a,{checked:w.searchInstruments.includes(e),size:"small",onChange:function(t){return D(0,e,t)}})})})))),a.createElement("td",null,a.createElement(qe.a,{sx:{display:"inline"}},s.map((function(e,t){return a.createElement(Xe.a,{label:e,control:a.createElement(Ye.a,{checked:w.searchInstruments.includes(e),size:"small",onChange:function(t){return D(0,e,t)}})})})))),a.createElement("td",null,a.createElement(qe.a,{sx:{display:"inline"}},r.map((function(e,t){return a.createElement(Xe.a,{label:e,control:a.createElement(Ye.a,{checked:w.searchInstruments.includes(e),size:"small",onChange:function(t){return D(0,e,t)}})})})))),a.createElement("td",null,a.createElement(qe.a,{sx:{display:"inline"}},o.map((function(e,t){return a.createElement(Xe.a,{label:e,control:a.createElement(Ye.a,{checked:w.searchInstruments.includes(e),onChange:function(t){return D(0,e,t)}})})}))))))),a.createElement(_.a,null,"Techniques"),a.createElement(Xe.a,{style:{color:"green"},label:"toggle all",control:a.createElement(Ye.a,{checked:w.toggle[5],color:"success",size:"small",onChange:function(e){return P(5)}})}),a.createElement(qe.a,{sx:{display:"inline"}},w.availableTechs.map((function(e,t){return a.createElement(Xe.a,{label:e,control:a.createElement(Ye.a,{checked:w.searchTechs.includes(e),size:"small",onChange:function(t){return function(e,t,n){if(n.target.checked){var a=Object(x.a)(w.searchTechs);a.push(t),N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchTechs:a})}))}else{var r=w.searchTechs.filter((function(e,n,a){return e!==t}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchTechs:r})}))}}(0,e,t)}})})}))),a.createElement(_.a,null,"Dynamics"),a.createElement(qe.a,{sx:{display:"inline"}},c.map((function(e,t){return a.createElement(Xe.a,{label:e,control:a.createElement(Ye.a,{checked:w.searchDyn.includes(e),size:"small",onChange:function(t){return function(e,t,n){if(n.target.checked){var a=Object(x.a)(w.searchDyn);a.push(t),N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchDyn:a})}))}else{var r=w.searchDyn.filter((function(e,n,a){return e!==t}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchDyn:r})}))}}(0,e,t)}})})}))),a.createElement(_.a,null,"Pitch classes"),a.createElement(qe.a,{sx:{display:"inline"}},l.map((function(e,t){return a.createElement(Xe.a,{label:e,control:a.createElement(Ye.a,{checked:w.searchPitch.includes(e),size:"small",onChange:function(t){return function(e,t,n){if(n.target.checked){var a=Object(x.a)(w.searchPitch);a.push(t),N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchPitch:a})}))}else{var r=w.searchPitch.filter((function(e,n,a){return e!==t}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchPitch:r})}))}}(0,e,t)}})})}))),a.createElement(_.a,null,"Octaves"),a.createElement(qe.a,{sx:{display:"inline"}},i.map((function(e,t){return a.createElement(Xe.a,{label:e,control:a.createElement(Ye.a,{checked:w.searchOct.includes(e),size:"small",onChange:function(t){return function(e,t,n){if(n.target.checked){var a=Object(x.a)(w.searchOct);a.push(t),N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchOct:a})}))}else{var r=w.searchOct.filter((function(e,n,a){return e!==t}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchOct:r})}))}}(0,e,t)}})})}))),a.createElement(_.a,null,"Search method"),a.createElement(qe.a,{sx:{display:"inline"}},["mfcc","centroid","masking_curve","peaks"].map((function(e,t){return a.createElement(Xe.a,{label:e,control:a.createElement(Ye.a,{checked:w.searchMethod.includes(e),size:"small",onChange:function(t){return function(e,t,n){if(n.target.checked){var a=Object(x.a)(w.searchMethod);a.push(t),N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchMethod:a})}))}else{var r=w.searchMethod.filter((function(e,n,a){return e!==t}));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchMethod:r})}))}}(0,e,t)}})})})),a.createElement(E.a,{fullWidth:!0},a.createElement(v.a,{id:"overlapping"},"Overlappin partials for peaks"),a.createElement(b.a,{labelId:"overlapping",id:"overlapping-select",value:w.searchPeaks,label:"Overlappin partials for peaks",onChange:function(e){var t=e.target.value;N((function(e){return Object(d.a)(Object(d.a)({},e),{},{searchPeaks:t})}))}},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15].map((function(e){return a.createElement(y.a,{value:e},e)}))))),a.createElement(p.a,{onClick:function(){var e=[];w.instList.map((function(t,n){t[3].map((function(n){e.push(t[0]+","+t[1]+","+t[2]+","+n)}))}));var t=[e,w.searchMethod,w.searchInstruments,w.searchTechs,w.searchDyn,w.searchPitch,w.searchOct,w.searchPeaks];k.a.post("https://rest.score-tool.com/search",t).then((function(e){var t=e.data,n=a.createElement("div",null,a.createElement(_.a,{style:{textAlign:"center",margin:"auto"}}," Search result: ",t[0][0]," ",t[0][1]," ",t[0][2]," ",u(t[0][3])),a.createElement("div",{style:{textAlign:"center",margin:"auto"}},a.createElement(R,{notes:[u(t[0][3])],instruments:[t[0][0]],target:[],scale:.8,width:200,height:250,t_score_y:50,b_score_y:140,text_space:100})),a.createElement(_.a,{style:{textAlign:"center",margin:"auto"}}," Play search result, ",t[0][0],": "),a.createElement("div",null,a.createElement("audio",{controls:!0}," ",a.createElement("source",{src:t[1],type:"audio/x-wav"})," ")),a.createElement(_.a,{style:{textAlign:"center",margin:"auto"}}," Play search source: "),a.createElement("div",null,a.createElement("audio",{controls:!0}," ",a.createElement("source",{src:t[2],type:"audio/x-wav"})," ")),a.createElement(_.a,{style:{textAlign:"center",margin:"auto"}}," Play both together: "),a.createElement("div",null,a.createElement("audio",{controls:!0}," ",a.createElement("source",{src:t[3],type:"audio/x-wav"})," ")),a.createElement(p.a,{onClick:function(e){return function(e,t){var n=Object(x.a)(w.instList);n.push([e[0],e[1],e[2],[e[3]],0,1,n[n.length-1][6]+1]),N((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n})}))}(t[0])},variant:"contained",color:"secondary",style:{padding:10,margin:5}}," Add search result to search source "),a.createElement(p.a,{onClick:function(e){return function(e,t){var n=Object(x.a)(w.instList);n.push([e[0],e[1],e[2],[e[3]],0,1,n[n.length-1][6]+1]),N((function(e){return Object(d.a)(Object(d.a)({},e),{},{instList:n})}));var a=JSON.parse(localStorage.getItem("orchestrations"));a[w.selected].data=n,localStorage.setItem("orchestrations",JSON.stringify(a))}(t[0])},variant:"contained",color:"secondary",style:{padding:10,margin:5}}," Update your saved orchestration with search result "));N((function(e){return Object(d.a)(Object(d.a)({},e),{},{result:n})}))}))},variant:"contained",color:"primary",style:{padding:10,margin:5}}," SEARCH "),a.createElement("br",null),w.result))}var Ze=a.forwardRef((function(e,t){return a.createElement(D.a,Object.assign({direction:"up",ref:t},e))}));function et(e){var t=["C","C#","D","D#","E","F","F#","G","G#","A","Bb","B"];var n=a.useState(!1),r=Object(j.a)(n,2),o=r[0],s=r[1],c=a.useState([]),l=Object(j.a)(c,2),i=l[0],u=l[1],m=a.useState([]),d=Object(j.a)(m,2),f=d[0],g=d[1];a.useEffect((function(){s((function(t){return e.open}))}),[e]),a.useEffect((function(){u((function(){return JSON.parse(localStorage.getItem("orchestrations"))}));var e=Object(x.a)(f);e.length=JSON.parse(localStorage.getItem("orchestrations")).length,g((function(){return e}))}),[]),a.useEffect((function(){u((function(){return JSON.parse(localStorage.getItem("orchestrations"))}));var e=Object(x.a)(f);e.length=JSON.parse(localStorage.getItem("orchestrations")).length,g((function(){return e}))}),[localStorage.getItem("orchestrations")]);var b=function(e){if(e.length>0){var n=[],r=0;e.map((function(e,t){e[3].map((function(t){n.push([e[0],e[1],e[2],t,e[4],e[5],r]),r+=1}))})),n.sort((function(e,t){return e[3]-t[3]}));var o=n.map((function(e){return n=e[3],t[n%12]+(Math.floor(n/12)-1);var n})),s=n.map((function(e){return e[0]}));return a.createElement("div",{style:{textAlign:"center",margin:"auto"}},a.createElement(R,{notes:o,instruments:s,target:[],scale:.3,width:150,height:80,t_score_y:20,b_score_y:110,text_space:30}))}};return a.createElement("div",null,a.createElement(S.a,{fullScreen:!0,open:o,onClose:e.handleClose,TransitionComponent:Ze,PaperProps:{style:{backgroundColor:"#fffef0"}}},a.createElement(T.a,{sx:{position:"relative",backgroundColor:"#dcc4ac",color:"#4c4c48"}},a.createElement(I.a,null,a.createElement(A.a,{edge:"start",color:"inherit",onClick:e.handleClose,"aria-label":"close"},a.createElement("div",null,"Click here, or press ESC to close Manage Panel")))),a.createElement(_.a,{style:{textAlign:"center"}},"Here you can manage your saved orchestrations"),a.createElement(h.a,{onDrop:function(e){e.forEach((function(e){var t=new FileReader;t.onabort=function(){return console.log("file reading was aborted")},t.onerror=function(){return console.log("file reading has failed")},t.onload=function(){var e=JSON.parse(localStorage.getItem("orchestrations")),n=0;e.length>0&&(n=e[e.length-1].id+1);var a=JSON.parse(t.result);a.map((function(e){e.id,e.name,e.data})),a.map((function(t,a){var r=t;r.id=n+a,e.push(r)})),u((function(){return e})),localStorage.setItem("orchestrations",JSON.stringify(e))},t.readAsText(e)}))},maxFiles:1,accept:".chords"},(function(e){var t=e.getRootProps,n=e.getInputProps;return a.createElement("section",{className:"container"},a.createElement("div",Object.assign({},t({className:"dropzone Upload"}),{style:{margin:5,padding:5,borderRadius:10,border:"2px dashed #4c4c48"}}),a.createElement("input",n()),a.createElement("p",{style:{textAlign:"center"}},"Upload your saved file of orchestration chords")),a.createElement("aside",null,a.createElement("div",null)))})),0===i.length&&a.createElement(_.a,{style:{textAlign:"center"}},"Add some orchestrations to your list (Upload a pre-saved file, or click save either in Score Analyzer or in Chord Editor.)"),i.length>0&&a.createElement("div",null,a.createElement(p.a,{onClick:function(){var e=document.createElement("a"),t=new Blob([localStorage.getItem("orchestrations")],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download="orchestration.chords",document.body.appendChild(e),e.click()},variant:"contained",color:"primary",style:{padding:10,margin:5}}," Download your orchestrations "),a.createElement(_.a,{style:{textAlign:"center"}},"List of your orchestrations"),a.createElement("table",{style:{textAlign:"center",margin:"auto"}},a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,"Name"),a.createElement("td",null,"Orchestration"),a.createElement("td",null,"Listen"),a.createElement("td",null,"Delete")),i.map((function(e,t){return a.createElement("tr",null," ",a.createElement("td",null,e.name),"  ",a.createElement("td",null,b(e.data)),a.createElement("td",null,a.createElement(p.a,{onClick:function(n){return function(e,t,n){var r=[];t.map((function(e,t){e[3].map((function(t){r.push(e[0]+","+e[1]+","+e[2]+","+t)}))})),k.a.post("https://rest.score-tool.com/listen",{orchestration:r,positions:Array(r.length).fill(17),listeningPosition:"audience"},{headers:{auth:"uljasPulkkis"}}).then((function(t){var n=a.createElement("div",null,a.createElement("audio",{controls:!0}," ",a.createElement("source",{src:t.data,type:"audio/x-wav"})," ")),r=Object(x.a)(f);r[e]=n,g((function(){return r}))}))}(t,e.data)},variant:"contained",color:"secondary",style:{padding:10,margin:5}}," LISTEN "),f[t]),a.createElement("td",null,a.createElement(p.a,{onClick:function(t){return function(e,t){console.log(e);var n=JSON.parse(localStorage.getItem("orchestrations")).filter((function(t,n,a){return t.id!=e}));u((function(){return n})),localStorage.setItem("orchestrations",JSON.stringify(n))}(e.id)},variant:"contained",color:"warning",style:{padding:10,margin:5}}," DELETE ")))})))),a.createElement(p.a,{onClick:function(){u((function(){return[]})),localStorage.setItem("orchestrations",JSON.stringify([]))},variant:"contained",color:"error",style:{padding:10,margin:5}}," Erase all your orchestrations "))))}function tt(e){return a.createElement("div",null,a.createElement(_.a,{variant:"h4",style:{border:"1px solid",padding:5}},"This is a completely new version of Score-Tool. If you want to use the old version, visit ",a.createElement("a",{href:"https://old.score-tool.com",target:"_blank"},"old.score-tool.com")," "),a.createElement(_.a,{variant:"h5"},"About"),a.createElement(_.a,null,"Score-Tool is an analysis tool for music orchestration. The purpose of the tool is to help composers, conductors and other musicians to extract information about audibility and timbre from the score. The analysis results are showed on graphs, and there is also a possibility to listen any orchestration chord in a real binaural simulation of the concert hall."),a.createElement(_.a,{variant:"h5"},"Score"),a.createElement(_.a,null,'For analysis, the score must be in uncompressed musicXML format. All current notation programs can export musicXML from the "SaveAs" menu. Drag and drop, or click drop area to upload your score to Score-Tool. Click "load score". Analyzed score can be downloaded as PNG file.'),a.createElement(_.a,{variant:"h5"},"Chord"),a.createElement(_.a,null,'The Chord editor can be used without any files. Click any instrument name to add it to your orchestration. Click the notation stave and add notes with piano keyboard. After editing the instrumentation press "Update graphs" to view the analysis information.'),a.createElement(_.a,{variant:"h5"},"Compare"),a.createElement(_.a,null,"The Compare editor lets you compare two individual timbres. Click the mini-staff to select pitch for each instrument. The graphs show the overtone structure and timbre data of both instruments."),a.createElement(_.a,{variant:"h5"},"Search"),a.createElement(_.a,null,"The Search feature requires you to save some orchestrations first. Orchestrations can be saved in Score and Chord editors. Select the search source from your saved orchestrations, select search space from orchestra instruments, select search method(s) and click SEARCH. As result you will get the closest match from database, which can be added to your saved orchestration."),a.createElement(_.a,{variant:"h5"},"Manage"),a.createElement(_.a,null,"Here you can manage your saved orchestrations. You can listen individual chords, and delete the ones you don't need anymore. The saved chords are already in your machine, in browser's local storage, but here you can also download them as file, or upload your orchestratrions to browser."),a.createElement(_.a,{variant:"h6",style:{padding:10}},"Created in 2021 by ",a.createElement("a",{href:"https://uljaspulkkis.com",target:"_blank"},"Uljas Pulkkis")," "))}var nt=n(171),at=n.n(nt),rt=n(170),ot=n.n(rt),st=n(173),ct=n.n(st),lt=n(169),it=n.n(lt),ut=n(172),mt=n.n(ut),dt=n(289),ht=Object(Le.a)({palette:{neutral:{main:"#dcc4ac",contrastText:"#black"}}}),ft=Object(G.a)(K.a)((function(e){var t=e.theme;return Object(d.a)(Object(d.a)({},t.typography.body2),{},{backgroundColor:"#fffef0",padding:t.spacing(1),textAlign:"center",color:t.palette.text.secondary})})),pt=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={file:"",cursor:!1,next:0,files:[],load:"none",chord:!1,compare:!1,search:!1,manage:!1,analyze:"none",about:"block",osmd:""},a.setcursor=a.setcursor.bind(Object(i.a)(a)),a.setnext=a.setnext.bind(Object(i.a)(a)),a.loadFile=a.loadFile.bind(Object(i.a)(a)),a.onDrop=function(e){a.setState({files:e})},document.title="Score-Tool 2.0",a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){null===JSON.parse(localStorage.getItem("orchestrations"))&&localStorage.setItem("orchestrations",JSON.stringify([]))}},{key:"chordClose",value:function(){this.setState((function(e){return e.chord=!1}))}},{key:"compareClose",value:function(){this.setState((function(e){return e.compare=!1}))}},{key:"searchClose",value:function(){this.setState((function(e){return e.search=!1}))}},{key:"manageClose",value:function(){this.setState((function(e){return e.manage=!1}))}},{key:"setcursor",value:function(){this.setState((function(e){return e.cursor=!0}))}},{key:"loadFile",value:function(){var e=this;this.state.files.forEach((function(t){var n=new FileReader;n.onabort=function(){return console.log("file reading was aborted")},n.onerror=function(){return console.log("file reading has failed")},n.onload=function(){var t=n.result;e.setState((function(e){e.file=t,e.load="inline-block"})),e.forceUpdate()},n.readAsText(t)}))}},{key:"setnext",value:function(){var e=this.state.next;this.setState((function(t){return t.next=e+1}))}},{key:"handleClick",value:function(e){var t=e.target.value;this.setState((function(e){return e.file=t}))}},{key:"render",value:function(){var e=this,t=this.state.files.map((function(e){return r.a.createElement("li",{key:e.name},e.name," - ",e.size," bytes")})),n=[];if(this.state.files[0]){var a="inline-block";"inline-block"===this.state.load&&(a="none"),n=r.a.createElement("div",null,r.a.createElement("div",{style:{display:a}},r.a.createElement(p.a,{onClick:this.loadFile,variant:"contained"},"Load current file")),r.a.createElement("div",{style:{display:this.state.load}},r.a.createElement(ae,{file:this.state.file,show:this.state.cursor,next:this.state.next})))}return document.body.style.backgroundColor="#fffef0",r.a.createElement("div",{className:"App"},r.a.createElement(ft,null,r.a.createElement("header",{className:"App-header",style:{padding:10,borderRadius:20}},r.a.createElement("h1",{className:"App-title",style:{padding:10,borderRadius:20}},"Score-Tool 2.0"),r.a.createElement("h1",{className:"App-title",style:{padding:10,borderRadius:20}},"Psychoacoustic orchestration tool by Uljas Pulkkis 2021")),r.a.createElement(ze.a,{theme:ht},r.a.createElement("div",{style:{padding:10}},r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{analyze:"none",about:"block"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(it.a,null),style:{padding:10,margin:5}}," About Score-tool")),r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{analyze:"block",about:"none"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(ot.a,null),style:{padding:10,margin:5}}," Open score analyzer")),r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{chord:!0,analyze:"none",about:"none"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(at.a,null),style:{padding:10,margin:5}}," Open chord editor")),r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{compare:!0,analyze:"none",about:"none"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(mt.a,null),style:{padding:10,margin:5}}," Open compare editor")),r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{search:!0,analyze:"none",about:"none"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(dt.a,null),style:{padding:10,margin:5}}," Open search panel")),r.a.createElement("div",{style:{display:"inline"}},r.a.createElement(p.a,{onClick:function(){return e.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{manage:!0,analyze:"none",about:"none"})}))},variant:"contained",color:"neutral",startIcon:r.a.createElement(ct.a,null),style:{padding:10,margin:5}}," Manage your orchestrations ")))),r.a.createElement(We,{handleClose:this.chordClose.bind(this),open:this.state.chord}),r.a.createElement(Je,{handleClose:this.compareClose.bind(this),open:this.state.compare}),r.a.createElement($e,{handleClose:this.searchClose.bind(this),open:this.state.search}),r.a.createElement(et,{handleClose:this.manageClose.bind(this),open:this.state.manage}),r.a.createElement("div",{className:"",style:{display:this.state.analyze}},r.a.createElement(_.a,{style:{textAlign:"center"}}," Select an example score  "),r.a.createElement(E.a,{sx:{m:1,minWidth:150}},r.a.createElement(v.a,{id:"score-select"},"Scores"),r.a.createElement(b.a,{labelId:"score-select",id:"score-select1",value:this.state.selected,onChange:function(t){var n=t.target.value;e.setState((function(t){return t.osmd=r.a.createElement(ae,{file:n,show:e.state.cursor,next:e.state.next})}))},autoWidth:!0,label:"score"},["test_score2.xml"].map((function(e){return r.a.createElement(y.a,{value:e},e)})))),r.a.createElement(_.a,{style:{textAlign:"center"}}," or  "),r.a.createElement(h.a,{onDrop:this.onDrop,maxFiles:1,accept:"text/xml"},(function(e){var n=e.getRootProps,a=e.getInputProps;return r.a.createElement("section",{className:"container"},r.a.createElement("div",Object.assign({},n({className:"dropzone Upload"}),{style:{margin:20,padding:10,borderRadius:10,border:"2px dashed #4c4c48",backgroundColor:"#dcc4ac"}}),r.a.createElement("input",a()),r.a.createElement("p",null,"Drop musicXML or click")),r.a.createElement("aside",null,r.a.createElement("div",null,t)))})),n,this.state.osmd),r.a.createElement("div",{style:{display:this.state.about,textAlign:"left",textJustify:"left",paddingInline:"20vw"}},r.a.createElement(tt,null))))}}]),n}(a.Component),gt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function bt(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(r.a.createElement(pt,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");gt?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):bt(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):bt(e)}))}}()}},[[193,1,2]]]);